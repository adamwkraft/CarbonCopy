(this.webpackJsonprob_and_adam_code_a_thing=this.webpackJsonprob_and_adam_code_a_thing||[]).push([[0],{281:function(e,t,n){var a=n(556),r=["load","predict"];e.exports=function(){var e=new Worker(n.p+"60a0dfbb6ed702cd6027.worker.js",{name:"[hash].worker.js"});return a(e,r),e}},292:function(e,t,n){e.exports=n(557)},297:function(e,t,n){},311:function(e,t){},313:function(e,t){},361:function(e,t){},363:function(e,t){},391:function(e,t){},393:function(e,t){},394:function(e,t){},400:function(e,t){},402:function(e,t){},420:function(e,t){},422:function(e,t){},434:function(e,t){},437:function(e,t){},442:function(e,t){},444:function(e,t){},467:function(e,t){},557:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(16),o=n.n(c);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(297);var i,s,l,u,d,p,m,f,b,v,g,h=n(4),O=n(260),j=n.n(O),k=n(588),y=n(283),E=n(587),C=n(282),w=n.n(C),x=n(558),S=n(2),L=n.n(S),M=n(10),R=Object(a.createContext)(),I=function(){var e=Object(a.useContext)(R);if(!e)throw new Error("useWebcam must be used within a WebcamProvider");return e},T=!!(null===(i=navigator)||void 0===i||null===(s=i.mediaDevices)||void 0===s?void 0:s.getUserMedia),D=function(e){var t,n,c,o,i=e.children,s=Object(a.useRef)(),l=Object(a.useRef)(),u=Object(a.useRef)(),d=Object(a.useState)(null),p=Object(h.a)(d,2),m=p[0],f=p[1],b=Object(a.useState)(!0),v=Object(h.a)(b,2),g=v[0],O=v[1],j=Object(a.useState)(!1),k=Object(h.a)(j,2),y=k[0],E=k[1],C=Object(a.useState)([]),w=Object(h.a)(C,2),x=w[0],S=w[1],I=Object(a.useState)(!0),D=Object(h.a)(I,2),A=D[0],P=D[1],N=Object(a.useState)(null),F=Object(h.a)(N,2),U=F[0],_=F[1],B=Object(a.useState)(null),z=Object(h.a)(B,2),G=z[0],V=z[1],Y=Object(a.useState)(null),W=Object(h.a)(Y,2),q=W[0],X=W[1],H=Object(a.useState)(!1),$=Object(h.a)(H,2),K=$[0],Z=$[1],J=Object(a.useState)(!1),Q=Object(h.a)(J,2),ee=Q[0],te=Q[1],ne=Object(a.useState)(void 0),ae=Object(h.a)(ne,2),re=ae[0],ce=ae[1],oe=Object(a.useState)(void 0),ie=Object(h.a)(oe,2),se=ie[0],le=ie[1];Object(a.useEffect)((function(){u.current&&!m?f(u.current.getContext("2d")):m&&!u.current&&f(null)}),[m]),Object(a.useEffect)((function(){if(y&&!U){var e=document.createElement("canvas");e.width=u.current.width,e.height=u.current.height;var t=e.getContext("2d");_({ctx:t,canvas:e})}}),[U,y]);var ue=Object(a.useCallback)((function(){P(!1)}),[]),de=Object(a.useCallback)((function(){P(!0)}),[]),pe=Object(a.useCallback)((function(){U.ctx.clearRect(0,0,u.current.width,u.current.height)}),[U]),me=Object(a.useCallback)((function(){m.clearRect(0,0,u.current.width,u.current.height)}),[m]),fe=Object(a.useCallback)((function(){q&&q.getTracks().forEach((function(e){return e.stop()})),V(null),X(null),E(!1),ce(void 0)}),[q]),be=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(t){var n,a,r,c,o,i,s,u,d,p,m,f,b;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(fe(),T){e.next=6;break}return"Video not supported",console.error("Video not supported"),V("Video not supported"),e.abrupt("return");case 6:return a=(n="number"===typeof t)?{}:t||{},r=n?t:a.deviceIdx,e.prev=9,console.log("Finding Webcams..."),i={video:{width:{exact:a.width||1280},height:{exact:a.height||720}},audio:!1},void 0!==r&&(a.deviceId=null===(s=x[r])||void 0===s?void 0:s.deviceId),a.deviceId&&(i.video.deviceId={exact:a.deviceId}),e.next=16,navigator.mediaDevices.getUserMedia(i);case 16:u=e.sent,d=null===(c=u.getTracks()[0])||void 0===c||null===(o=c.getCapabilities())||void 0===o?void 0:o.deviceId,console.log("Found webcam!"),X(u),ce(d),V(!1),te(!1),Z(!1),l.current.srcObject=u,e.next=37;break;case 27:return e.prev=27,e.t0=e.catch(9),"Error starting video.",console.error("Error starting video."),console.error(e.t0.message),(null===(p=e.t0.message)||void 0===p||null===(m=p.toLowerCase)||void 0===m||null===(f=m.call(p))||void 0===f||null===(b=f.includes)||void 0===b?void 0:b.call(f,"permission denied"))&&te(!0),X(null),E(!1),V("Error starting video."),e.abrupt("return");case 37:return e.next=39,Promise.all([new Promise((function(e){l.current.onloadedmetadata=function(){return e()}})),new Promise((function(e){l.current.onloadeddata=function(){return e()}}))]).then((function(){console.log("Webcam ready!"),E(!0),P(!1)}));case 39:return e.abrupt("return",e.sent);case 40:case"end":return e.stop()}}),e,null,[[9,27]])})));return function(t){return e.apply(this,arguments)}}(),[fe,l,x]),ve=Object(a.useCallback)(Object(M.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",be({deviceId:se}));case 1:case"end":return e.stop()}}),e)}))),[se,be]),ge=Object(a.useCallback)(Object(M.a)(L.a.mark((function e(){var t,n,a,r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=navigator)||void 0===t||null===(n=t.mediaDevices)||void 0===n?void 0:n.enumerateDevices){e.next=4;break}return console.error("Cannot get cameras."),e.abrupt("return",[]);case 4:return e.next=6,navigator.mediaDevices.enumerateDevices();case 6:return a=e.sent,r=a.filter((function(e){var t=e.kind,n=e.label;return"videoinput"===t&&!n.includes("CamTwist")})).map((function(e){var t,n=e.label.lastIndexOf(" (");return n>-1&&(t=e.label.slice(0,n)),t?{deviceId:e.deviceId,label:t}:e})),S(r),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)}))),[]),he=Object(a.useCallback)((function(){return O((function(e){return!e}))}),[]),Oe=Object(a.useCallback)((function(e){window.localStorage.setItem("AutoStartId",e),le(e)}),[]),je=Object(a.useCallback)((function(){window.localStorage.removeItem("AutoStartId"),le(null)}),[]),ke=Object(a.useCallback)((function(e){pe(),U.ctx.putImageData(e,0,0);var t=U.canvas.toDataURL("image/png");return pe(),t}),[U,pe]),ye=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(t){var n,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pe(),(n=new Image).src=t,e.next=5,new Promise((function(e){n.onload=function(){U.ctx.drawImage(n,0,0),e()}}));case 5:return a=U.ctx.getImageData(0,0,u.current.width,u.current.height),pe(),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[pe,U]),Ee=Object(a.useCallback)((function(){pe(),U.ctx.drawImage(l.current,0,0);var e=U.ctx.getImageData(0,0,u.current.width,u.current.height);return pe(),e}),[pe,U]);Object(a.useEffect)((function(){ge().then((function(e){var t=window.localStorage.getItem("AutoStartId"),n=!1,a=e.reduce((function(a,r,c){var o=r.deviceId,i=r.label;return o||(n=!0),a||(o===t||!t&&1===e.length&&0===c||!t&&i.includes("Built-in")?o:null)}),null);a?Oe(a):n?(Z(!0),console.warn("Need video permissions!")):!a&&t&&je()}))}),[]);var Ce=!!((null===(t=s.current)||void 0===t?void 0:t.requestFullscreen)||(null===(n=s.current)||void 0===n?void 0:n.mozRequestFullScreen)||(null===(c=s.current)||void 0===c?void 0:c.webkitRequestFullscreen)||(null===(o=s.current)||void 0===o?void 0:o.msRequestFullscreen)),we=Object(a.useState)(!1),xe=Object(h.a)(we,2),Se=xe[0],Le=xe[1];Object(a.useEffect)((function(){var e=function(){var e=!!document.fullscreenElement;Le(e)};return document.addEventListener("fullscreenchange",e),function(){return document.removeEventListener("fullscreenchange",e)}}),[]);var Me=Object(a.useCallback)((function(){Ce&&(s.current.requestFullscreen?s.current.requestFullscreen():s.current.mozRequestFullScreen?s.current.mozRequestFullScreen():s.current.webkitRequestFullscreen?s.current.webkitRequestFullscreen():s.current.msRequestFullscreen&&s.current.msRequestFullscreen())}),[Ce]),Re=Object(a.useCallback)((function(){Ce&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())}),[Ce]),Ie=Object(a.useCallback)((function(){Se?Re():Me()}),[Se,Me,Re]),Te=Object(a.useMemo)((function(){return{ctx:m,ready:y,flipX:g,start:ve,hidden:A,rootRef:s,cameras:x,setFlipX:O,videoRef:l,hasVideo:T,_setHidden:de,canvasRef:u,stopVideo:fe,setVisible:ue,startVideo:be,videoError:G,scratchpad:U,clearCanvas:me,toggleFlipX:he,videoStream:q,hasFullScreen:Ce,exitFullScreen:Re,clearScratchpad:pe,currentDeviceId:re,enterFullScreen:Me,stop:fe,discoverCameras:ge,permissionNeeded:K,permissionDenied:ee,toggleFullScreen:Ie,autoStartDeviceId:se,imageDataToDataUri:ke,dataUriToImageData:ye,getVideoAsImageData:Ee,setAutoStartDeviceId:Oe,clearAutoStartDeviceId:je,isFullScreen:Se}}),[m,y,g,ve,A,x,O,de,fe,Se,ue,be,G,U,he,me,q,Ce,Re,pe,re,Me,ge,K,ee,Ie,se,ke,ye,Ee,Oe,je]);return r.a.createElement(R.Provider,{value:Te},i)},A=n(116),P=n(5),N=n(23),F=n(583),U=n(584),_=n(20),B=n(269),z=n.n(B),G=n(268),V=n.n(G),Y=function(e){var t=e.color,n=void 0===t?"#fff":t,a=Object(_.c)({to:{opacity:1},from:{opacity:0},config:_.b.stiff});return r.a.createElement(_.a.div,{style:a},r.a.createElement("svg",{version:"1.1",id:"L7",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 100 100",enableBackground:"new 0 0 100 100"},r.a.createElement("path",{fill:n,d:"M31.6,3.5C5.9,13.6-6.6,42.7,3.5,68.4c10.1,25.7,39.2,38.3,64.9,28.1l-3.1-7.9c-21.3,8.4-45.4-2-53.8-23.3 c-8.4-21.3,2-45.4,23.3-53.8L31.6,3.5z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"2s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"})),r.a.createElement("path",{fill:n,d:"M42.3,39.6c5.7-4.3,13.9-3.1,18.1,2.7c4.3,5.7,3.1,13.9-2.7,18.1l4.1,5.5c8.8-6.5,10.6-19,4.1-27.7 c-6.5-8.8-19-10.6-27.7-4.1L42.3,39.6z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"1s",from:"0 50 50",to:"-360 50 50",repeatCount:"indefinite"})),r.a.createElement("path",{fill:n,d:"M82,35.7C74.1,18,53.4,10.1,35.7,18S10.1,46.6,18,64.3l7.6-3.4c-6-13.5,0-29.3,13.5-35.3s29.3,0,35.3,13.5 L82,35.7z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"2s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"}))))},W=n(117),q=n(589),X=n(580),H=n(592),$=n(593),K=n(590),Z=n(585),J=n(265),Q=n.n(J),ee=n(266),te=n.n(ee),ne=function(){},ae=Object(x.a)((function(e){return{root:function(e){return{position:"relative"}},arrowIcon:function(t){return{marginLeft:e.spacing(1)}},tooltip:function(e){return{position:"relative",margin:0}},arrow:function(e){return{position:"absolute",fontSize:6,"&::before":{content:'""',margin:"auto",display:"block",width:0,height:0,borderStyle:"solid"}}},paper:{border:"1px solid #d3d4d5"},popper:function(t){return{'&[x-placement*="bottom"] $arrow':{top:0,left:0,marginTop:"-0.95em",width:"2em",height:"1em","&::before":{borderWidth:"0 1em 1em 1em",borderColor:"transparent transparent ".concat(e.palette.grey[700]," transparent")}},'&[x-placement*="top"] $arrow':{bottom:0,left:0,marginBottom:"-0.95em",width:"2em",height:"1em","&::before":{borderWidth:"1em 1em 0 1em",borderColor:"".concat(e.palette.grey[700]," transparent transparent transparent")}},'&[x-placement*="right"] $arrow':{left:0,marginLeft:"-0.95em",height:"2em",width:"1em","&::before":{borderWidth:"1em 1em 1em 0",borderColor:"transparent ".concat(e.palette.grey[700]," transparent transparent")}},'&[x-placement*="left"] $arrow':{right:0,marginRight:"-0.95em",height:"2em",width:"1em","&::before":{borderWidth:"1em 0 1em 1em",borderColor:"transparent transparent transparent ".concat(e.palette.grey[700])}}}}}})),re=function(e){var t,n=ae(e),c=Object(a.useMemo)(Math.random,[]),o=Object(a.useRef)(),i=Object(a.useState)(null),s=Object(h.a)(i,2),l=s[0],u=s[1],d=Object(a.useState)(null),p=Object(h.a)(d,2),m=p[0],f=p[1];Object(a.useEffect)((function(){return o.current=!0,function(){o.current=!1}}),[]);var b=Object(a.useCallback)((function(e){o.current&&u(e.currentTarget)}),[]),v=Object(a.useCallback)((function(){o.current&&u(null)}),[]),g=Object(a.useCallback)(Object(M.a)(L.a.mark((function t(){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e.onClose||ne)();case 2:!0!==t.sent&&v();case 4:case"end":return t.stop()}}),t)}))),[v,e.onClose]),O=Object(a.useCallback)((function(t){(e.onClickCheckbox||ne)(t.target.value,g)}),[e.onClickCheckbox,g]),j=Object(a.useCallback)((function(t){return function(){var n=Object(M.a)(L.a.mark((function n(a){return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("checkbox"!==a.target.type){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,(e.onSelect||ne)(t);case 4:!0!==n.sent&&g();case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}),[g,e.onSelect]),k=!!l;return r.a.createElement("div",{className:n.root},r.a.createElement(X.a,Object.assign({disableRipple:!0,variant:"outlined","aria-haspopup":"true",className:n.button,onClick:b,"aria-controls":"select-and-check-".concat(c)},e.SelectProps),k&&e.activeTitle||e.title,k?r.a.createElement(Q.a,{className:n.arrowIcon}):r.a.createElement(te.a,{className:n.arrowIcon})),r.a.createElement(q.a,Object.assign({keepMounted:!0,open:k,elevation:0,anchorEl:l,getContentAnchorEl:null,onClose:g,id:"select-and-check-".concat(c),classes:{paper:n.paper},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e.MenuProps),null===(t=e.options)||void 0===t?void 0:t.map((function(t,a){var c=t.key,o=t.value,i=t.text,s=t.selected,l=t.tooltipTitle,u=t.checked,d=t.checkboxValue,p=null;if("boolean"===typeof u){var b=r.a.createElement(K.a,{checked:u,onClick:O,value:void 0===d?o:d}),v=l||e.tooltipTitle;p=v?r.a.createElement(H.a,{classes:{tooltip:n.tooltip,popper:n.popper},PopperProps:{popperOptions:{modifiers:{arrow:{enabled:!!m,element:m}}}},title:r.a.createElement(r.a.Fragment,null,v,r.a.createElement("span",{className:n.arrow,ref:f})),enterDelay:void 0===e.tooltipEnterDelay?750:e.tooltipEnterDelay,leaveDelay:e.tooltipLeaveDelay||0,"aria-label":"checkbox",placement:e.tooltipPlacement||"top"},b):b}return r.a.createElement($.a,Object.assign({key:c||a,onClick:j(o),selected:s},e.MenuItemProps),p,r.a.createElement(Z.a,{primary:i||(null===o||void 0===o?void 0:o.toString())}))}))))},ce=Object(x.a)((function(e){return{root:function(e){return{}}}})),oe=function(e){var t,n=I(),c=ce(Object(N.a)(Object(N.a)({},e),n)),o=Object(a.useMemo)((function(){var e={deviceId:null,label:null,none:!0};return n.currentDeviceId?(n.cameras.some((function(t){return t.deviceId===n.currentDeviceId&&(e=t,!0)})),e):e}),[n.cameras,n.currentDeviceId]),i=Object(a.useCallback)((function(e){n.currentDeviceId!==e&&n.startVideo({deviceId:e})}),[n]),s=Object(a.useCallback)((function(e){n.autoStartDeviceId===e?n.clearAutoStartDeviceId():(n.setAutoStartDeviceId(e),i(e))}),[n,i]);return r.a.createElement("div",{className:c.root},r.a.createElement(re,{activeTitle:"Select Camera",title:(null===(t=n.cameras)||void 0===t?void 0:t.length)?o.label||"No Camera Selected":"No Cameras Detected",onSelect:i,onClickCheckbox:s,options:n.cameras.map((function(e){return{key:e.label,value:e.deviceId,text:e.label||"Unknown Device",selected:e.deviceId===n.currentDeviceId,checked:n.autoStartDeviceId===e.deviceId,tooltipTitle:n.autoStartDeviceId===e.deviceId?"Remove Default":"Set Default"}}))}))},ie=Object(x.a)((function(e){return{root:{position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",alignItems:"center",justifyContent:"center"},paper:{padding:e.spacing(2),borderRadius:e.spacing(1),display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center","& h1":{marginBottom:e.spacing(2)},"& p":{marginBottom:e.spacing(1)}}}})),se=function(e){var t=ie(e),n=Object(_.c)({transform:"translate3d(0,0px,0)",from:{transform:"translate3d(0,-500px,0)"},config:_.b.slow}),a=Object(_.c)({to:{opacity:e.permissionDenied?1:0},config:_.b.wobbly});return r.a.createElement("div",{className:t.root},r.a.createElement(_.a.div,{style:n},r.a.createElement(F.a,{elevation:4,className:t.paper},r.a.createElement("div",{className:t.container},e.permissionDenied?r.a.createElement(_.a.div,{style:a},r.a.createElement(W.a,{component:"h1",variant:"h6"},"It looks like you have denied webcam access."),r.a.createElement(W.a,{component:"p"},"Please take a look at"," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://support.google.com/chrome/answer/2693767"},"this article")," ","in order to enable access."),r.a.createElement(W.a,{component:"p"},"Once your webcam has been enabled, return here to play the game!")):r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{component:"h1",variant:"h6"},"In order to play the game, you must grant permission to access your webcam."),r.a.createElement(W.a,{component:"p"},"Please select a camera."),r.a.createElement(oe,null))))))},le=Object(x.a)((function(e){return{root:function(t){var n=t.isFullScreen;return Object(N.a)(Object(P.a)({maxWidth:1100,margin:"0 auto",position:"relative",height:"calc(0.5625 * (100vw - ".concat(e.spacing(4),"px))")},"@media(min-width: ".concat(1100,"px)"),{height:n?"100%":"calc(0.5625 * (".concat(1100,"px - ").concat(e.spacing(4),"px))")}),n?{display:"flex",alignItems:"center",justifyContent:"center"}:{})},container:function(t){var n=t.isFullScreen;return{width:"100%",position:"relative",paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},video:function(t){var n=t.flipX,a=t.isFullScreen;return Object(N.a)({width:"100%",height:"100%",borderRadius:a?0:e.spacing(1)},n?{"p-webkit-transform":"scaleX(- 1)",transform:"scaleX(-1)"}:{})},canvas:function(t){var n=t.isFullScreen;return{borderRadius:n?0:e.spacing(1),position:"absolute",top:0,left:0,width:"100%",paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},children:function(t){var n=t.isFullScreen;return{borderRadius:n?0:e.spacing(1),overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",bottom:5,zIndex:1,paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},fullScreen:{position:"absolute",bottom:e.spacing(1.5),right:function(t){var n=t.isFullScreen;return e.spacing(n?1.5:3)},zIndex:20,"&:hover":{background:"rgba(255,255,255,0.25)"}},overlay:function(t){var n=t.overlayColor,a=t.isFullScreen;return{background:n,position:"absolute",top:0,bottom:5,left:a?0:e.spacing(2),right:a?0:e.spacing(2),borderRadius:a?0:e.spacing(1),zIndex:0}},loader:{position:"absolute",top:0,left:0,bottom:0,right:0,width:"100%",display:"flex",alignItems:"center",justifyContent:"center","& > div":{width:100,height:100}},paper:{top:0,bottom:5,zIndex:-1,position:"absolute",left:e.spacing(2),right:e.spacing(2),borderRadius:e.spacing(1)}}})),ue=function(e){var t,n,a,c,o,i,s,l,u=e.overlay,d=Object(A.a)(e,["overlay"]),p=I(),m="string"!==typeof u?"rgba(255,255,255,0.5)":u,f=le(Object(N.a)(Object(N.a)(Object(N.a)({},d),p),{},{overlayColor:m})),b=Object(_.c)({to:{opacity:p.hidden?0:1},config:_.b.stiff});return r.a.createElement("div",{ref:p.rootRef,className:f.root},r.a.createElement(_.a.div,{style:b,className:f.container},r.a.createElement(r.a.Fragment,null,r.a.createElement("video",{autoPlay:!0,ref:p.videoRef,className:f.video,width:null===(t=p.videoRef)||void 0===t||null===(n=t.current)||void 0===n?void 0:n.videoWidth,height:null===(a=p.videoRef)||void 0===a||null===(c=a.current)||void 0===c?void 0:c.videoHeight}),r.a.createElement("canvas",{ref:p.canvasRef,className:f.canvas,width:null===(o=p.videoRef)||void 0===o||null===(i=o.current)||void 0===i?void 0:i.videoWidth,height:null===(s=p.videoRef)||void 0===s||null===(l=s.current)||void 0===l?void 0:l.videoHeight}),!p.hidden&&u&&r.a.createElement("div",{className:f.overlay}),d.children&&!p.hidden&&r.a.createElement("div",{className:f.children},d.children),p.hasFullScreen&&r.a.createElement(U.a,{color:"secondary",className:f.fullScreen,onClick:p.toggleFullScreen},p.isFullScreen?r.a.createElement(V.a,{color:"secondary"}):r.a.createElement(z.a,{color:"secondary"}))),!p.isFullScreen&&r.a.createElement(F.a,{elevation:4,className:f.paper})),p.permissionNeeded?r.a.createElement(se,{permissionDenied:p.permissionDenied}):p.hidden&&r.a.createElement("div",{className:f.loader},r.a.createElement("div",null,r.a.createElement(Y,{color:"#000"}))))},de=n(45),pe=n.n(de),me=n(270),fe=n.n(me),be=n(271),ve=n.n(be),ge=n(273),he=n.n(ge),Oe=n(272),je=n.n(Oe),ke=window.speechSynthesis,ye=function(){var e=Object(a.useRef)(!0),t=Object(a.useState)(!0),n=Object(h.a)(t,2),r=n[0],c=n[1],o=function(e){if(!e)throw new Error("audioRef is required when calling useSpeech");var t=Object(a.useState)(null),n=Object(h.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(null),i=Object(h.a)(o,2),s=i[0],l=i[1];Object(a.useEffect)((function(){if(!r){var e=ke.getVoices();c(e),l(e[0])}}),[r]);var u=Object(a.useCallback)((function(t){if(e.current){var n=new SpeechSynthesisUtterance(t);n.voice=s,ke.speak(n)}}),[s,e]),d=Object(a.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.onEnd,a=t.onEach;n&&setTimeout(n,1e3*e),Array.from({length:e}).forEach((function(t,n){var r=e-n;setTimeout((function(){u(r),a&&a(r)}),1e3*n)}))}),[u]);return{say:u,countdown:d}}(e);Object(a.useEffect)((function(){localStorage.getItem("__audio_muted__")&&c(!1)}),[]),Object(a.useEffect)((function(){r&&!e.current?(e.current=!0,localStorage.removeItem("__audio_muted__")):!r&&e.current&&(e.current=!1,localStorage.setItem("__audio_muted__","true"))}),[r]);var i=Object(a.useCallback)((function(){c((function(e){return!e}))}),[]);return Object(a.useMemo)((function(){return{state:r,stateRef:e,handlers:{toggle:i,speech:o}}}),[r,i,o])},Ee=Object(a.createContext)(),Ce=function(){var e=Object(a.useContext)(Ee);if(void 0===e)throw new Error("useAudio must be used within a AudioProvider");return e},we=function(e){var t=e.children,n=ye();return r.a.createElement(Ee.Provider,{value:n},t)},xe="set_screen",Se="set_player_mode",Le="set_game_mode",Me="reverse_state",Re="reset_state",Ie={screen:{DEFAULT:"start",PLAY:"play"},players:{SINGLE_PLAYER:"Single Player",MULTIPLAYER:"Multi Player",DEFAULT:null},mode:(l={},Object(P.a)(l,"Single Player",{PRACTICE:"Practice",SURVIVAL:"Survival",TIME_ATTACK:"Time Attack"}),Object(P.a)(l,"Multi Player",{LOCAL:"Local Multiplayer",REMOTE:"Remote Multiplayer"}),Object(P.a)(l,"DEFAULT",null),l)},Te=[Ie.players.MULTIPLAYER,Ie.mode["Multi Player"].LOCAL,Ie.mode["Multi Player"].REMOTE].reduce((function(e,t){return Object(N.a)(Object(N.a)({},e),{},Object(P.a)({},t,!0))}),{}),De=Object.entries(Ie).reduce((function(e,t){var n=Object(h.a)(t,2),a=n[0],r=n[1];return Object(N.a)(Object(N.a)({},e),{},Object(P.a)({},a,"mode"!==a?Object.values(r).filter((function(e){return e})):Object.entries(r).reduce((function(e,t){var n=Object(h.a)(t,2),a=n[0],r=n[1];return Object(N.a)(Object(N.a)({},e),{},Object(P.a)({},a,null===r?null:Object.values(r)))}),{})))}),{}),Ae={screen:Ie.screen.DEFAULT,mode:Ie.mode.DEFAULT,players:Ie.players.DEFAULT},Pe=Object(x.a)((function(e){return{btn:{border:"2px solid grey"},back:{marginLeft:e.spacing(2)},options:{marginTop:e.spacing(2),paddingLeft:e.spacing(2),paddingRight:e.spacing(2),width:"100%",maxWidth:1100,display:"flex",margin:"0 auto",alignItems:"center",justifyContent:"space-between"},right:{display:"flex",alignItems:"center",justifyContent:"space-between"},volume:{marginLeft:e.spacing(1)}}})),Ne=Object(a.memo)((function(e){var t=Pe(),n=Ce(),a=e.screen===Ie.screen.DEFAULT,c=Object(_.c)({to:{opacity:a?0:1},config:_.b.stiff});return r.a.createElement("div",{className:t.options},r.a.createElement("div",null,!a&&r.a.createElement(_.a.div,{style:c},r.a.createElement(U.a,{className:t.btn,size:"small",onClick:e.goHome},r.a.createElement(fe.a,null)),r.a.createElement(U.a,{size:"small",onClick:e.goBack,className:pe()(t.btn,t.back)},r.a.createElement(ve.a,null)))),r.a.createElement("div",{className:t.right},r.a.createElement(oe,null),r.a.createElement(U.a,{className:t.volume,size:"small",onClick:n.handlers.toggle},n.state?r.a.createElement(je.a,null):r.a.createElement(he.a,null))))})),Fe=function(){return null},Ue=Object(x.a)((function(e){return{root:{textAlign:"center"},heading:{marginTop:e.spacing(2),marginBottom:e.spacing(2)}}})),_e=function(e){var t=Ue();return r.a.createElement("header",{className:t.root},r.a.createElement(W.a,{component:"h1",variant:"h5",className:t.heading},e.game.screen.state.screen))},Be=Object(x.a)((function(e){return{root:{marginTop:e.spacing(2)}}})),ze=(d={},Object(P.a)(d,Ie.screen.DEFAULT,Object(P.a)({},Ie.players.DEFAULT,Fe)),Object(P.a)(d,Ie.screen.PLAY,(u={},Object(P.a)(u,Ie.players.SINGLE_PLAYER,Fe),Object(P.a)(u,Ie.players.MULTIPLAYER,Fe),u)),d),Ge=function(e){var t,n=Be(),a=e.screenState,c=a.screen,o=a.players,i=(null===(t=ze[c])||void 0===t?void 0:t[o])||_e;return r.a.createElement("header",{className:n.root},r.a.createElement(i,null))},Ve=n(586),Ye=n(274),We=n.n(Ye),qe=function(e){var t=(e-25)/63;return Math.max(1,Math.min(10,Math.round(10*t)))},Xe=function(e){return e/10*100},He=function(e,t){var n,a;e<50?(n=255,a=Math.round(5.1*e)):(a=255,n=Math.round(510-5.1*e));var r="#"+("000000"+(65536*n+256*a+0).toString(16)).slice(-6);if(t){var c=We()(r),o=c.red,i=c.green,s=c.blue;return"rgba(".concat(o,", ").concat(i,", ").concat(s,", ").concat(t,")")}return r},$e=function(e,t){return He(Xe(qe(e)),t)},Ke=n(115),Ze=n.n(Ke),Je=Object(Ve.a)((function(e){return{masks:{padding:e.spacing(2),background:"rgba(255,255,255,0.5)"},masksHeader:{display:"flex",alignItems:"center",justifyContent:"space-between"},masksList:{display:"flex",flexFlow:"row wrap",justifyContent:"space-around"},maskContainer:{marginTop:e.spacing(2)},imgContainer:{width:200,position:"relative",border:"1px solid grey",padding:e.spacing(.5),borderRadius:e.spacing(1),"&:hover":{"& > div":{background:"rgba(255,0,0,0.65)"}}},img:{width:"100%",background:"rgba(0,0,0,0)"},removeMask:{top:0,left:0,bottom:0,width:"100%",display:"flex",alignItems:"center",position:"absolute",transition:"all 100ms",justifyContent:"center","&:hover":{"& > button":{display:"inherit"}}},iconBtn:{display:"none",color:"black",backgroundColor:"rgba(255,255,255,0.5)","&:hover":{backgroundColor:"rgba(255,255,255,0.75)"},"&:active, &:focused":{backgroundColor:"rgba(255,255,255,0.9)"}},actions:{"& > button":{marginRight:e.spacing(1),"& :last-of-type":{marginRight:0}}}}})),Qe=function(e){var t=Je(),n=e.masks,a=e.onClose,c=e.title,o=e.actions,i=e.actionButtons,s=e.getDataUri,l=e.getImageChild,u=e.getPaperProps,d=e.PaperProps,p=void 0===d?{}:d;return!!(null===n||void 0===n?void 0:n.length)&&r.a.createElement(F.a,{className:t.masks,elevation:4},r.a.createElement("div",{className:t.masksHeader},"string"===typeof c?r.a.createElement(W.a,{variant:"h6",component:"h3"},c):c||null,o||i?r.a.createElement("div",{className:t.actions},i.map((function(e){var t=e.Icon,n=e.onClick,a=e.key;return r.a.createElement(U.a,{key:a,size:"small",onClick:n},r.a.createElement(t,null))}))):a&&r.a.createElement("div",{className:t.actions},r.a.createElement(U.a,{size:"small",onClick:a},r.a.createElement(Ze.a,null)))),r.a.createElement("ul",{className:t.masksList},n.map((function(e,n){var a=s?s(e):e,c=u?u(e,n):{};return r.a.createElement("li",{key:a,className:t.maskContainer},r.a.createElement(F.a,Object.assign({elevation:4,className:t.imgContainer},p,c),l&&l(e),r.a.createElement("img",{src:a,className:t.img,alt:"mask #".concat(n)})))}))))},et=Object(Ve.a)((function(e){return{score:{textAlign:"right",paddingRight:e.spacing(1)}}})),tt=function(e){var t=et(),n=e.results,c=e.handleClose,o=Object(a.useMemo)((function(){var e=n.reduce((function(e,t){var n=t.score;return e+qe(n)}),0)/n.length,t=Xe(e),a=He(t),c=e.toFixed(1);return r.a.createElement(W.a,{variant:"h6",component:"h3"},"Round Score: ",r.a.createElement("span",{style:{color:a}},c))}),[n]),i=Object(a.useCallback)((function(e){return e.dataUri}),[]),s=Object(a.useCallback)((function(e){var t=e.score;return{style:{background:$e(t,.4)}}}),[]),l=Object(a.useCallback)((function(e){var n=e.score;return r.a.createElement(W.a,{className:t.score},qe(n))}),[t.score]);return r.a.createElement(Qe,{title:o,masks:n,onClose:c,getDataUri:i,getPaperProps:s,getImageChild:l})},nt=n(275),at=n.n(nt),rt=n(276),ct=n.n(rt),ot=n(277),it=n.n(ot),st=Object(Ve.a)((function(e){return{removeMask:{top:0,left:0,bottom:0,width:"100%",display:"flex",alignItems:"center",position:"absolute",transition:"all 100ms",justifyContent:"center","&:hover":{"& > button":{display:"inherit"}}},iconBtn:{display:"none",color:"black",backgroundColor:"rgba(255,255,255,0.5)","&:hover":{backgroundColor:"rgba(255,255,255,0.75)"},"&:active, &:focused":{backgroundColor:"rgba(255,255,255,0.9)"}}}})),lt=function(e){var t=st(),n=e.captureMasks,c=e.handlePlay,o=Object(a.useMemo)((function(){return[{key:"play",Icon:at.a,onClick:c},{key:"download",Icon:ct.a,onClick:n.downloadMasks},{key:"clear",Icon:Ze.a,onClick:n.removeAllMasks}]}),[n.downloadMasks,n.removeAllMasks,c]),i=Object(a.useCallback)((function(e){return e.binary}),[]),s=Object(a.useCallback)((function(e,a){return r.a.createElement("div",{className:t.removeMask},r.a.createElement(U.a,{name:a,className:t.iconBtn,onClick:n.removeMask},r.a.createElement(it.a,{fontSize:"large"})))}),[n.removeMask,t.removeMask,t.iconBtn]);return r.a.createElement(Qe,{title:"Candidate Masks",getDataUri:i,masks:n.masks,actionButtons:o,getImageChild:s})},ut=Object(Ve.a)((function(e){return{root:{"& > div":{marginTop:e.spacing(2)}}}})),dt=function(e){var t=ut(),n=on();if(!n.mode)return null;var a=n.mode,c=a.captureMasks,o=a.simpleGame,i=a.handlePlayCapturedMasks;return r.a.createElement("div",{className:t.root},r.a.createElement(tt,{results:o.scores,handleClose:o.clearScores}),c&&r.a.createElement(lt,{captureMasks:c,handlePlay:i}))},pt=Object(x.a)((function(e){return{root:{maxWidth:1100,margin:"0 auto",paddingLeft:e.spacing(2),paddingRight:e.spacing(2)}}})),mt=Object(P.a)({},Ie.screen.PLAY,(f={},Object(P.a)(f,Ie.players.SINGLE_PLAYER,(p={},Object(P.a)(p,Ie.mode[Ie.players.SINGLE_PLAYER].PRACTICE,dt),Object(P.a)(p,Ie.mode[Ie.players.SINGLE_PLAYER].SURVIVAL,dt),Object(P.a)(p,Ie.mode[Ie.players.SINGLE_PLAYER].TIME_ATTACK,dt),p)),Object(P.a)(f,Ie.players.MULTIPLAYER,(m={},Object(P.a)(m,Ie.mode[Ie.players.MULTIPLAYER].LOCAL,(function(){return"LOCAL footer"})),Object(P.a)(m,Ie.mode[Ie.players.MULTIPLAYER].REMOTE,(function(){return"REMOTE footer"})),m)),f)),ft=function(e){var t,n,a=pt(),c=e.screen.state,o=c.screen,i=c.players,s=c.mode,l=(null===(t=mt[o])||void 0===t||null===(n=t[i])||void 0===n?void 0:n[s])||Fe;return r.a.createElement("div",{className:a.root},r.a.createElement(l,null))},bt=Object(Ve.a)((function(e){return{root:{display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"space-between",marginBottom:e.spacing(1),"& > div > *":{marginTop:e.spacing(2),minWidth:150}}}})),vt=function(e){var t=bt(),n=Object(_.d)(e.buttons.length,{transform:"translate3d(0,0px,0)",from:{transform:"translate3d(0,-".concat(e.offset||100,"px,0)")},config:_.b.stiff});return r.a.createElement("div",{className:t.root},n.map((function(t,n){var a=e.buttons[n],c=a.Component,o=a.visible,i=void 0===o||o,s=a.props,l=void 0===s?{}:s;return i?r.a.createElement(_.a.div,{key:l.key,style:t},c?r.a.createElement(c,l):r.a.createElement(X.a,Object.assign({color:"primary",variant:"contained"},l))):null})))},gt=Object(x.a)((function(e){return{root:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column","& button":{minWidth:150,marginTop:e.spacing(2)}},gameMode:{textAlign:"center"},header:{marginTop:e.spacing(4),marginBottom:e.spacing(2)}}})),ht=function(e){var t=gt(),n=Object(a.useCallback)((function(t){var n=t.currentTarget.name;e.screen.handlers.setGameMode(n)}),[e.screen.handlers]),c=Object(a.useMemo)((function(){var t;return null===(t=De.mode[e.screen.state.players])||void 0===t?void 0:t.map((function(e){return{props:{key:e,name:e,children:e,onClick:n,disabled:!!Te[e]}}}))}),[e.screen.state.players,n]);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.gameMode},r.a.createElement(vt,{buttons:c})))},Ot=Object(x.a)((function(e){return{fileInput:{display:"none"}}})),jt=function(e){var t=e.onChange,n=e.multiple,c=e.children,o=e.filter,i=Object(A.a)(e,["onChange","multiple","children","filter"]),s=Ot(),l=Object(a.useRef)(),u=Object(a.useCallback)((function(e){if(e){var a=!1===n,r=e.target?Array.from(e.target.files):e.files,c=o?r.filter(o):r;a&&c.length>1&&(c=c.slice(0,1)),t(c)}}),[t,n,o]),d=Object(a.useCallback)((function(){l.current.value=null}),[l]);return r.a.createElement(X.a,Object.assign({component:"label"},i),c,r.a.createElement("input",{type:"file",ref:l,className:s.fileInput,onClick:d,onChange:u,multiple:!1!==n}))},kt=Object(Ve.a)((function(e){return{item:function(t){return{minWidth:t-e.spacing(4),textAlign:"center"}}}})),yt=function(e){var t=Object(a.useState)(0),n=Object(h.a)(t,2),c=n[0],o=n[1],i=kt(c),s=Object(a.useRef)();Object(a.useEffect)((function(){s.current&&o(s.current.clientWidth)}),[]);var l=r.a.useState(null),u=Object(h.a)(l,2),d=u[0],p=u[1],m=Object(a.useCallback)((function(e){p(e.currentTarget)}),[]),f=Object(a.useCallback)((function(){p(null)}),[]),b=Object(a.useCallback)((function(t){return function(){e.handleClick(t),f()}}),[e,f]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{ref:s},r.a.createElement(X.a,{fullWidth:!0,variant:"contained","aria-haspopup":"true",onClick:m,"aria-controls":"mask-menu",disabled:e.disabled},"Select Masks")),r.a.createElement(q.a,{id:"mask-menu",keepMounted:!0,anchorEl:d,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},onClose:f,open:Boolean(d),container:e.containerRef.current||null},Array.from({length:3}).map((function(e,t){return r.a.createElement($.a,{key:t,button:!0,onClick:b("set".concat(t+1,".zip"))},r.a.createElement("span",{className:i.item},"Game ",t+1))}))))},Et=Object(x.a)((function(e){return{root:function(e){var t=e.flip,n=e.height,a=void 0===n?10:n,r=e.background;return{height:a,background:void 0===r?"rgba(255,255,255,0)":r,width:"100%",borderRadius:50,transform:"scaleX(".concat(t?-1:1,")"),pWebkitTransform:"scaleX(".concat(t?-1:1,")")}},filler:function(e){var t=e.completed;return{height:"100%",textAlign:"left",background:e.color,width:"".concat(t,"%"),borderRadius:"inherit"}}}})),Ct=function(e){var t=Et(e);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.filler}))},wt=n(35),xt=n(96),St=n.n(xt),Lt=n(278),Mt=n.n(Lt),Rt=(n(279),function(e,t){for(var n=e.data,a=e.width,r=e.height,c=new Uint8ClampedArray(4*e.data.length),o=0;o<r*a;++o){var i=o%a,s=parseInt(o/a),l=n[o],u=t?a-i+a*s:o;c[4*u]=l?255:0,c[4*u+1]=l?255:0,c[4*u+2]=l?255:0,c[4*u+3]=l?255:0}var d=new ImageData(c,a,r),p=cv.matFromImageData(d),m=new cv.MatVector;cv.split(p,m);var f=new cv.Mat;cv.threshold(m.get(0),f,128,1,cv.THRESH_BINARY);var b=new cv.MatVector,v=new cv.Mat;cv.findContours(f,b,v,cv.RETR_CCOMP,cv.CHAIN_APPROX_SIMPLE);for(var g=cv.Mat.zeros(f.rows,f.cols,cv.CV_8UC1),h=0;h<b.size();++h)cv.contourArea(b.get(h))>1e4&&cv.drawContours(g,b,h,[1,1,1,1],-1,cv.LINE_8,v,100);return p.delete(),m.delete(),g}),It=function(e,t){var n=Rt(e,t),a=new cv.MatVector,r=cv.Mat.zeros(n.rows,n.cols,cv.CV_8UC4);cv.split(r,a),a.get(2).setTo([255,0,0,0],n),a.get(3).setTo([128,0,0,0],n);var c=new cv.Mat,o=cv.Mat.ones(10,10,cv.CV_8U),i=new cv.Point(-1,-1);cv.dilate(n,c,o,i,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),cv.subtract(c,n,c),a.get(2).setTo([255,0,0,0],c),a.get(1).setTo([255,0,0,0],c),a.get(3).setTo([255,0,0,0],c),cv.merge(a,r);var s=new ImageData(new Uint8ClampedArray(r.data),r.cols,r.rows);return a.delete(),n.delete(),r.delete(),o.delete(),c.delete(),{overlayImageData:s,binaryImageData:s}},Tt=function(e,t,n){for(var a=t.data,r=t.width,c=t.height,o=new Uint8ClampedArray(4*t.data.length),i=0,s=0,l=0;l<c*r;++l){var u=l%r,d=parseInt(l/r),p=n?r-u+r*d:l,m=a[l],f=!!e.data[4*p+2],b=f&&m,v=f&&!m,g=!f&&m,h=g||b||v;b&&s++,(m||f)&&i++,o[4*p]=g?255:0,o[4*p+1]=b?255:0,o[4*p+2]=v?255:0,o[4*p+3]=h?128:0}return Math.round(s/(i+1e-7)*100)},Dt=function(e,t,n){var a=Rt(t,n),r=new cv.MatVector,c=cv.Mat.zeros(a.rows,a.cols,cv.CV_8UC4);cv.split(c,r),r.get(1).setTo([255,0,0,0],a),r.get(3).setTo([128,0,0,0],a);var o=new cv.Mat,i=cv.Mat.ones(10,10,cv.CV_8U),s=new cv.Point(-1,-1);cv.dilate(a,o,i,s,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),cv.subtract(o,a,o),r.get(1).setTo([255,0,0,0],o),r.get(3).setTo([255,0,0,0],o),cv.merge(r,c);var l=new ImageData(new Uint8ClampedArray(c.data),c.cols,c.rows),u=cv.matFromImageData(e),d=new cv.MatVector;cv.split(u,d);var p=new cv.Mat;cv.addWeighted(c,.5,u,.5,0,p);var m=new ImageData(new Uint8ClampedArray(p.data),p.cols,p.rows),f=Tt(e,t,n);return r.delete(),a.delete(),c.delete(),i.delete(),o.delete(),p.delete(),{score:f,targetOverlay:m,segOverlay:l}},At=function(e){return"set".concat(e,".zip")},Pt=function(){var e=Object(a.useRef)(),t=I(),n=Object(a.useRef)(0),r=function(){var e=Object(a.useRef)([]),t=Object(a.useRef)(null),n=Object(a.useRef)(0),r=Object(a.useState)([]),c=Object(h.a)(r,2),o=c[0],i=c[1],s=Object(a.useCallback)((function(t){i(t),e.current="function"===typeof t?t(e.current):t}),[]),l=Object(a.useCallback)((function(){n.current=0,t.current=null}),[]),u=Object(a.useCallback)((function(){var a=e.current[n.current];return a?(t.current=a,n.current++,a):(t.current=null,n.current=0,null)}),[]),d=Object(a.useCallback)((function(){return e.current.length}),[]),p=Object(a.useCallback)((function(){var e=o[Math.floor(Math.random()*o.length)];return t.current=e,e}),[o]);return Object(a.useMemo)((function(){return{next:u,reset:l,random:p,maskRef:t,setMasks:s,maskIdxRef:n,getNumMasks:d,hasMasks:!!o.length}}),[u,o,p,l,s,d])}(),c=Object(a.useState)([]),o=Object(h.a)(c,2),i=o[0],s=o[1],l=function(e){var t=I(),n=Object(a.useState)(!1),r=Object(h.a)(n,2),c=r[0],o=r[1],i=Object(a.useCallback)(function(){var n=Object(M.a)(L.a.mark((function n(a){var r,c,i;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,St.a.loadAsync(a);case 2:return r=n.sent,n.next=5,Promise.all(r.filter((function(e){return e.endsWith(".png")})).map((function(e){var t=e.name;return r.file(t).async("base64")})));case 5:return c=n.sent,n.prev=6,n.next=9,Promise.all(c.map((function(e){return t.dataUriToImageData("data:image/png;base64,".concat(e))})));case 9:i=n.sent,e(i),n.next=15;break;case 13:n.prev=13,n.t0=n.catch(6);case 15:o(!1);case 16:case"end":return n.stop()}}),n,null,[[6,13]])})));return function(e){return n.apply(this,arguments)}}(),[e,t]),s=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(t){var n,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(h.a)(t,1),"application/zip"===(a=n[0]).type){e.next=4;break}return console.error("Expected a zip file but got",a.type),e.abrupt("return");case 4:return o(!0),e.next=7,i(a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i]),l=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(t){var n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return o(!0),e.next=5,new St.a.external.Promise((function(e,n){Mt.a.getBinaryContent("/rob_and_adam_code_a_thing"+"/masks/".concat(t),(function(t,a){t?n(t):e(a)}))}));case 5:return n=e.sent,e.next=8,i(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i]),u=Object(a.useCallback)(Object(M.a)(L.a.mark((function e(){var t;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Math.floor(3*Math.random()),e.abrupt("return",l(At(t+1)));case 2:case"end":return e.stop()}}),e)}))),[l]);return Object(a.useMemo)((function(){return{loading:c,handleZipInputChange:s,handleLoadRandomMaskSet:u,handleLoadPreparedMasks:l}}),[c,s,l,u])}(r.setMasks),u=Ce().handlers.speech.say,d=Object(a.useState)(0),p=Object(h.a)(d,2),m=p[0],f=p[1],b=Object(a.useCallback)((function(){s([])}),[]),v=Object(a.useCallback)(function(){var n=Object(M.a)(L.a.mark((function n(a){var c;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return 3e3,a.time.first?(r.next(),f(0),b(),a.useTimer({maxLaps:r.getNumMasks(),printSeconds:!0,announceSeconds:!0,lapDuration:3e3,onLap:function(n){var a=n.predict,c=(n.time,n.stop),o=r.maskRef.current;if(!o)return c();e.current=a(t.videoRef.current).then(function(){var e=Object(M.a)(L.a.mark((function e(n){var a,c,i,l;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Dt(o,n,t.flipX),c=a.score,i=a.targetOverlay,l=t.imageDataToDataUri(i),s((function(e){return[].concat(Object(wt.a)(e),[{score:c,dataUri:l}])})),t.clearCanvas(),r.next();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}})):(c=Math.min(a.time.lapTime/3e3,1),f(Math.round(100*c))),r.maskRef.current&&t.ctx.putImageData(r.maskRef.current,0,0),n.abrupt("return",(function(){e.current?e.current.then(a.webcam.clearCanvas):a.webcam.clearCanvas()}));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[t,r,b]),g=Object(a.useCallback)(function(){var n=Object(M.a)(L.a.mark((function n(a){var c;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return 3e3,a.time.first?(r.random(),f(0),b(),a.useTimer({maxLaps:9999999,printSeconds:!0,announceSeconds:!0,lapDuration:3e3,onLap:function(n){var a=n.predict,c=(n.time,n.stop),o=r.maskRef.current;if(!o)return c();e.current=a(t.videoRef.current).then(function(){var e=Object(M.a)(L.a.mark((function e(n){var a,i,l,u;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Dt(o,n,t.flipX),i=a.score,l=a.targetOverlay,u=t.imageDataToDataUri(l),s((function(e){return[].concat(Object(wt.a)(e),[{score:i,dataUri:u}])})),t.clearCanvas(),!(qe(i)<5)){e.next=10;break}return r.reset(),e.abrupt("return",c());case 10:r.random();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}})):(c=Math.min(a.time.lapTime/3e3,1),f(Math.round(100*c))),r.maskRef.current&&t.ctx.putImageData(r.maskRef.current,0,0),n.abrupt("return",(function(){e.current?e.current.then(a.webcam.clearCanvas):a.webcam.clearCanvas()}));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[t,r,b]),O=Object(a.useCallback)(function(){var a=Object(M.a)(L.a.mark((function a(c){return L.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return 500,c.time.first&&(r.next(),f(0),b(),c.useTimer({printSeconds:!1,announceSeconds:!1,lapDuration:500,postLapDelay:0,onLap:function(a){var c=a.predict,o=(a.time,a.stop),i=r.maskIdxRef.current,l=r.maskRef.current;if(!l)return o(),n.current=0,r.reset(),o();n.current>=i||(e.current=c(t.videoRef.current).then(function(){var e=Object(M.a)(L.a.mark((function e(a){var c,o,d,p,m;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=Tt(l,a,t.flipX),!(qe(c)>5)){e.next=12;break}if(o=Dt(l,a,t.flipX),d=o.score,p=o.targetOverlay,m=t.imageDataToDataUri(p),!(n.current>=i)){e.next=7;break}return e.abrupt("return");case 7:u("Got it!"),s((function(e){return[].concat(Object(wt.a)(e),[{score:d,dataUri:m}])})),t.clearCanvas(),r.next(),n.current++;case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(console.error))}})),r.maskRef.current&&t.ctx.putImageData(r.maskRef.current,0,0),a.abrupt("return",(function(){e.current?e.current.then(c.webcam.clearCanvas):c.webcam.clearCanvas()}));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),[t,r,b,u]);return Object(a.useMemo)((function(){return{zip:l,scores:i,handleLoop:v,handleSurvivalLoop:g,handleTimeAttackLoop:O,clearScores:b,progressPercent:m,reset:r.reset,ready:r.hasMasks,setMasks:r.setMasks}}),[l,i,m,v,g,O,b,r.hasMasks,r.reset,r.setMasks])},Nt=n(280),Ft=n.n(Nt),Ut=function(){var e=Object(a.useRef)(),t=Object(a.useState)([]),n=Object(h.a)(t,2),r=n[0],c=n[1],o=Object(a.useCallback)((function(e){var t=e.currentTarget.name;c((function(e){return e.filter((function(e,n){return n!==+t}))}))}),[]),i=Object(a.useCallback)((function(){c([])}),[]),s=Object(a.useCallback)((function(){var e=new St.a,t=e.folder("masks");r.forEach((function(e,n){var a=e.overlay;t.file("mask-".concat(n,".png"),Ft.a.decode(a).dataBase64,{base64:!0})})),e.generateAsync({type:"blob"}).then((function(e){return function(e,t){if("undefined"!==typeof navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,t);if("undefined"!==typeof navigator.msSaveBlob)return navigator.msSaveBlob(e,t);var n=window.document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t,n.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(n),"function"===typeof n.click?n.click():(n.target="_blank",n.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),URL.revokeObjectURL(n.href)}(e,"masks.zip")}))}),[r]),l=Object(a.useCallback)(function(){var t=Object(M.a)(L.a.mark((function t(n){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.time.first&&n.useTimer({printSeconds:!0,announceSeconds:!0,lapDuration:3e3,onBeforeStartLap:function(){var e=Object(M.a)(L.a.mark((function e(t){var n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.predict,t.webcam,t.time,t.stop,e.abrupt("return",n());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onLap:function(t){var n=t.predict,a=t.webcam;t.time,t.stop;e.current=n(a.videoRef.current).then(function(){var e=Object(M.a)(L.a.mark((function e(t){var n,r,o,i,s;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=It(t,a.flipX),r=n.overlayImageData,o=n.binaryImageData,i=a.imageDataToDataUri(r),s=a.imageDataToDataUri(o),a.clearCanvas(),a.ctx.putImageData(r,0,0),c((function(e){return[].concat(Object(wt.a)(e),[{overlay:i,binary:s}])}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}),t.abrupt("return",(function(){e.current?e.current.then(n.webcam.clearCanvas):n.webcam.clearCanvas()}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]);return Object(a.useMemo)((function(){return{masks:r,handleLoop:l,removeMask:o,downloadMasks:s,removeAllMasks:i}}),[r,l,o,s,i])},_t=function(e){var t=I(),n=Pt(),r=Ut(),c=Object(a.useState)(null),o=Object(h.a)(c,2),i=o[0],s=o[1];Object(a.useEffect)((function(){!e.looping&&i&&s(null)}),[e.looping,i]);var l=Object(a.useCallback)(Object(M.a)(L.a.mark((function t(){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.looping?(e.stop(),n.reset()):(e.start(n.handleLoop),s("play"));case 1:case"end":return t.stop()}}),t)}))),[e,n]),u=Object(a.useCallback)(Object(M.a)(L.a.mark((function t(){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.looping){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,n.zip.handleLoadRandomMaskSet();case 4:l();case 5:case"end":return t.stop()}}),t)}))),[l,e.looping,n.zip]),d=Object(a.useCallback)((function(){e.looping?(e.stop(),n.reset()):(e.start(r.handleLoop),s("capture"))}),[e,r,n]),p=Object(a.useCallback)(Object(M.a)(L.a.mark((function a(){var c;return L.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.looping){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,Promise.all(r.masks.map((function(e){var n=e.overlay;return t.dataUriToImageData(n)})));case 4:c=a.sent,n.setMasks(c),l();case 7:case"end":return a.stop()}}),a)}))),[r.masks,n,t,l,e.looping]);return Object(a.useMemo)((function(){return{loopType:i,simpleGame:n,captureMasks:r,handleClickGame:l,handleStartRandomGame:u,handlePlayCapturedMasks:p,handleClickCaptureMasks:d}}),[i,n,r,l,u,p,d])},Bt=Object(Ve.a)((function(e){return{root:{width:"100%",height:"100%",overflow:"hidden",position:"relative"},scrollContainer:{position:"absolute",top:0,left:0,bottom:0,right:-17,overflowY:"scroll",padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overlay:{background:"rgba(255,255,255,0.5)"},rootTop:{justifyContent:"flex-start"},rootApart:{justifyContent:"space-between"},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},captures:{width:"100%","& > div":{marginTop:e.spacing(1)}},progress:{position:"absolute",top:e.spacing(1),left:e.spacing(8),right:e.spacing(8)}}})),zt=function(e){var t,n,c,o=Bt(),i=on(),s=I(),l=Object(a.useRef)(),u=sn(_t),d=u.loopType,p=u.simpleGame,m=u.captureMasks,f=u.handleClickGame,b=u.handleStartRandomGame,v=u.handlePlayCapturedMasks,g=u.handleClickCaptureMasks,h=i.loop,O=He(100-p.progressPercent),j=Object(a.useMemo)((function(){return[{props:{key:"play/stop",onClick:f,disabled:!h.ready||!h.looping&&!p.ready,children:h.looping?"Stop":"Play"}},{props:{key:"playRandom",color:"secondary",onClick:b,disabled:!h.ready||h.looping,children:"Play Random"}},{props:{containerRef:l,key:"chooseMasks",disabled:!h.ready||h.looping,handleClick:p.zip.handleLoadPreparedMasks},Component:yt,visible:!h.looping},{props:{key:"loadMasks",variant:"contained",onChange:p.zip.handleZipInputChange,disabled:!h.ready||h.looping||p.zip.loading,children:p.loading?"Loading...":"Load Masks"},Component:jt,visible:!h.looping},{props:{key:"captureMasks",onClick:g,disabled:!h.ready||h.looping,children:"Capture Masks",color:"default"},visible:!h.looping}]}),[h.ready,h.looping,f,p.ready,p.loading,b,p.zip.loading,g,p.zip.handleZipInputChange,p.zip.handleLoadPreparedMasks]);return r.a.createElement("div",{className:o.root},r.a.createElement("div",{className:pe()(o.scrollContainer,(c={},Object(P.a)(c,o.overlay,!h.looping),Object(P.a)(c,o.rootTop,!!h.looping),Object(P.a)(c,o.rootApart,!(!(null===(t=p.scores)||void 0===t?void 0:t.length)&&!(null===(n=m.masks)||void 0===n?void 0:n.length))&&s.isFullScreen),c))},r.a.createElement("div",{className:pe()(Object(P.a)({},o.optionsTop,!!h.looping)),ref:l},h.looping?r.a.createElement(vt,{offset:70,buttons:[{props:{key:"stop",onClick:f,children:"Stop"}}]}):r.a.createElement(vt,{buttons:j}),h.looping&&"play"===d&&r.a.createElement("div",{className:o.progress},r.a.createElement(Ct,{color:O,completed:100-p.progressPercent}))),s.isFullScreen&&!h.looping&&r.a.createElement("div",{className:o.captures},r.a.createElement(tt,{results:p.scores,handleClose:p.clearScores}),r.a.createElement(lt,{captureMasks:m,handlePlay:v}))))},Gt=function(e){var t=Pt(),n=Ut(),r=Object(a.useRef)(!1);Object(a.useEffect)((function(){r.current||(r.current=!0,t.zip.handleLoadPreparedMasks("survival_2.zip"))}),[t]);var c=Object(a.useCallback)(Object(M.a)(L.a.mark((function n(){return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.looping?e.stop():e.start(t.handleSurvivalLoop);case 1:case"end":return n.stop()}}),n)}))),[e,t]),o=Object(a.useCallback)((function(){e.looping?e.stop():e.start(n.handleLoop)}),[e,n]);return Object(a.useMemo)((function(){return{loop:e,simpleGame:t,captureMasks:n,handleClickGame:c,handleClickCaptureMasks:o}}),[o,c,e,t,n])},Vt=Object(Ve.a)((function(e){return{root:{padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overlay:{background:"rgba(255,255,255,0.5)"},rootTop:{justifyContent:"flex-start"},rootApart:{justifyContent:"space-between"},options:{display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"space-between",marginBottom:e.spacing(1),"& > *":{marginTop:e.spacing(2),minWidth:150}},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},captures:{width:"100%","& > div":{marginTop:e.spacing(1)}},progress:{position:"absolute",top:e.spacing(1),left:e.spacing(8),right:e.spacing(8)}}})),Yt=function(e){var t,n,a,c=Vt(),o=sn(Gt),i=I(),s=o.loop,l=o.simpleGame,u=o.captureMasks,d=o.handleClickGame,p=He(100-l.progressPercent);return r.a.createElement("div",{className:pe()(c.root,(a={},Object(P.a)(a,c.overlay,!s.looping),Object(P.a)(a,c.rootTop,!!s.looping),Object(P.a)(a,c.rootApart,!(!(null===(t=l.scores)||void 0===t?void 0:t.length)&&!(null===(n=u.masks)||void 0===n?void 0:n.length))&&i.isFullScreen),a))},r.a.createElement("div",{className:pe()(c.options,Object(P.a)({},c.optionsTop,!!s.looping))},s.looping?r.a.createElement("div",{className:c.progress},r.a.createElement(Ct,{color:p,completed:100-l.progressPercent})):r.a.createElement(X.a,{color:"primary",variant:"contained",onClick:d,disabled:!s.ready},"Play")),i.isFullScreen&&!s.looping&&r.a.createElement("div",{className:c.captures},r.a.createElement(tt,{results:l.scores,handleClose:l.clearScores}),r.a.createElement(lt,{captureMasks:u})))},Wt=Object(x.a)((function(e){return{root:{height:"100%",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center","& button":{minWidth:150,marginTop:e.spacing(2)}},transition:{textAlign:"center"},header:{marginBottom:e.spacing(2)}}})),qt=function(e){var t=Wt(),n=Object(a.useCallback)((function(t){var n=t.currentTarget.name;e.setPlayerMode(n)}),[e]),c=Object(a.useMemo)((function(){return De.players.map((function(e){return{props:{key:e,name:e,children:e,onClick:n,disabled:!!Te[e]}}}))}),[n]);return r.a.createElement("div",{className:t.root},r.a.createElement(vt,{buttons:c}))},Xt=function(e){var t=Pt(),n=Object(a.useRef)(!1);Object(a.useEffect)((function(){n.current||(n.current=!0,t.zip.handleLoadPreparedMasks("survival_2.zip"))}),[t]);var r=Object(a.useCallback)(Object(M.a)(L.a.mark((function n(){return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.looping?(e.stop(),t.reset()):e.start(t.handleTimeAttackLoop);case 1:case"end":return n.stop()}}),n)}))),[e,t]);return Object(a.useMemo)((function(){return{simpleGame:t,handleClickGame:r}}),[t,r])},Ht=Object(Ve.a)((function(e){return{root:{width:"100%",height:"100%",overflow:"hidden",position:"relative"},scrollContainer:{position:"absolute",top:0,left:0,bottom:0,right:-17,overflowY:"scroll",padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overlay:{background:"rgba(255,255,255,0.5)"},rootTop:{justifyContent:"flex-start"},rootApart:{justifyContent:"space-between"},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},captures:{width:"100%","& > div":{marginTop:e.spacing(1)}},progress:{position:"absolute",top:e.spacing(1),left:e.spacing(8),right:e.spacing(8)}}})),$t=function(e){var t,n,c=Ht(),o=on(),i=I(),s=sn(Xt),l=s.simpleGame,u=s.handleClickGame,d=o.loop,p=Object(a.useMemo)((function(){return[{props:{key:"play/stop",onClick:u,disabled:!d.ready||!d.looping&&!l.ready,children:d.looping?"Stop":"Play"}}]}),[d.ready,d.looping,u,l.ready]);return r.a.createElement("div",{className:c.root},r.a.createElement("div",{className:pe()(c.scrollContainer,(n={},Object(P.a)(n,c.overlay,!d.looping),Object(P.a)(n,c.rootTop,!!d.looping),Object(P.a)(n,c.rootApart,!!(null===(t=l.scores)||void 0===t?void 0:t.length)&&i.isFullScreen),n))},r.a.createElement("div",{className:pe()(Object(P.a)({},c.optionsTop,!!d.looping))},d.looping?r.a.createElement(vt,{offset:70,buttons:[{props:{key:"stop",onClick:u,children:"Stop"}}]}):r.a.createElement(vt,{buttons:p})),i.isFullScreen&&!d.looping&&r.a.createElement("div",{className:c.captures},r.a.createElement(tt,{results:l.scores,handleClose:l.clearScores}))))},Kt=Object(P.a)({},Ie.screen.PLAY,(g={},Object(P.a)(g,Ie.players.SINGLE_PLAYER,(b={},Object(P.a)(b,Ie.mode[Ie.players.SINGLE_PLAYER].PRACTICE,zt),Object(P.a)(b,Ie.mode[Ie.players.SINGLE_PLAYER].SURVIVAL,Yt),Object(P.a)(b,Ie.mode[Ie.players.SINGLE_PLAYER].TIME_ATTACK,$t),b)),Object(P.a)(g,Ie.players.MULTIPLAYER,(v={},Object(P.a)(v,Ie.mode[Ie.players.MULTIPLAYER].LOCAL,(function(){return"LOCAL Content"})),Object(P.a)(v,Ie.mode[Ie.players.MULTIPLAYER].REMOTE,(function(){return"REMOTE Content"})),v)),g)),Zt=function(e){var t,n,a=e.screen.state,c=a.screen,o=a.mode,i=a.players;if(c===Ie.screen.DEFAULT)return r.a.createElement(qt,{setPlayerMode:e.screen.handlers.setPlayerMode});if(o===Ie.mode.DEFAULT)return r.a.createElement(ht,{screen:e.screen});var s=(null===(t=Kt[c])||void 0===t||null===(n=t[i])||void 0===n?void 0:n[o])||Fe;return r.a.createElement(s,null)},Jt=function(e,t){switch(t.type){case Le:return Object(N.a)(Object(N.a)({},e),{},{mode:t.value});case Se:return Object(N.a)(Object(N.a)({},e),{},{screen:Ie.screen.PLAY,players:t.value});case Re:return Ae;case Me:var n=Object(N.a)({},e);if(e.mode)n.mode=Ie.mode.DEFAULT;else{if(e.screen===Ie.screen.DEFAULT)return e;n.screen=Ie.screen.DEFAULT,n.players=Ie.players.DEFAULT}return n;default:throw new Error("Invalid action: ".concat(t.type))}},Qt=n(281),en=n.n(Qt)()(),tn=Object(a.createContext)(),nn=function(e){var t=e.children,n=function(){var e=I(),t=Object(a.useRef)(),n=Object(a.useRef)(),r=Object(a.useState)(!1),c=Object(h.a)(r,2),o=c[0],i=c[1],s=Object(a.useState)(!1),l=Object(h.a)(s,2),u=l[0],d=l[1];Object(a.useEffect)((function(){!t.current&&e.ready&&(t.current=!0,en.load().then((function(){console.log("BodyPix loaded"),i(!0)})).catch(console.error))}),[e]);var p=Object(a.useCallback)(Object(M.a)(L.a.mark((function t(){var n;return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o){t.next=2;break}throw new Error('Please wait for the model to load before calling "predict"');case 2:return t.next=4,en.predict(e.getVideoAsImageData());case 4:return n=t.sent,t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)}))),[o,e]);return Object(a.useEffect)((function(){!o||n.current||u||(n.current=!0,p().then((function(){d(!0)})))}),[p,o,u]),u?p:null}();return r.a.createElement(tn.Provider,{value:n},t)},an=function(){var e=I(),t=function(){var e=Object(a.useContext)(tn);if(void 0===e)throw new Error("useBodyPix must be used within a BodyPixProvider");return e}(),n=function(){var e=Object(a.useRef)(),t=Object(a.useRef)(),n=Object(a.useRef)(),r=Object(a.useRef)(),c=Object(a.useRef)(),o=Object(a.useCallback)((function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t.current=a,e.current=a,r.current=0,n.current=0,c.current=0}),[]),i=Object(a.useCallback)((function(){c.current=0}),[]),s=Object(a.useCallback)((function(a){var s=!1;t.current||(s=!0,o(a));var l=a-e.current;c.current+=l;var u=0,d=0;n.current++&&(u=1e3/l,d=r.current/n.current,r.current+=u);var p=a-t.current;return e.current=a,{first:s,timestamp:a,fps:u,avgFps:d,elapsed:p,frames:n.current,lapTime:c.current,resetLapTime:i}}),[o,i]);return Object(a.useMemo)((function(){return{update:s,reset:o}}),[s,o])}(),r=function(){var e=Object(a.useRef)(),t=Ce().handlers.speech,n=Object(a.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.onBeforeStartLap,a=t.onLap,r=t.onEnd,c=t.maxLaps,o=t.lapDuration,i=void 0===o?3e3:o,s=t.postLapDelay,l=void 0===s?1e3:s,u=t.printSeconds,d=void 0===u||u,p=t.announceSeconds,m=void 0===p||p;a&&!e.current&&(e.current={onBeforeStartLap:n,onBeforeComplete:!1,onBeforeStarted:!1,onLap:a,onEnd:r,maxLaps:c,numLaps:0,lapDuration:i,postLapDelay:l,printSeconds:d,announceSeconds:m})}),[]),r=Object(a.useCallback)(function(){var n=Object(M.a)(L.a.mark((function n(a){var r,c,o,i,s,l,u;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=a.time,c=a.webcam,o=a.predict,i=a.stop,!e.current){n.next=33;break}if(!e.current.onBeforeStartLap||e.current.onBeforeComplete){n.next=13;break}if(!e.current.onBeforeStarted){n.next=7;break}return n.abrupt("return");case 7:return e.current.onBeforeStarted=!0,n.next=10,e.current.onBeforeStartLap({time:r,webcam:c,predict:o,stop:i});case 10:return e.current.onBeforeComplete=!0,r.resetLapTime(),n.abrupt("return");case 13:if(!e.current.maxLaps||e.current.numLaps!==e.current.maxLaps){n.next=19;break}if(!e.current.onEnd){n.next=17;break}return n.next=17,e.current.onEnd({time:r,webcam:c,predict:o,stop:i});case 17:return e.current=null,n.abrupt("return",i());case 19:if(s=Math.floor(r.lapTime/1e3),l=Math.max(e.current.lapDuration/1e3-s,0),e.current.printSeconds&&((u=c.ctx).font="40px Arial",u.fillStyle="white",u.clearRect(0,0,50,50),l&&u.fillText(l,10,40)),l&&e.current.announceSeconds&&e.current.lastSpeech!==l&&(e.current.lastSpeech=l,t.say("".concat(l))),!(r.lapTime>=e.current.lapDuration)||e.current.handlerCalled){n.next=32;break}return e.current.numLaps++,e.current.handlerCalled=!0,e.current.handlerResolved=!1,n.next=29,e.current.onLap({time:r,webcam:c,predict:o,stop:i,lapNum:e.current.numLaps});case 29:e.current.handlerResolved=!0,n.next=33;break;case 32:r.lapTime>=e.current.lapDuration+e.current.postLapDelay&&e.current.handlerResolved&&(r.resetLapTime(),e.current.handlerCalled=!1,e.current.handlerResolved=!1);case 33:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[t]),c=Object(a.useCallback)((function(){e.current=null}),[]);return Object(a.useMemo)((function(){return{clear:c,useTimer:n,handleLap:r}}),[c,n,r])}(),c=Object(a.useRef)(),o=Object(a.useRef)(),i=Object(a.useState)(!1),s=Object(h.a)(i,2),l=s[0],u=s[1],d=Object(a.useCallback)((function(){r.clear(),n.reset(),c.current=!0,u(!0)}),[n,r]),p=Object(a.useCallback)((function(){c.current=!1,u(!1)}),[]),m=Object(a.useCallback)(function(){var a=Object(M.a)(L.a.mark((function a(i){var s,l;return L.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s=n.update(i),a.next=3,o.current({time:s,webcam:e,predict:t,useTimer:r.useTimer,stop:p});case 3:l=a.sent,r.handleLap({time:s,webcam:e,predict:t,stop:p}),c.current?requestAnimationFrame(m):(p(),o.current=null,e.clearCanvas(),l&&l());case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),[e,t,r,n,p]),f=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(n){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.current){e.next=4;break}throw new Error("The loop is already running");case 4:if(t){e.next=8;break}throw new Error("Please wait for BodyPix to load...");case 8:if(n){e.next=10;break}throw new Error("A loop handler is required when calling loop.start");case 10:return o.current=n,d(),e.abrupt("return",requestAnimationFrame(m));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[m,t,d]);return Object(a.useMemo)((function(){return{start:f,looping:l,stop:p,ready:t&&e.ready}}),[f,t,l,p,e.ready])},rn=function(){var e=an(),t=Object(a.useState)(null),n=Object(h.a)(t,2),r=n[0],c=n[1],o=function(){var e=Object(a.useReducer)(Jt,Ae),t=Object(h.a)(e,2),n=t[0],r=t[1],c=Object(a.useCallback)((function(e){if(!De.screen.includes(e))throw new Error("Unknown screen: ".concat(e));r({type:xe,value:e})}),[]),o=Object(a.useCallback)((function(e){if(![].concat(Object(wt.a)(De.mode[Ie.players.SINGLE_PLAYER]),Object(wt.a)(De.mode[Ie.players.MULTIPLAYER])).includes(e))throw new Error("Unknown gameMode: ".concat(e));r({type:Le,value:e})}),[]),i=Object(a.useCallback)((function(e){if(!De.players.includes(e))throw new Error("Unknown playerMode: ".concat(e));r({type:Se,value:e})}),[]),s=Object(a.useCallback)((function(){r({type:Re})}),[]),l=Object(a.useCallback)((function(){r({type:Me})}),[]);return[n,Object(a.useMemo)((function(){return{setScreen:c,resetState:s,setGameMode:o,reverseState:l,setPlayerMode:i}}),[c,s,o,l,i])]}(),i=Object(h.a)(o,2),s=i[0],l=i[1];return Object(a.useEffect)((function(){s.screen!==Ie.screen.DEFAULT&&s.mode!==Ie.mode.DEFAULT||!r||c(null)}),[s,r]),Object(a.useEffect)((function(){s.screen!==Ie.screen.DEFAULT&&s.mode!==Ie.mode.DEFAULT||!e.looping||e.stop()}),[s,e]),Object(a.useMemo)((function(){return{screen:{state:s,handlers:l},mode:r,loop:e,setMode:c}}),[s,l,r,e])},cn=Object(a.createContext)(),on=function(){var e=Object(a.useContext)(cn);if(!e)throw new Error("useGame must be called from inside the <Game> component.");return e},sn=function(e){var t=on(),n=t.loop,r=t.setMode,c=e(n);return Object(a.useEffect)((function(){r(c)}),[c,r]),c},ln=Object(a.memo)((function(e){e.webcam;var t=rn();return r.a.createElement(cn.Provider,{value:t},r.a.createElement(Ne,{mode:t.screen.state.mode,screen:t.screen.state.screen,goHome:t.screen.handlers.resetState,goBack:t.screen.handlers.reverseState}),r.a.createElement(Ge,{screenState:t.screen.state}),r.a.createElement(ue,{overlay:!t.screen.state.mode},r.a.createElement(Zt,{screen:t.screen})),r.a.createElement(ft,{screen:t.screen}))})),un=function(){return r.a.createElement("div",null,"Sorry, but this game requires a webcam. Please plug in a webcam and refresh the page.")},dn=Object(x.a)((function(e){return{root:{maxWidth:1100,margin:"0 auto ".concat(e.spacing(2),"px")}}})),pn=Object(a.memo)((function(e){var t=I(),n=t.currentDeviceId,c=t.hasVideo,o=t.cameras,i=t.autoStartDeviceId,s=Object(a.useRef)();Object(a.useEffect)((function(){c&&o.length&&(n||i)&&!s.current&&(s.current=!0,t.start().catch(console.error))}),[c,o,n,i]);var l=dn();return r.a.createElement("main",{className:l.root},c?r.a.createElement(ln,{webcam:t}):r.a.createElement(un,null))})),mn=Object(y.a)({palette:{primary:w.a}});var fn=function(){var e=Object(a.useState)(!1),t=Object(h.a)(e,2),n=t[0],c=t[1],o=Object(a.useRef)();return Object(a.useEffect)((function(){var e=setInterval((function(){window.cvReady&&(c(!0),clearInterval(e))}),200);return function(){clearInterval(e)}}),[]),Object(a.useEffect)((function(){o.current||(o.current=!0,j.a.init({selector:".background"}))})),r.a.createElement(E.a,{theme:mn},r.a.createElement(D,null,r.a.createElement(nn,null,r.a.createElement(we,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,null),r.a.createElement(pn,{cvReady:n}))))))};o.a.render(r.a.createElement(fn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[292,1,2]]]);
//# sourceMappingURL=main.71033898.chunk.js.map