(this.webpackJsonpcarbon_copy=this.webpackJsonpcarbon_copy||[]).push([[0],{118:function(e,t,n){e.exports=n.p+"static/media/logo512.e400cec2.png"},297:function(e,t,n){var a=n(577),r=["load","predict"];e.exports=function(){var e=new Worker(n.p+"e7c4556103d7ca32aea4.worker.js",{name:"[hash].worker.js"});return a(e,r),e}},312:function(e,t,n){e.exports=n(578)},317:function(e,t,n){},332:function(e,t){},334:function(e,t){},382:function(e,t){},384:function(e,t){},412:function(e,t){},414:function(e,t){},415:function(e,t){},421:function(e,t){},423:function(e,t){},441:function(e,t){},443:function(e,t){},455:function(e,t){},458:function(e,t){},463:function(e,t){},465:function(e,t){},488:function(e,t){},578:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),o=n.n(c);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(317);var i,l,s,u,d,p=n(3),m=n(272),f=n.n(m),b=n(172),v=n(623),g=n(106),h=n(298),O=n(622),j=n(581),y=n(4),k=n.n(y),E=n(11),C=Object(a.createContext)(),w=function(){var e=Object(a.useContext)(C);if(!e)throw new Error("useWebcam must be used within a WebcamProvider");return e},x=!!(null===(i=navigator)||void 0===i||null===(l=i.mediaDevices)||void 0===l?void 0:l.getUserMedia),S=function(e){var t,n,c,o,i=e.children,l=Object(a.useRef)(),s=Object(a.useRef)(),u=Object(a.useRef)(),d=Object(a.useState)(null),m=Object(p.a)(d,2),f=m[0],b=m[1],v=Object(a.useState)(!0),g=Object(p.a)(v,2),h=g[0],O=g[1],j=Object(a.useState)(!1),y=Object(p.a)(j,2),w=y[0],S=y[1],I=Object(a.useState)([]),T=Object(p.a)(I,2),M=T[0],R=T[1],L=Object(a.useState)(!0),A=Object(p.a)(L,2),P=A[0],D=A[1],N=Object(a.useState)(null),F=Object(p.a)(N,2),U=F[0],B=F[1],_=Object(a.useState)(null),z=Object(p.a)(_,2),Y=z[0],G=z[1],V=Object(a.useState)(null),W=Object(p.a)(V,2),q=W[0],X=W[1],H=Object(a.useState)(!1),K=Object(p.a)(H,2),$=K[0],Z=K[1],J=Object(a.useState)(!1),Q=Object(p.a)(J,2),ee=Q[0],te=Q[1],ne=Object(a.useState)(void 0),ae=Object(p.a)(ne,2),re=ae[0],ce=ae[1],oe=Object(a.useState)(void 0),ie=Object(p.a)(oe,2),le=ie[0],se=ie[1];Object(a.useEffect)((function(){u.current&&!f?b(u.current.getContext("2d")):f&&!u.current&&b(null)}),[f]),Object(a.useEffect)((function(){if(w&&!U){var e=document.createElement("canvas");e.width=u.current.width,e.height=u.current.height;var t=e.getContext("2d");B({ctx:t,canvas:e})}}),[U,w]);var ue=Object(a.useCallback)((function(){D(!1)}),[]),de=Object(a.useCallback)((function(){D(!0)}),[]),pe=Object(a.useCallback)((function(){U.ctx.clearRect(0,0,u.current.width,u.current.height)}),[U]),me=Object(a.useCallback)((function(){var e,t;f.clearRect(0,0,null===(e=u.current)||void 0===e?void 0:e.width,null===(t=u.current)||void 0===t?void 0:t.height)}),[f]),fe=Object(a.useCallback)((function(){q&&q.getTracks().forEach((function(e){return e.stop()})),G(null),X(null),S(!1),ce(void 0)}),[q]),be=Object(a.useCallback)(function(){var e=Object(E.a)(k.a.mark((function e(t){var n,a,r,c,o,i,l,u,d,p,m,f,b;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(fe(),x){e.next=6;break}return"Video not supported",console.error("Video not supported"),G("Video not supported"),e.abrupt("return");case 6:return a=(n="number"===typeof t)?{}:t||{},r=n?t:a.deviceIdx,e.prev=9,console.log("Finding Webcams..."),i={video:{width:{exact:a.width||1280},height:{exact:a.height||720}},audio:!1},void 0!==r&&(a.deviceId=null===(l=M[r])||void 0===l?void 0:l.deviceId),a.deviceId&&(i.video.deviceId={exact:a.deviceId}),e.next=16,navigator.mediaDevices.getUserMedia(i);case 16:u=e.sent,d=null===(c=u.getTracks()[0])||void 0===c||null===(o=c.getCapabilities())||void 0===o?void 0:o.deviceId,console.log("Found webcam!"),X(u),ce(d),G(!1),te(!1),Z(!1),s.current.srcObject=u,e.next=37;break;case 27:return e.prev=27,e.t0=e.catch(9),"Error starting video.",console.error("Error starting video."),console.error(e.t0.message),(null===(p=e.t0.message)||void 0===p||null===(m=p.toLowerCase)||void 0===m||null===(f=m.call(p))||void 0===f||null===(b=f.includes)||void 0===b?void 0:b.call(f,"permission denied"))&&te(!0),X(null),S(!1),G("Error starting video."),e.abrupt("return");case 37:return e.next=39,Promise.all([new Promise((function(e){s.current.onloadedmetadata=function(){return e()}})),new Promise((function(e){s.current.onloadeddata=function(){return e()}}))]).then((function(){console.log("Webcam ready!"),S(!0),D(!1)}));case 39:return e.abrupt("return",e.sent);case 40:case"end":return e.stop()}}),e,null,[[9,27]])})));return function(t){return e.apply(this,arguments)}}(),[fe,s,M]),ve=Object(a.useCallback)(Object(E.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",be({deviceId:le}));case 1:case"end":return e.stop()}}),e)}))),[le,be]),ge=Object(a.useCallback)(Object(E.a)(k.a.mark((function e(){var t,n,a,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=navigator)||void 0===t||null===(n=t.mediaDevices)||void 0===n?void 0:n.enumerateDevices){e.next=4;break}return console.error("Cannot get cameras."),e.abrupt("return",[]);case 4:return e.next=6,navigator.mediaDevices.enumerateDevices();case 6:return a=e.sent,r=a.filter((function(e){var t=e.kind,n=e.label;return"videoinput"===t&&!n.includes("CamTwist")})).map((function(e){var t,n=e.label.lastIndexOf(" (");return n>-1&&(t=e.label.slice(0,n)),t?{deviceId:e.deviceId,label:t}:e})),R(r),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)}))),[]),he=Object(a.useCallback)((function(){return O((function(e){return!e}))}),[]),Oe=Object(a.useCallback)((function(e){window.localStorage.setItem("AutoStartId",e),se(e)}),[]),je=Object(a.useCallback)((function(){window.localStorage.removeItem("AutoStartId"),se(null)}),[]),ye=Object(a.useCallback)((function(e){pe(),U.ctx.putImageData(e,0,0);var t=U.canvas.toDataURL("image/png");return pe(),t}),[U,pe]),ke=Object(a.useCallback)(function(){var e=Object(E.a)(k.a.mark((function e(t){var n,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pe(),(n=new Image).src=t,e.next=5,new Promise((function(e){n.onload=function(){U.ctx.drawImage(n,0,0),e()}}));case 5:return a=U.ctx.getImageData(0,0,u.current.width,u.current.height),pe(),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[pe,U]),Ee=Object(a.useCallback)((function(){pe(),U.ctx.drawImage(s.current,0,0);var e=U.ctx.getImageData(0,0,u.current.width,u.current.height);return pe(),e}),[pe,U]);Object(a.useEffect)((function(){ge().then((function(e){var t,n=window.localStorage.getItem("AutoStartId"),a=!1,r=null===(t=e[0])||void 0===t?void 0:t.deviceId;(r=e.reduce((function(e,t,r){var c=t.deviceId,o=t.label;return c||(a=!0),c===n?c:e||(o.includes("Built-in")?c:null)}),null)||r)?Oe(r):a?(Z(!0),console.warn("Need video permissions!")):!r&&n&&je()}))}),[]);var Ce=!!((null===(t=l.current)||void 0===t?void 0:t.requestFullscreen)||(null===(n=l.current)||void 0===n?void 0:n.mozRequestFullScreen)||(null===(c=l.current)||void 0===c?void 0:c.webkitRequestFullscreen)||(null===(o=l.current)||void 0===o?void 0:o.msRequestFullscreen)),we=Object(a.useState)(!1),xe=Object(p.a)(we,2),Se=xe[0],Ie=xe[1];Object(a.useEffect)((function(){var e=function(){var e=!!document.fullscreenElement;Ie(e)};return document.addEventListener("fullscreenchange",e),function(){return document.removeEventListener("fullscreenchange",e)}}),[]);var Te=Object(a.useCallback)((function(){Ce&&(l.current.requestFullscreen?l.current.requestFullscreen():l.current.mozRequestFullScreen?l.current.mozRequestFullScreen():l.current.webkitRequestFullscreen?l.current.webkitRequestFullscreen():l.current.msRequestFullscreen&&l.current.msRequestFullscreen())}),[Ce]),Me=Object(a.useCallback)((function(){Ce&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())}),[Ce]),Re=Object(a.useCallback)((function(){Se?Me():Te()}),[Se,Te,Me]),Le=Object(a.useMemo)((function(){return{ctx:f,ready:w,flipX:h,start:ve,hidden:P,rootRef:l,cameras:M,setFlipX:O,videoRef:s,hasVideo:x,_setHidden:de,canvasRef:u,stopVideo:fe,setVisible:ue,startVideo:be,videoError:Y,scratchpad:U,clearCanvas:me,toggleFlipX:he,videoStream:q,hasFullScreen:Ce,exitFullScreen:Me,clearScratchpad:pe,currentDeviceId:re,enterFullScreen:Te,stop:fe,discoverCameras:ge,permissionNeeded:$,permissionDenied:ee,toggleFullScreen:Re,autoStartDeviceId:le,imageDataToDataUri:ye,dataUriToImageData:ke,getVideoAsImageData:Ee,setAutoStartDeviceId:Oe,clearAutoStartDeviceId:je,isFullScreen:Se}}),[f,w,h,ve,P,M,O,de,fe,Se,ue,be,Y,U,he,me,q,Ce,Me,pe,re,Te,ge,$,ee,Re,le,ye,ke,Ee,Oe,je]);return r.a.createElement(C.Provider,{value:Le},i)},I=n(46),T=n(6),M=n(25),R=n(579),L=n(15),A=n(284),P=n.n(A),D=n(283),N=n.n(D),F=n(118),U=n.n(F),B=function(e){var t=e.color,n=void 0===t?"#fff":t,a=Object(L.c)({to:{opacity:1},from:{opacity:0},config:L.b.stiff});return r.a.createElement(L.a.div,{style:a},r.a.createElement("svg",{version:"1.1",id:"L7",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 100 100",enableBackground:"new 0 0 100 100"},r.a.createElement("path",{fill:n,d:"M31.6,3.5C5.9,13.6-6.6,42.7,3.5,68.4c10.1,25.7,39.2,38.3,64.9,28.1l-3.1-7.9c-21.3,8.4-45.4-2-53.8-23.3 c-8.4-21.3,2-45.4,23.3-53.8L31.6,3.5z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"2s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"})),r.a.createElement("path",{fill:n,d:"M42.3,39.6c5.7-4.3,13.9-3.1,18.1,2.7c4.3,5.7,3.1,13.9-2.7,18.1l4.1,5.5c8.8-6.5,10.6-19,4.1-27.7 c-6.5-8.8-19-10.6-27.7-4.1L42.3,39.6z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"1s",from:"0 50 50",to:"-360 50 50",repeatCount:"indefinite"})),r.a.createElement("path",{fill:n,d:"M82,35.7C74.1,18,53.4,10.1,35.7,18S10.1,46.6,18,64.3l7.6-3.4c-6-13.5,0-29.3,13.5-35.3s29.3,0,35.3,13.5 L82,35.7z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"2s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"}))))},_=n(625),z=n(628),Y=n(629),G=n(624),V=n(613),W=n(277),q=n.n(W),X=n(31),H=n.n(X),K=n(609),$=Object(j.a)((function(e){return{btn:{border:"2px solid ".concat(e.palette.secondary.main),background:e.palette.primary.main,color:e.palette.secondary.main,transition:"300ms all","&:hover":{border:"2px solid ".concat(e.palette.primary.main),background:e.palette.secondary.main,color:e.palette.primary.main}}}})),Z=function(e){var t=e.Icon,n=e.className,a=Object(I.a)(e,["Icon","className"]),c=$();return r.a.createElement(K.a,Object.assign({size:"small",className:H()(c.btn,Object(T.a)({},n,n))},a),r.a.createElement(t,null))},J=function(){},Q=Object(j.a)((function(e){return{root:function(e){return{position:"relative"}},arrowIcon:function(t){return{marginLeft:e.spacing(1)}},tooltip:function(e){return{position:"relative",margin:0}},arrow:function(e){return{position:"absolute",fontSize:6,"&::before":{content:'""',margin:"auto",display:"block",width:0,height:0,borderStyle:"solid"}}},paper:{border:"1px solid #d3d4d5"},popper:function(t){return{'&[x-placement*="bottom"] $arrow':{top:0,left:0,marginTop:"-0.95em",width:"2em",height:"1em","&::before":{borderWidth:"0 1em 1em 1em",borderColor:"transparent transparent ".concat(e.palette.grey[700]," transparent")}},'&[x-placement*="top"] $arrow':{bottom:0,left:0,marginBottom:"-0.95em",width:"2em",height:"1em","&::before":{borderWidth:"1em 1em 0 1em",borderColor:"".concat(e.palette.grey[700]," transparent transparent transparent")}},'&[x-placement*="right"] $arrow':{left:0,marginLeft:"-0.95em",height:"2em",width:"1em","&::before":{borderWidth:"1em 1em 1em 0",borderColor:"transparent ".concat(e.palette.grey[700]," transparent transparent")}},'&[x-placement*="left"] $arrow':{right:0,marginRight:"-0.95em",height:"2em",width:"1em","&::before":{borderWidth:"1em 0 1em 1em",borderColor:"transparent transparent transparent ".concat(e.palette.grey[700])}}}}}})),ee=function(e){var t,n=Q(e),c=Object(a.useMemo)(Math.random,[]),o=Object(a.useRef)(),i=Object(a.useState)(null),l=Object(p.a)(i,2),s=l[0],u=l[1],d=Object(a.useState)(null),m=Object(p.a)(d,2),f=m[0],b=m[1];Object(a.useEffect)((function(){return o.current=!0,function(){o.current=!1}}),[]);var v=Object(a.useCallback)((function(e){o.current&&u(e.currentTarget)}),[]),g=Object(a.useCallback)((function(){o.current&&u(null)}),[]),h=Object(a.useCallback)(Object(E.a)(k.a.mark((function t(){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e.onClose||J)();case 2:!0!==t.sent&&g();case 4:case"end":return t.stop()}}),t)}))),[g,e.onClose]),O=Object(a.useCallback)((function(t){(e.onClickCheckbox||J)(t.target.value,h)}),[e.onClickCheckbox,h]),j=Object(a.useCallback)((function(t){return function(){var n=Object(E.a)(k.a.mark((function n(a){return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("checkbox"!==a.target.type){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,(e.onSelect||J)(t);case 4:!0!==n.sent&&h();case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}),[h,e.onSelect]),y=!!s;return r.a.createElement("div",{className:n.root},r.a.createElement(Z,Object.assign({"aria-haspopup":"true",className:n.button,onClick:v,"aria-controls":"select-and-check-".concat(c),Icon:q.a},e.SelectProps)),r.a.createElement(_.a,Object.assign({keepMounted:!0,open:y,elevation:0,anchorEl:s,getContentAnchorEl:null,onClose:h,id:"select-and-check-".concat(c),classes:{paper:n.paper},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e.MenuProps),null===(t=e.options)||void 0===t?void 0:t.map((function(t,a){var c=t.key,o=t.value,i=t.text,l=t.selected,s=t.tooltipTitle,u=t.checked,d=t.checkboxValue,p=null;if("boolean"===typeof u){var m=r.a.createElement(G.a,{checked:u,onClick:O,value:void 0===d?o:d}),v=s||e.tooltipTitle;p=v?r.a.createElement(z.a,{classes:{tooltip:n.tooltip,popper:n.popper},PopperProps:{popperOptions:{modifiers:{arrow:{enabled:!!f,element:f}}}},title:r.a.createElement(r.a.Fragment,null,v,r.a.createElement("span",{className:n.arrow,ref:b})),enterDelay:void 0===e.tooltipEnterDelay?750:e.tooltipEnterDelay,leaveDelay:e.tooltipLeaveDelay||0,"aria-label":"checkbox",placement:e.tooltipPlacement||"top"},m):m}return r.a.createElement(Y.a,Object.assign({key:c||a,onClick:j(o),selected:l},e.MenuItemProps),p,r.a.createElement(V.a,{primary:i||(null===o||void 0===o?void 0:o.toString())}))}))))},te=Object(j.a)((function(e){return{root:function(e){return{}}}})),ne=function(e){var t,n=w(),c=te(Object(M.a)(Object(M.a)({},e),n)),o=Object(a.useMemo)((function(){var e={deviceId:null,label:null,none:!0};return n.currentDeviceId?(n.cameras.some((function(t){return t.deviceId===n.currentDeviceId&&(e=t,!0)})),e):e}),[n.cameras,n.currentDeviceId]),i=Object(a.useCallback)((function(e){n.currentDeviceId!==e&&n.startVideo({deviceId:e})}),[n]),l=Object(a.useCallback)((function(e){n.autoStartDeviceId===e?n.clearAutoStartDeviceId():(n.setAutoStartDeviceId(e),i(e))}),[n,i]);return r.a.createElement("div",{className:c.root},r.a.createElement(ee,{activeTitle:"Select Camera",title:(null===(t=n.cameras)||void 0===t?void 0:t.length)?o.label||"No Camera Selected":"No Cameras Detected",onSelect:i,onClickCheckbox:l,options:n.cameras.map((function(e){return{key:e.label,value:e.deviceId,text:e.label||"Unknown Device",selected:e.deviceId===n.currentDeviceId,checked:n.autoStartDeviceId===e.deviceId,tooltipTitle:n.autoStartDeviceId===e.deviceId?"Remove Default":"Set Default"}}))}))},ae=Object(j.a)((function(e){return{root:{position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",alignItems:"center",justifyContent:"center"},paper:{padding:e.spacing(2),borderRadius:e.spacing(1),display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center","& h1":{marginBottom:e.spacing(2)},"& p":{marginBottom:e.spacing(1)}}}})),re=function(e){var t=ae(e),n=Object(L.c)({transform:"translate3d(0,0px,0)",from:{transform:"translate3d(0,-500px,0)"},config:L.b.slow}),a=Object(L.c)({to:{opacity:e.permissionDenied?1:0},config:L.b.wobbly});return r.a.createElement("div",{className:t.root},r.a.createElement(L.a.div,{style:n},r.a.createElement(R.a,{elevation:4,className:t.paper},r.a.createElement("div",{className:t.container},e.permissionDenied?r.a.createElement(L.a.div,{style:a},r.a.createElement(g.a,{component:"h1",variant:"h6"},"It looks like you have denied webcam access."),r.a.createElement(g.a,{component:"p"},"Please take a look at"," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://support.google.com/chrome/answer/2693767"},"this article")," ","in order to enable access."),r.a.createElement(g.a,{component:"p"},"Once your webcam has been enabled, return here to play the game!")):r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,{component:"h1",variant:"h6"},"In order to play the game, you must grant permission to access your webcam."),r.a.createElement(g.a,{component:"p"},"Please select a camera."),r.a.createElement(ne,null))))))},ce=n(279),oe=n.n(ce),ie=n(280),le=n.n(ie),se=n(281),ue=n.n(se),de=n(282),pe=n.n(de),me=Object(j.a)((function(e){return{root:{display:"flex",alignItems:"center",justifyContent:"space-between","& > *":{marginLeft:e.spacing(1)}}}})),fe=function(e){var t=me(),n=e.controller,a=n.onHomeScreen,c=n.handleBack,o=n.toggleAudio,i=n.audioState,l=n.openHelp,s=Object(L.c)({to:{opacity:a?0:1},config:L.b.stiff});return r.a.createElement("div",{className:t.root},!a&&r.a.createElement(L.a.div,{style:s},r.a.createElement(Z,{onClick:c,Icon:oe.a})),!e.isFullScreen&&r.a.createElement(ne,null),r.a.createElement(Z,{onClick:o,Icon:i?le.a:ue.a}),!e.isFullScreen&&r.a.createElement(Z,{onClick:l,Icon:pe.a}))},be=Object(j.a)((function(e){return{root:function(t){var n=t.isFullScreen;return Object(M.a)(Object(T.a)({maxWidth:1100,margin:"0 auto",position:"relative",height:"calc(0.5625 * (100vw - ".concat(e.spacing(4),"px))")},"@media(min-width: ".concat(1100,"px)"),{height:n?"100%":"calc(0.5625 * (".concat(1100,"px - ").concat(e.spacing(4),"px))")}),n?{display:"flex",alignItems:"center",justifyContent:"center"}:{})},container:function(t){var n=t.isFullScreen;return{width:"100%",position:"relative",paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},video:function(t){var n=t.flipX,a=t.isFullScreen;return Object(M.a)({width:"100%",height:"100%",borderRadius:a?0:e.spacing(1)},n?{"p-webkit-transform":"scaleX(- 1)",transform:"scaleX(-1)"}:{})},canvas:function(t){var n=t.isFullScreen;return{borderRadius:n?0:e.spacing(1),position:"absolute",top:0,left:0,width:"100%",paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},children:function(t){var n=t.isFullScreen;return{borderRadius:n?0:e.spacing(1),overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",bottom:5,zIndex:1,paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},fullScreen:{position:"absolute",bottom:e.spacing(1.5),right:function(t){var n=t.isFullScreen;return e.spacing(n?1.5:3)},zIndex:20},overlay:function(t){var n=t.overlayColor,a=t.isFullScreen;return{background:n,position:"absolute",top:0,bottom:5,left:a?0:e.spacing(2),right:a?0:e.spacing(2),borderRadius:a?0:e.spacing(1),zIndex:0}},loader:{position:"absolute",top:0,left:0,bottom:0,right:0,width:"100%",display:"flex",alignItems:"center",justifyContent:"center","& > div":{width:100,height:100}},paper:{top:0,bottom:5,zIndex:-1,position:"absolute",left:e.spacing(2),right:e.spacing(2),borderRadius:e.spacing(1)},buttons:{position:"absolute",top:e.spacing(1.5),right:e.spacing(1.5),zIndex:20},logo:{position:"absolute",top:e.spacing(1.5),left:e.spacing(1.5),zIndex:20,width:34}}})),ve=function(e){var t,n,a,c,o,i,l,s,u=e.overlay,d=Object(I.a)(e,["overlay"]),p=w(),m="string"!==typeof u?"rgba(255,255,255,0.5)":u,f=be(Object(M.a)(Object(M.a)(Object(M.a)({},d),p),{},{overlayColor:m})),b=Object(L.c)({to:{opacity:p.hidden?0:1},config:L.b.stiff});return r.a.createElement("div",{ref:p.rootRef,className:f.root},r.a.createElement(L.a.div,{style:b,className:f.container},r.a.createElement(r.a.Fragment,null,r.a.createElement("video",{autoPlay:!0,ref:p.videoRef,className:f.video,width:null===(t=p.videoRef)||void 0===t||null===(n=t.current)||void 0===n?void 0:n.videoWidth,height:null===(a=p.videoRef)||void 0===a||null===(c=a.current)||void 0===c?void 0:c.videoHeight}),r.a.createElement("canvas",{ref:p.canvasRef,className:f.canvas,width:null===(o=p.videoRef)||void 0===o||null===(i=o.current)||void 0===i?void 0:i.videoWidth,height:null===(l=p.videoRef)||void 0===l||null===(s=l.current)||void 0===s?void 0:s.videoHeight}),!p.hidden&&u&&r.a.createElement("div",{className:f.overlay}),d.children&&!p.hidden&&r.a.createElement("div",{className:f.children},d.children),p.hasFullScreen&&r.a.createElement(Z,{className:f.fullScreen,onClick:p.toggleFullScreen,Icon:p.isFullScreen?N.a:P.a})),!p.isFullScreen&&r.a.createElement(R.a,{elevation:4,className:f.paper}),p.isFullScreen&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:f.buttons},r.a.createElement(fe,{controller:d.headerController,isFullScreen:!0})),r.a.createElement("img",{className:f.logo,alt:"Carbon Copy Logo",src:U.a}))),p.permissionNeeded?r.a.createElement(re,{permissionDenied:p.permissionDenied}):p.hidden&&r.a.createElement("div",{className:f.loader},r.a.createElement("div",null,r.a.createElement(B,{color:"#000"}))))},ge=n(630),he=n(614),Oe=n(615),je=n(83),ye=n.n(je),ke=Object(j.a)((function(e){return{closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1)},ever:{fontWeight:"bold",fontStyle:"italic"}}})),Ee=Object(a.memo)((function(e){var t=e.open,n=e.handleClose,a=ke();return r.a.createElement(ge.a,{onClose:n,"aria-labelledby":"information",open:t,className:a.dialogRoot},r.a.createElement(he.a,{disableTypography:!0,id:"information"},r.a.createElement(g.a,{variant:"h5"},"Carbon Copy Fun!"),r.a.createElement(K.a,{"aria-label":"close",className:a.closeButton,onClick:n},r.a.createElement(ye.a,null))),r.a.createElement(Oe.a,{dividers:!0,className:a.dialogContent},r.a.createElement(g.a,{component:"h2",variant:"h6"},"Setup"),r.a.createElement(g.a,{gutterBottom:!0},"Place your webcam so that your entire body fits within the frame, and ensure there is enough space around you to move safely."),r.a.createElement(g.a,{gutterBottom:!0},"Be prepared to move side to side, forward and back, and even to jump and crouch."),r.a.createElement(g.a,{component:"h2",variant:"h6"},"Performance"),r.a.createElement(g.a,{gutterBottom:!0},"This game relies on state-of-the-art computer vision algorithms in order to detect the location of your body. This requires significant compute power. Don't be afraid if you hear your computer making noise."),r.a.createElement(g.a,{component:"h2",variant:"h6"},"Privacy"),r.a.createElement(g.a,{gutterBottom:!0},"Although this game requires your webcam to function, no personal images or data are collected by this application.")))})),Ce=Object(j.a)((function(e){return{root:{marginTop:e.spacing(2),paddingLeft:e.spacing(2),paddingRight:e.spacing(2),width:"100%",maxWidth:1100,display:"flex",margin:"0 auto",alignItems:"center",justifyContent:"space-between"},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1)},ever:{fontWeight:"bold",fontStyle:"italic"},title:{display:"flex",alignItems:"center","& > img":{width:34,marginRight:e.spacing(1)},"& > h1":{}}}})),we=Object(a.memo)((function(e){var t=Ce();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.title},r.a.createElement("img",{src:U.a,alt:"Carbon Copy Logo"}),r.a.createElement(g.a,{variant:"h4",component:"h1"},"Carbon Copy")),r.a.createElement(fe,{controller:e.controller})),r.a.createElement(Ee,{open:e.controller.helpOpen,handleClose:e.controller.closeHelp}))})),xe=Object(j.a)((function(e){return{heading:{marginLeft:e.spacing(2)}}})),Se=function(e){var t,n,a,c,o=xe(),i=w(),l=sa(),s=Object(L.c)({to:{opacity:i.hidden?0:1},config:L.b.stiff}),u=i.hidden?"":(null===l||void 0===l||null===(t=l.screen)||void 0===t||null===(n=t.state)||void 0===n?void 0:n.mode)||("play"===(null===l||void 0===l||null===(a=l.screen)||void 0===a||null===(c=a.state)||void 0===c?void 0:c.screen)?"Choose Mode":"Select Players");return r.a.createElement(g.a,{component:"h1",variant:"h6",className:o.heading},r.a.createElement(L.a.div,{style:s},u))},Ie="set_screen",Te="set_player_mode",Me="set_game_mode",Re="reverse_state",Le="reset_state",Ae={screen:{DEFAULT:"start",PLAY:"play"},players:{SINGLE_PLAYER:"Single Player",MULTIPLAYER:"Multi Player",DEFAULT:null},mode:(s={},Object(T.a)(s,"Single Player",{PRACTICE:"Practice",SURVIVAL:"Survival",TIME_ATTACK:"Time Attack"}),Object(T.a)(s,"Multi Player",{LOCAL:"Multiplayer",REMOTE:"Remote Multiplayer"}),Object(T.a)(s,"DEFAULT",null),s)},Pe=[Ae.mode["Multi Player"].REMOTE].reduce((function(e,t){return Object(M.a)(Object(M.a)({},e),{},Object(T.a)({},t,!0))}),{}),De=Object.entries(Ae).reduce((function(e,t){var n=Object(p.a)(t,2),a=n[0],r=n[1];return Object(M.a)(Object(M.a)({},e),{},Object(T.a)({},a,"mode"!==a?Object.values(r).filter((function(e){return e})):Object.entries(r).reduce((function(e,t){var n=Object(p.a)(t,2),a=n[0],r=n[1];return Object(M.a)(Object(M.a)({},e),{},Object(T.a)({},a,null===r?null:Object.values(r)))}),{})))}),{}),Ne={screen:Ae.screen.DEFAULT,mode:Ae.mode.DEFAULT,players:Ae.players.DEFAULT},Fe=(d={},Object(T.a)(d,Ae.screen.DEFAULT,Object(T.a)({},Ae.players.DEFAULT,null)),Object(T.a)(d,Ae.screen.PLAY,(u={},Object(T.a)(u,Ae.players.SINGLE_PLAYER,null),Object(T.a)(u,Ae.players.MULTIPLAYER,null),u)),d),Ue=function(e){var t,n=e.screenState,a=n.screen,c=n.players,o=(null===(t=Fe[a])||void 0===t?void 0:t[c])||Se;return r.a.createElement("header",null,r.a.createElement(o,null))},Be=function(){return null},_e=n(616),ze=n(285),Ye=n.n(ze),Ge=function(e){var t=(e-25)/63;return Math.max(1,Math.min(10,Math.round(10*t)))},Ve=function(e,t){var n,a;e<50?(n=255,a=Math.round(5.1*e)):(a=255,n=Math.round(510-5.1*e));var r="#"+("000000"+(65536*n+256*a+0).toString(16)).slice(-6);if(t)try{var c=Ye()(r),o=c.red,i=c.green,l=c.blue;return"rgba(".concat(o,", ").concat(i,", ").concat(l,", ").concat(t,")")}catch(s){return console.error(s,{score:e,alpha:t,hex:r}),"rgba(255, 255, 255, 0)"}return r},We=function(e,t){return Ve(function(e){return(e=Math.min(Math.max(e,0),10))/10*100}(e),t)},qe=Object(_e.a)((function(e){return{masks:{padding:e.spacing(2),background:"rgba(255,255,255,0.5)"},masksHeader:{display:"flex",alignItems:"center",justifyContent:"space-between"},masksList:{display:"flex",flexFlow:"row wrap",justifyContent:"space-around"},maskContainer:{marginTop:e.spacing(2)},imgContainer:{width:200,position:"relative",border:"1px solid grey",padding:e.spacing(.5),borderRadius:e.spacing(1),"&:hover":{"& > div":{background:"rgba(255,0,0,0.65)"}}},img:{width:"100%",background:"rgba(0,0,0,0)"},removeMask:{top:0,left:0,bottom:0,width:"100%",display:"flex",alignItems:"center",position:"absolute",transition:"all 100ms",justifyContent:"center","&:hover":{"& > button":{display:"inherit"}}},iconBtn:{display:"none",color:"black",backgroundColor:"rgba(255,255,255,0.5)","&:hover":{backgroundColor:"rgba(255,255,255,0.75)"},"&:active, &:focused":{backgroundColor:"rgba(255,255,255,0.9)"}},actions:{"& > button":{marginRight:e.spacing(1),"& :last-of-type":{marginRight:0}}}}})),Xe=function(e){var t=qe(),n=e.masks,a=e.onClose,c=e.title,o=e.actions,i=e.actionButtons,l=e.getDataUri,s=e.getImageChild,u=e.getPaperProps,d=e.PaperProps,p=void 0===d?{}:d;return!!(null===n||void 0===n?void 0:n.length)&&r.a.createElement(R.a,{className:t.masks,elevation:4},r.a.createElement("div",{className:t.masksHeader},"string"===typeof c?r.a.createElement(g.a,{variant:"h6",component:"h3"},c):c||null,o||i?r.a.createElement("div",{className:t.actions},i.map((function(e){var t=e.Icon,n=e.onClick,a=e.key;return r.a.createElement(K.a,{key:a,size:"small",onClick:n},r.a.createElement(t,null))}))):a&&r.a.createElement("div",{className:t.actions},r.a.createElement(K.a,{size:"small",onClick:a},r.a.createElement(ye.a,null)))),r.a.createElement("ul",{className:t.masksList},n.map((function(e,a){var c=l?l(e):e,o=u?u(e,a,n):{};return r.a.createElement("li",{key:c,className:t.maskContainer},r.a.createElement(R.a,Object.assign({elevation:4,className:t.imgContainer},p,o),s&&s(e,a),r.a.createElement("img",{src:c,className:t.img,alt:"mask #".concat(a)})))}))))},He=Object(_e.a)((function(e){return{score:{textAlign:"right",paddingRight:e.spacing(1)}}})),Ke=function(e){var t=e.results,n=e.handleClose,c=e.label,o=Object(I.a)(e,["results","handleClose","label"]),i=He(),l=Object(a.useMemo)((function(){var e=(t.reduce((function(e,t){return e+t.score}),0)/t.length).toFixed(1);return r.a.createElement(g.a,{variant:"h6",component:"h3"},c||r.a.createElement(r.a.Fragment,null,"Round Score: ",e))}),[t,c]),s=Object(a.useCallback)((function(e){return e.dataUri}),[]),u=Object(a.useCallback)((function(e){var t=e.score;return{style:{background:We(t,.4)}}}),[]),d=Object(a.useCallback)((function(e){var t=e.score;return r.a.createElement(g.a,{className:i.score},t)}),[i.score]);return r.a.createElement(Xe,Object.assign({title:l,masks:t,onClose:n,getDataUri:s,getPaperProps:u,getImageChild:d},o))},$e=n(128),Ze=n.n($e),Je=n(286),Qe=n.n(Je),et=n(287),tt=n.n(et),nt=Object(_e.a)((function(e){return{removeMask:{top:0,left:0,bottom:0,width:"100%",display:"flex",alignItems:"center",position:"absolute",transition:"all 100ms",justifyContent:"center","&:hover":{"& > button":{display:"inherit"}}},iconBtn:{display:"none",color:"black",backgroundColor:"rgba(255,255,255,0.5)","&:hover":{backgroundColor:"rgba(255,255,255,0.75)"},"&:active, &:focused":{backgroundColor:"rgba(255,255,255,0.9)"}}}})),at=function(e){var t=nt(),n=e.captureMasks,c=e.handlePlay,o=Object(a.useMemo)((function(){return[{key:"play",Icon:Ze.a,onClick:c},{key:"download",Icon:Qe.a,onClick:n.downloadMasks},{key:"clear",Icon:ye.a,onClick:n.removeAllMasks}]}),[n.downloadMasks,n.removeAllMasks,c]),i=Object(a.useCallback)((function(e){return e.binary}),[]),l=Object(a.useCallback)((function(e,a){return r.a.createElement("div",{className:t.removeMask},r.a.createElement(K.a,{name:a,className:t.iconBtn,onClick:n.removeMask},r.a.createElement(tt.a,{fontSize:"large"})))}),[n.removeMask,t.removeMask,t.iconBtn]);return r.a.createElement(Xe,{title:"Candidate Masks",getDataUri:i,masks:n.masks,actionButtons:o,getImageChild:l})},rt=Object(_e.a)((function(e){return{score:{textAlign:"right",paddingRight:e.spacing(1)}}})),ct=function(e){var t=sa(),n=rt(),c=Object(a.useMemo)((function(){var e;return"time attack"===(null===t||void 0===t||null===(e=t.mode)||void 0===e?void 0:e.name)?{getPaperProps:function(e){var t=e.score;return{style:{background:We(Math.max(10.5-t,0),.4)}}},getImageChild:function(e){var t=e.score;return r.a.createElement(g.a,{className:n.score},t,"s")}}:{}}),[t,n.score]);if(!t.mode)return null;var o=t.mode,i=o.simpleGame,l=o.captureMasks,s=o.handlePlayCapturedMasks,u=o.resultsText,d="time attack"!==o.name||!t.loop.looping;return r.a.createElement(r.a.Fragment,null,d&&r.a.createElement(Ke,Object.assign({label:u,results:i.scores,handleClose:e.hideClose?null:i.clearScores},c)),l&&r.a.createElement(at,{captureMasks:l,handlePlay:s}))},ot=Object(j.a)((function(e){return{root:function(e){var t=e.flip,n=e.height,a=void 0===n?10:n,r=e.background;return{height:a,background:void 0===r?"rgba(255,255,255,0)":r,width:"100%",borderRadius:50,transform:"scaleX(".concat(t?-1:1,")"),pWebkitTransform:"scaleX(".concat(t?-1:1,")")}},filler:function(e){var t=e.completed;return{height:"100%",textAlign:"left",background:e.color,width:"".concat(t,"%"),borderRadius:"inherit"}}}})),it=function(e){var t=ot(e);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.filler}))},lt=n(33),st=n(105),ut=n.n(st),dt=n(288),pt=n.n(dt),mt=(n(289),function(e){var t=cv.matFromImageData(e),n=t.rows,a=t.cols,r=20*(Math.random()-.5),c=new cv.Mat,o=new cv.Point(a/2,n/2),i=cv.getRotationMatrix2D(o,r,1);cv.warpAffine(t,c,i,t.size(),cv.INTER_NEAREST,cv.BORDER_CONSTANT,new cv.Scalar(0,0,0,0));var l=new cv.MatVector;cv.split(c,l);var s=-1,u=-1,d=-1,p=-1,m=new cv.Mat,f=new cv.Mat;cv.reduce(l.get(2),m,0,cv.REDUCE_MAX);for(var b=0;b<a;++b)if(-1===s&&m.data[b]>0){s=b;break}for(var v=a-1;v>=0;v--)if(-1===d&&m.data[v]>0){d=v;break}cv.reduce(l.get(2),m,1,cv.REDUCE_MAX);for(var g=0;g<n;++g)if(-1===u&&m.data[g]>0){u=g;break}for(var h=n-1;h>=0;h--)if(-1===p&&m.data[h]>0){p=h;break}var O=d-s+1,j=p-u+1,y=new cv.Rect(s,u,O,j),k=a/(m=c.roi(y)).cols,E=n/m.rows,C=Math.min(k,E),w=Math.min(.9+Math.random()*(1.1-.9),C),x=new cv.Size(m.cols*w,m.rows*w);cv.resize(m,f,x,0,0,cv.INTER_NEAREST);var S=f.cols,I=f.rows,T=(a-S)/2,M=T+(Math.random()-.5)*(2*Math.min(300,T)),R=new cv.Rect(M,n-I,S,I),L=new cv.Mat.zeros(n,a,c.type());f.copyTo(L.roi(R));var A=new ImageData(new Uint8ClampedArray(L.data),L.cols,L.rows);return c.delete(),t.delete(),m.delete(),f.delete(),L.delete(),A}),ft=function(e,t){for(var n=e.data,a=e.width,r=e.height,c=new Uint8ClampedArray(4*e.data.length),o=0;o<r*a;++o){var i=o%a,l=parseInt(o/a),s=n[o],u=t?a-i+a*l:o;c[4*u]=s?255:0,c[4*u+1]=s?255:0,c[4*u+2]=s?255:0,c[4*u+3]=s?255:0}var d=new ImageData(c,a,r),p=cv.matFromImageData(d),m=new cv.MatVector;cv.split(p,m);var f=new cv.Mat;cv.threshold(m.get(0),f,128,1,cv.THRESH_BINARY);var b=new cv.MatVector,v=new cv.Mat;cv.findContours(f,b,v,cv.RETR_CCOMP,cv.CHAIN_APPROX_SIMPLE);for(var g=cv.Mat.zeros(f.rows,f.cols,cv.CV_8UC1),h=0;h<b.size();++h)cv.contourArea(b.get(h))>1e4&&cv.drawContours(g,b,h,[1,1,1,1],-1,cv.LINE_8,v,100);return p.delete(),m.delete(),g},bt=function(e,t){var n=ft(e,t),a=new cv.MatVector,r=cv.Mat.zeros(n.rows,n.cols,cv.CV_8UC4);cv.split(r,a),a.get(2).setTo([255,0,0,0],n),a.get(3).setTo([128,0,0,0],n);var c=new cv.Mat,o=cv.Mat.ones(10,10,cv.CV_8U),i=new cv.Point(-1,-1);cv.dilate(n,c,o,i,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),cv.subtract(c,n,c),a.get(2).setTo([255,0,0,0],c),a.get(1).setTo([255,0,0,0],c),a.get(3).setTo([255,0,0,0],c),cv.merge(a,r);var l=new ImageData(new Uint8ClampedArray(r.data),r.cols,r.rows);return a.delete(),n.delete(),r.delete(),o.delete(),c.delete(),{overlayImageData:l,binaryImageData:l}},vt=function(e,t,n){for(var a=t.data,r=t.width,c=t.height,o=0,i=0,l=0;l<c*r;++l){var s=l%r,u=parseInt(l/r),d=n?r-s+r*u:l,p=a[l],m=!!e.data[4*d+2],f=p?1.3:1;m&&p&&(i+=f),(p||m)&&(o+=f)}return Math.round(i/(o+1e-7)*100)},gt=function(e,t,n){var a=ft(t,n),r=new cv.MatVector,c=cv.Mat.zeros(a.rows,a.cols,cv.CV_8UC4);cv.split(c,r),r.get(1).setTo([255,0,0,0],a),r.get(3).setTo([128,0,0,0],a);var o=new cv.Mat,i=cv.Mat.ones(10,10,cv.CV_8U),l=new cv.Point(-1,-1);cv.dilate(a,o,i,l,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),cv.subtract(o,a,o),r.get(1).setTo([255,0,0,0],o),r.get(3).setTo([255,0,0,0],o),cv.merge(r,c);var s=new ImageData(new Uint8ClampedArray(c.data),c.cols,c.rows),u=cv.matFromImageData(e),d=new cv.MatVector;cv.split(u,d);var p=new cv.Mat;cv.addWeighted(c,.5,u,.5,0,p);var m=new ImageData(new Uint8ClampedArray(p.data),p.cols,p.rows),f=vt(e,t,n);return r.delete(),a.delete(),c.delete(),i.delete(),o.delete(),p.delete(),{score:f,targetOverlay:m,segOverlay:s}},ht=function(e,t){if("undefined"!==typeof navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,t);if("undefined"!==typeof navigator.msSaveBlob)return navigator.msSaveBlob(e,t);var n=window.document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t,n.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(n),"function"===typeof n.click?n.click():(n.target="_blank",n.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),URL.revokeObjectURL(n.href)},Ot=function(e){return"set".concat(e,".zip")},jt=function(e){var t=w(),n=Object(a.useState)(!1),r=Object(p.a)(n,2),c=r[0],o=r[1],i=Object(a.useCallback)(function(){var n=Object(E.a)(k.a.mark((function n(a){var r,c,i;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ut.a.loadAsync(a);case 2:return r=n.sent,n.next=5,Promise.all(r.filter((function(e){return e.endsWith(".png")})).map((function(e){var t=e.name;return r.file(t).async("base64")})));case 5:return c=n.sent,n.prev=6,n.next=9,Promise.all(c.map((function(e){return t.dataUriToImageData("data:image/png;base64,".concat(e))})));case 9:i=n.sent,e(i),n.next=15;break;case 13:n.prev=13,n.t0=n.catch(6);case 15:o(!1);case 16:case"end":return n.stop()}}),n,null,[[6,13]])})));return function(e){return n.apply(this,arguments)}}(),[e,t]),l=Object(a.useCallback)(function(){var e=Object(E.a)(k.a.mark((function e(t){var n,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(p.a)(t,1),"application/zip"===(a=n[0]).type){e.next=4;break}return console.error("Expected a zip file but got",a.type),e.abrupt("return");case 4:return o(!0),e.next=7,i(a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i]),s=Object(a.useCallback)(function(){var e=Object(E.a)(k.a.mark((function e(t){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return o(!0),e.next=5,new ut.a.external.Promise((function(e,n){pt.a.getBinaryContent(""+"/masks/".concat(t),(function(t,a){t?n(t):e(a)}))}));case 5:return n=e.sent,e.next=8,i(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i]),u=Object(a.useCallback)(Object(E.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Math.floor(3*Math.random()),e.abrupt("return",s(Ot(t+1)));case 2:case"end":return e.stop()}}),e)}))),[s]);return Object(a.useMemo)((function(){return{loading:c,handleZipInputChange:l,handleLoadRandomMaskSet:u,handleLoadPreparedMasks:s}}),[c,l,s,u])};var yt,kt,Et,Ct,wt,xt=function(e){if(!e)throw new Error("audioRef is required when calling useSfx");var t=Object(a.useCallback)((function(t){if(e.current)return function(e){window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;var t=new AudioContext,n=t.createBufferSource(),a=new Request(e);return fetch(a).then((function(e){return e.arrayBuffer()})).then((function(e){return t.decodeAudioData(e,(function(e){n.buffer=e,n.connect(t.destination)})),n.start(0)}))}(t)}),[e]);return{playSuccessSound:Object(a.useCallback)((function(){return t("/sounds/metallic_clank.ogg")}),[t]),playFailureSound:Object(a.useCallback)((function(){return t("/sounds/glass_shatter.ogg")}),[t]),playCameraSound:Object(a.useCallback)((function(){return t("/sounds/camera.ogg")}),[t])}},St=window.speechSynthesis,It=function(){var e=Object(a.useRef)(!0),t=Object(a.useState)(!0),n=Object(p.a)(t,2),r=n[0],c=n[1],o=function(e){if(!e)throw new Error("audioRef is required when calling useSpeech");var t=Object(a.useState)(null),n=Object(p.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(null),i=Object(p.a)(o,2),l=i[0],s=i[1];Object(a.useEffect)((function(){if(!r){var e=St.getVoices();c(e),s(e[0])}}),[r]);var u=Object(a.useCallback)((function(t){if(e.current){var n=new SpeechSynthesisUtterance(t);n.voice=l,St.speak(n)}}),[l,e]),d=Object(a.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.onEnd,a=t.onEach;n&&setTimeout(n,1e3*e),Array.from({length:e}).forEach((function(t,n){var r=e-n;setTimeout((function(){u(r),a&&a(r)}),1e3*n)}))}),[u]);return{say:u,countdown:d}}(e),i=xt(e);Object(a.useEffect)((function(){localStorage.getItem("__audio_muted__")&&c(!1)}),[]),Object(a.useEffect)((function(){r&&!e.current?(e.current=!0,localStorage.removeItem("__audio_muted__")):!r&&e.current&&(e.current=!1,localStorage.setItem("__audio_muted__","true"))}),[r]);var l=Object(a.useCallback)((function(){c((function(e){return!e}))}),[]);return Object(a.useMemo)((function(){return{state:r,stateRef:e,handlers:{toggle:l,speech:o,sfx:i}}}),[r,l,o,i])},Tt=Object(a.createContext)(),Mt=function(){var e=Object(a.useContext)(Tt);if(void 0===e)throw new Error("useAudio must be used within a AudioProvider");return e},Rt=function(e){var t=e.children,n=It();return r.a.createElement(Tt.Provider,{value:n},t)},Lt=function(){var e=Object(a.useRef)([]),t=Object(a.useRef)(null),n=Object(a.useRef)(0),r=Object(a.useState)([]),c=Object(p.a)(r,2),o=c[0],i=c[1],l=Object(a.useCallback)((function(t){i(t),e.current="function"===typeof t?t(e.current):t}),[]),s=Object(a.useCallback)((function(){n.current=0,t.current=null}),[]),u=Object(a.useCallback)((function(){for(var t,n,a=o.slice(),r=a.length;0!==r;)n=Math.floor(Math.random()*r),t=a[r-=1],a[r]=a[n],a[n]=t;l(a),e.current=a}),[o,l]),d=Object(a.useCallback)((function(){n.current=0,t.current=null,u()}),[u]),m=Object(a.useCallback)((function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=e.current[n.current];if(!r)return t.current=null,n.current=0,null;if(a){var c=mt(r);return t.current=c,n.current++,c}return t.current=r,n.current++,r}),[]),f=Object(a.useCallback)((function(){return e.current.length}),[]),b=Object(a.useCallback)((function(){var e=o[Math.floor(Math.random()*o.length)],n=mt(e);return t.current=n,n}),[o]);return Object(a.useMemo)((function(){return{next:m,reset:s,random:b,maskRef:t,setMasks:l,maskIdxRef:n,getNumMasks:f,resetAndShuffle:d,hasMasks:!!o.length}}),[m,o,b,s,l,d,f])},At=Object(a.createContext)(),Pt=function(){var e=Object(a.useContext)(At);if(void 0===e)throw new Error("useCarbon must be used within a CarbonProvider");return e},Dt=function(e){var t=e.children,n=function(){var e=Mt().handlers.speech.say,t=Object(a.useRef)(),n=Object(a.useState)(!1),r=Object(p.a)(n,2),c=r[0],o=r[1];Object(a.useEffect)((function(){c&&!t.current?t.current=!0:!c&&t.current&&(t.current=!1)}),[c]);var i=Object(a.useCallback)((function(){o((function(t){return t||e("Carbon Activated!"),!t}))}),[e]);return window.__carbonate__=i,{carbonState:c,carbonRef:t}}();return r.a.createElement(At.Provider,{value:n},t)},Nt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.setLapTimeInfo,n=Object(a.useRef)(),r=w(),c=Pt(),o=c.carbonRef,i=Object(a.useRef)(0),l=Lt(),s=Object(a.useRef)(0),u=Object(a.useState)([]),d=Object(p.a)(u,2),m=d[0],f=d[1],b=Object(a.useState)([[],[]]),v=Object(p.a)(b,2),g=v[0],h=v[1],O=jt(l.setMasks),j=Mt(),y=j.handlers,C=y.sfx,x=C.playSuccessSound,S=C.playFailureSound,I=y.speech.say,T=Object(a.useCallback)((function(){f([]),h([[],[]])}),[]),M=Object(a.useCallback)((function(e){return function(){var a=Object(E.a)(k.a.mark((function a(c){return k.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return c.time.first&&(l.next(),e||T(),c.useTimer({maxLaps:l.getNumMasks(),setLapTimeInfo:t,announceSeconds:!0,onLap:function(t){var a=t.predict,c=(t.time,t.stop),o=l.maskRef.current;if(!o)return c();n.current=a(r.videoRef.current).then(function(){var t=Object(E.a)(k.a.mark((function t(n){var a,c,i,s;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=gt(o,n,r.flipX),c=a.score,i=a.targetOverlay,s=r.imageDataToDataUri(i),void 0!==e?h((function(t){var n=Object(lt.a)(t);return n[e]=[].concat(Object(lt.a)(n[e]),[{score:Ge(c),dataUri:s}]),n})):f((function(e){return[].concat(Object(lt.a)(e),[{score:Ge(c),dataUri:s}])})),r.clearCanvas(),l.next();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}})),l.maskRef.current&&r.ctx.putImageData(l.maskRef.current,0,0),a.abrupt("return",(function(){n.current?n.current.then(c.webcam.clearCanvas):c.webcam.clearCanvas()}));case 3:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}),[r,l,t,T]),R=Object(a.useCallback)((function(){return M()}),[M]),L=Object(a.useCallback)((function(e){return M(e)}),[M]),A=Object(a.useCallback)(function(){var e=Object(E.a)(k.a.mark((function e(a){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.time.first&&(l.random(),T(),a.useTimer({maxLaps:9999999,lapDuration:1e4,setLapTimeInfo:t,announceSeconds:!0,onLap:function(e){var t=e.predict,c=(e.time,e.stop),i=l.maskRef.current;if(!i)return c();n.current=t(r.videoRef.current).then(function(){var e=Object(E.a)(k.a.mark((function e(t){var n,s,u,d,p,m;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=gt(i,t,r.flipX),s=n.score,u=n.targetOverlay,4,(d=Ge(s))<4?o.current?I("Missed it!"):S():o.current?I("Got it!"):x(),p=r.imageDataToDataUri(u),f((function(e){return[].concat(Object(lt.a)(e),[{score:Ge(s),dataUri:p}])})),r.clearCanvas(),!(d<4)){e.next=12;break}return l.reset(),e.abrupt("return",c());case 12:m=a.timerRef.current.lapDuration/1e3,a.timerRef.current.lapDuration=1e3*(m-Math.log(m)/Math.log(50))-100,l.random();case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}})),l.maskRef.current&&r.ctx.putImageData(l.maskRef.current,0,0),e.abrupt("return",(function(){n.current?n.current.then(a.webcam.clearCanvas):a.webcam.clearCanvas()}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[r,l,t,T,o,S,x,I]),P=Object(a.useCallback)(function(){var e=Object(E.a)(k.a.mark((function e(a){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.time.first&&(10,l.resetAndShuffle(),l.next(!0),T(),i.current=0,s.current=0,a.useTimer({setLapTimeInfo:t,announceSeconds:!1,lapDuration:250,postLapDelay:0,onLap:function(e){var t=e.predict,a=e.time,c=e.stop,u=l.maskIdxRef.current,d=l.maskRef.current;if(!d||i.current>=10)return c();if(!(i.current>=u||i.current>=10)){var p=a.elapsed-s.current;if(p/1e3>=10){s.current=a.elapsed,o.current?I("Missed it!"):S();var m=r.imageDataToDataUri(d);f((function(e){return[].concat(Object(lt.a)(e),[{score:10,dataUri:m}])})),r.clearCanvas(),i.current++,i.current<10&&l.next(!0)}n.current=t(r.videoRef.current).then(function(){var e=Object(E.a)(k.a.mark((function e(t){var n,c,m,b,v,g;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=vt(d,t,r.flipX),!(Ge(n)>5)){e.next=15;break}if(!(i.current>=u||i.current>=10)){e.next=5;break}return e.abrupt("return");case 5:o.current?I("Got it!"):x(),c=p/1e3,s.current=a.elapsed,m=Number(c.toFixed(1)),b=gt(d,t,r.flipX),v=b.targetOverlay,g=r.imageDataToDataUri(v),f((function(e){return[].concat(Object(lt.a)(e),[{score:m,dataUri:g}])})),r.clearCanvas(),i.current++,i.current<10&&l.next(!0);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(console.error)}}})),l.maskRef.current&&r.ctx.putImageData(l.maskRef.current,0,0),e.abrupt("return",(function(){n.current?n.current.then(a.webcam.clearCanvas):a.webcam.clearCanvas()}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[r,l,T,t,S,x,o,I]);return Object(a.useMemo)((function(){return{zip:O,scores:m,multiplayerScores:g,handleLoop:R,handleMultiplayerLoop:L,handleSurvivalLoop:A,handleTimeAttackLoop:P,clearScores:T,reset:l.reset,ready:l.hasMasks,setMasks:l.setMasks}}),[O,m,g,R,L,A,P,T,l.hasMasks,l.reset,l.setMasks])},Ft=n(290),Ut=n.n(Ft),Bt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.maxMasks,n=void 0===t?0:t,r=e.setLapTimeInfo,c=Object(a.useRef)(),o=Object(a.useRef)([]),i=Object(a.useRef)(),l=Object(a.useState)([]),s=Object(p.a)(l,2),u=s[0],d=s[1],m=Pt(),f=m.carbonRef,b=Mt(),v=b.handlers,g=v.sfx.playCameraSound,h=v.speech.say,O=Object(a.useCallback)((function(e){"function"===typeof e?d((function(t){var n=e(t);return n!==t&&(o.current=n),n})):(o.current=e,d(e))}),[]),j=Object(a.useCallback)((function(){return o.current}),[]),y=Object(a.useCallback)((function(e){var t=e.currentTarget.name;O((function(e){return e.filter((function(e,n){return n!==+t}))}))}),[O]),C=Object(a.useCallback)((function(){O([])}),[O]),w=Object(a.useCallback)((function(){var e=new ut.a,t=e.folder("masks");u.forEach((function(e,n){var a=e.overlay;t.file("mask-".concat(n,".png"),Ut.a.decode(a).dataBase64,{base64:!0})})),e.generateAsync({type:"blob"}).then((function(e){return ht(e,"masks.zip")}))}),[u]),x=Object(a.useCallback)((function(e){return function(){var t=Object(E.a)(k.a.mark((function t(a){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.time.first&&(i.current=u.length,a.useTimer({announceSeconds:!0,lapDuration:3e3,postLapDelay:2500,maxLaps:n,setLapTimeInfo:r,onBeforeStartLap:function(){var e=Object(E.a)(k.a.mark((function e(t){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.predict,t.webcam,t.time,t.stop,e.abrupt("return",n());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onLap:function(e){var t=e.predict,a=e.webcam,r=(e.time,e.stop);c.current=t(a.videoRef.current).then(function(){var e=Object(E.a)(k.a.mark((function e(t){var c,o,l,s,u;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=bt(t,a.flipX),o=c.overlayImageData,l=c.binaryImageData,f.current?h("Gotcha!"):g(),s=a.imageDataToDataUri(o),u=a.imageDataToDataUri(l),a.clearCanvas(),a.ctx.putImageData(o,0,0),O((function(e){return[].concat(Object(lt.a)(e),[{overlay:s,binary:u}])})),e.next=9,new Promise((function(e){return setTimeout(e,1500)}));case 9:if(a.clearCanvas(),!(n&&++i.current>n)){e.next=12;break}return e.abrupt("return",r());case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},onEnd:function(){var e=Object(E.a)(k.a.mark((function e(t){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.time,n=t.webcam,t.predict,t.stop,e.next=3,new Promise((function(e){return setTimeout(e,2e3)}));case 3:n.clearCanvas();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})),t.abrupt("return",(function(){c.current?c.current.then(a.webcam.clearCanvas).then((function(){e&&e()})):(a.webcam.clearCanvas(),e&&e())}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),[u.length,n,r,O,g,h,f]);return Object(a.useMemo)((function(){return{masks:u,getMasks:j,handleLoop:x,removeMask:y,downloadMasks:w,removeAllMasks:C}}),[u,j,x,y,w,C])},_t={percent:0,percentRemaining:100,color:Ve(100),secondsRemaining:0},zt=function(e){var t=Object(a.useState)(_t),n=Object(p.a)(t,2),r=n[0],c=n[1],o=Nt({setLapTimeInfo:c}),i=Bt({setLapTimeInfo:c}),l=Object(a.useMemo)((function(){var e,t;return"You survived ".concat((null===o||void 0===o||null===(e=o.scores)||void 0===e?void 0:e.length)-1," round").concat(2!==(null===o||void 0===o||null===(t=o.scores)||void 0===t?void 0:t.length)?"s":"",".")}),[o.scores]),s=Object(a.useRef)(!1);Object(a.useEffect)((function(){s.current||(s.current=!0,o.zip.handleLoadPreparedMasks("custom_mask.zip"))}),[o]);var u=Object(a.useCallback)(Object(E.a)(k.a.mark((function t(){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.looping?e.stop():e.start(o.handleSurvivalLoop);case 1:case"end":return t.stop()}}),t)}))),[e,o]),d=Object(a.useCallback)((function(){e.looping?e.stop():e.start(i.handleLoop())}),[e,i]);return Object(a.useMemo)((function(){return{name:"survival",loop:e,simpleGame:o,lapTimeInfo:r,resultsText:l,captureMasks:i,handleClickGame:u,handleClickCaptureMasks:d}}),[e,o,r,l,i,u,d])},Yt=n(617),Gt=n(292),Vt=n.n(Gt),Wt=n(291),qt=n.n(Wt),Xt=Object(_e.a)((function(e){return{paper:{position:"relative",padding:e.spacing(1),paddingRight:e.spacing(5),paddingLeft:e.spacing(5),background:"rgba(255,255,255,0.95)",marginTop:e.spacing(2),textAlign:"center","& h2":{marginBottom:e.spacing(4)},"& h3":{marginBottom:e.spacing(1)}},help:{maxHeight:200,marginTop:e.spacing(2),"& > div > p":{marginBottom:e.spacing(1)}},helpBtn:{position:"absolute",bottom:e.spacing(1),right:e.spacing(1),color:e.palette.secondary.main,background:e.palette.primary.main,transition:"300ms all","&:hover":{color:e.palette.primary.main,background:e.palette.secondary.main}},icon:{fontSize:50},marginTop:{marginTop:e.spacing(2)},helpContent:{fontWeight:600,fontFamily:ba("Rajdhani"),fontSize:18}}})),Ht=function(e){var t=e.headerContent,n=e.middleContent,c=e.footerContent,o=e.primaryText,i=e.secondaryText,l=e.helpContent,s=e.iconProps,u=(s=void 0===s?{}:s).loading,d=Object(I.a)(s,["loading"]),m=e.Icon,f=Object(a.useState)(!1),b=Object(p.a)(f,2),v=b[0],h=b[1],O=Object(a.useCallback)((function(){h((function(e){return!e}))}),[]),j=Xt(),y=Object(a.useMemo)((function(){return u?Yt.a:{play:Ze.a,replay:qt.a}[m]||m}),[m,u]);return r.a.createElement(R.a,{className:j.paper},t,o&&r.a.createElement(g.a,{component:"h3",variant:"h5"},o),n,i&&r.a.createElement(g.a,{component:"h4",variant:"h6",className:H()(j.subtext,Object(T.a)({},j.marginTop,n))},i),y&&r.a.createElement(K.a,Object.assign({size:"medium",disabled:u},d),r.a.createElement(y,{className:j.icon,color:d.color||"secondary"})),c,l&&r.a.createElement("div",{className:j.help},v&&r.a.createElement("div",{className:j.helpContent},Array.isArray(l)?r.a.createElement(r.a.Fragment,null,l.map((function(e){return r.a.createElement("p",{key:e},e)}))):l),r.a.createElement(K.a,{size:"small",className:j.helpBtn,onClick:O},r.a.createElement(Vt.a,null))))},Kt=Object(_e.a)((function(e){return{root:{padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overlay:{background:"rgba(255,255,255,0.5)"},options:{display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"space-between",marginBottom:e.spacing(1),"& > *":{marginTop:e.spacing(2)}},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},progress:{position:"absolute",top:e.spacing(1),left:e.spacing(8),right:e.spacing(8)}}})),$t=function(e,t,n){return t===n.length-1?{style:{background:"rgba(255, 0, 0, 0.4)"}}:{}},Zt=function(e){var t=Kt(),n=ua(zt),a=w(),c=n.loop,o=n.lapTimeInfo,i=n.handleClickGame;return r.a.createElement("div",{className:H()(t.root,Object(T.a)({},t.overlay,!c.looping))},r.a.createElement("div",{className:H()(t.options,Object(T.a)({},t.optionsTop,!!c.looping))},c.looping?r.a.createElement("div",{className:t.progress},r.a.createElement(it,{color:o.color,completed:o.percentRemaining})):r.a.createElement(Ht,{primaryText:"Survival",secondaryText:"Match the poses and survive as long as you can.",middleContent:a.isFullScreen&&r.a.createElement(Jt,null),Icon:"play",iconProps:{onClick:i,loading:!c.ready,color:"secondary"},helpContent:["You will have a limited number of time to match each pose.","Successfully match a pose by being within its lines when the timer runs out.","If your score is high enough, you will move on to the next round.","You will have less time each round.","How long can you survive?"]})))},Jt=function(e){var t=sa();if(!t.mode)return null;var n=t.mode,a=n.simpleGame,c=n.resultsText;return!t.loop.looping&&r.a.createElement(Ke,{label:c,getImageChild:null,results:a.scores,handleClose:a.clearScores,getPaperProps:$t})},Qt=Object(_e.a)((function(e){return{root:function(t){return{minWidth:t.isFullScreen?"50%":"auto","& > div:first-of-type":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}}}}})),en=function(e){var t=sa(),n=Qt(e);if(!t.mode)return null;var a=t.mode,c=a.simpleGame,o=a.multiplayerResultsText;return!t.loop.looping&&r.a.createElement("div",{className:n.root},r.a.createElement(Ke,{label:o[0],results:c.multiplayerScores[0]}),r.a.createElement(Ke,{label:o[1],results:c.multiplayerScores[1]}))},tn=Object(j.a)((function(e){return{root:{maxWidth:1100,margin:"0 auto",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),"& > div":{marginTop:e.spacing(2)}}}})),nn=Object(T.a)({},Ae.screen.PLAY,(Et={},Object(T.a)(Et,Ae.players.SINGLE_PLAYER,(yt={},Object(T.a)(yt,Ae.mode[Ae.players.SINGLE_PLAYER].PRACTICE,ct),Object(T.a)(yt,Ae.mode[Ae.players.SINGLE_PLAYER].SURVIVAL,Jt),Object(T.a)(yt,Ae.mode[Ae.players.SINGLE_PLAYER].TIME_ATTACK,ct),yt)),Object(T.a)(Et,Ae.players.MULTIPLAYER,(kt={},Object(T.a)(kt,Ae.mode[Ae.players.MULTIPLAYER].LOCAL,en),Object(T.a)(kt,Ae.mode[Ae.players.MULTIPLAYER].REMOTE,(function(){return"REMOTE footer"})),kt)),Et)),an=function(e){var t,n,a=tn(),c=e.screen.state,o=c.screen,i=c.players,l=c.mode,s=(null===(t=nn[o])||void 0===t||null===(n=t[i])||void 0===n?void 0:n[l])||Be;return r.a.createElement("div",{className:a.root},r.a.createElement(s,null))},rn=n(294),cn=n.n(rn),on=n(293),ln=n.n(on),sn=n(618),un=Object(_e.a)((function(e){return{root:{display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"space-between",marginBottom:e.spacing(1),"& > div > *":{marginTop:e.spacing(2)}},buttons:{display:"flex"},h:{flexDirection:"row"},v:{flexDirection:"column"},minWidth:{minWidth:150},label:{color:e.palette.primary.main,fontWeight:"bold",background:e.palette.secondary.main,padding:e.spacing(1),borderRadius:e.spacing(1),border:"".concat(e.spacing(.4),"px solid ").concat(e.palette.primary.main)},icon:{fontSize:100,border:"".concat(e.spacing(.4),"px solid ").concat(e.palette.secondary.main),borderRadius:"50%",padding:e.spacing(1),background:e.palette.primary.main,color:"black",transition:"300ms all","&:hover":{border:"".concat(e.spacing(.4),"px solid ").concat(e.palette.primary.main),background:e.palette.secondary.main,color:e.palette.primary.main}}}})),dn=function(e){return{transform:"translate3d(0,0px,0)",from:{transform:"translate3d(0,-".concat(e,"px,0)")},config:L.b.wobbly}},pn=function(e){var t,n=un(),c=Object(L.d)(e.buttons.length,dn(e.offset||100)),o=Object(L.d)(1,dn((e.offset||100)+200)),i=Object(a.useState)(e.label),l=Object(p.a)(i,2),s=l[0],u=l[1];return r.a.createElement("div",{className:n.root},e.label&&o.map((function(e,t){return r.a.createElement(L.a.div,{style:e,key:t},r.a.createElement(g.a,{component:"h2",variant:"h5",className:n.label},s))})),r.a.createElement("div",{className:H()(n.buttons,(t={},Object(T.a)(t,n.h,"h"===e.layout),Object(T.a)(t,n.v,"h"!==e.layout),t))},c.map((function(t,a){var c=e.buttons[a],o=c.Component,i=c.visible,l=void 0===i||i,s=c.props,d=(s=void 0===s?{}:s).Icon,p=s.hover,m=Object(I.a)(s,["Icon","hover"]),f={};return p&&m.name&&e.label&&(f.onMouseEnter=function(){u(m.name)},f.onMouseLeave=function(){u(e.label)}),l?r.a.createElement(L.a.div,{key:m.key,style:t},o?r.a.createElement(o,m):d?r.a.createElement(K.a,Object.assign({size:"medium",variant:"contained",className:n.iconButton},f,m),r.a.createElement(d,{className:n.icon})):r.a.createElement(sn.a,Object.assign({color:"secondary",variant:"contained"},m,{className:n.minWidth}))):null}))))},mn=Object(j.a)((function(e){return{root:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column","& button":{marginTop:e.spacing(2)}},gameMode:{textAlign:"center"},header:{marginTop:e.spacing(4),marginBottom:e.spacing(2)}}})),fn=(Ct={},Object(T.a)(Ct,Ae.mode["Single Player"].SURVIVAL,ln.a),Object(T.a)(Ct,Ae.mode["Single Player"].TIME_ATTACK,cn.a),Ct),bn=function(e){var t=mn(),n=Pt().carbonState,c=Object(a.useCallback)((function(t){var n=t.currentTarget.name;e.screen.handlers.setGameMode(n)}),[e.screen.handlers]),o=Object(a.useMemo)((function(){var t;return null===(t=De.mode[e.screen.state.players])||void 0===t?void 0:t.map((function(e){return{props:{key:e,name:e,children:e,onClick:c,disabled:!!Pe[e],Icon:fn[e],hover:!0}}})).filter((function(e){return!!n||"Practice"!==e.props.name}))}),[e.screen.state.players,c,n]);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.gameMode},r.a.createElement(pn,{buttons:o,label:"Choose Mode",layout:"h"})))},vn=Object(j.a)((function(e){return{fileInput:{display:"none"}}})),gn=function(e){var t=e.onChange,n=e.multiple,c=e.children,o=e.filter,i=Object(I.a)(e,["onChange","multiple","children","filter"]),l=vn(),s=Object(a.useRef)(),u=Object(a.useCallback)((function(e){if(e){var a=!1===n,r=e.target?Array.from(e.target.files):e.files,c=o?r.filter(o):r;a&&c.length>1&&(c=c.slice(0,1)),t(c)}}),[t,n,o]),d=Object(a.useCallback)((function(){s.current.value=null}),[s]);return r.a.createElement(sn.a,Object.assign({component:"label"},i),c,r.a.createElement("input",{type:"file",ref:s,className:l.fileInput,onClick:d,onChange:u,multiple:!1!==n}))},hn=Object(_e.a)((function(e){return{item:function(t){return{minWidth:t-e.spacing(4),textAlign:"center"}}}})),On=function(e){var t=Object(a.useState)(0),n=Object(p.a)(t,2),c=n[0],o=n[1],i=hn(c),l=Object(a.useRef)();Object(a.useEffect)((function(){l.current&&o(l.current.clientWidth)}),[]);var s=r.a.useState(null),u=Object(p.a)(s,2),d=u[0],m=u[1],f=Object(a.useCallback)((function(e){m(e.currentTarget)}),[]),b=Object(a.useCallback)((function(){m(null)}),[]),v=Object(a.useCallback)((function(t){return function(){e.handleClick(t),b()}}),[e,b]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{ref:l},r.a.createElement(sn.a,{fullWidth:!0,variant:"contained","aria-haspopup":"true",onClick:f,"aria-controls":"mask-menu",disabled:e.disabled},"Select Masks")),r.a.createElement(_.a,{id:"mask-menu",keepMounted:!0,anchorEl:d,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},onClose:b,open:Boolean(d),container:e.containerRef.current||null},Array.from({length:3}).map((function(e,t){return r.a.createElement(Y.a,{key:t,button:!0,onClick:v("set".concat(t+1,".zip"))},r.a.createElement("span",{className:i.item},"Game ",t+1))}))))},jn=function(e){var t=w(),n=Object(a.useState)(_t),r=Object(p.a)(n,2),c=r[0],o=r[1],i=Nt({setLapTimeInfo:o}),l=Bt({setLapTimeInfo:o}),s=Object(a.useState)(null),u=Object(p.a)(s,2),d=u[0],m=u[1];Object(a.useEffect)((function(){!e.looping&&d&&m(null)}),[e.looping,d]);var f=Object(a.useCallback)(Object(E.a)(k.a.mark((function t(){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.looping?(e.stop(),i.reset()):(e.start(i.handleLoop),m("play"));case 1:case"end":return t.stop()}}),t)}))),[e,i]),b=Object(a.useCallback)(Object(E.a)(k.a.mark((function t(){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.looping){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,i.zip.handleLoadRandomMaskSet();case 4:f();case 5:case"end":return t.stop()}}),t)}))),[f,e.looping,i.zip]),v=Object(a.useCallback)((function(){e.looping?(e.stop(),i.reset()):(e.start(l.handleLoop()),m("capture"))}),[e,l,i]),g=Object(a.useCallback)(Object(E.a)(k.a.mark((function n(){var a;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.looping){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,Promise.all(l.masks.map((function(e){var n=e.overlay;return t.dataUriToImageData(n)})));case 4:a=n.sent,i.setMasks(a),f();case 7:case"end":return n.stop()}}),n)}))),[l.masks,i,t,f,e.looping]);return Object(a.useMemo)((function(){return{name:"practice",loopType:d,simpleGame:i,lapTimeInfo:c,captureMasks:l,handleClickGame:f,handleStartRandomGame:b,handlePlayCapturedMasks:g,handleClickCaptureMasks:v}}),[d,i,c,l,f,b,g,v])},yn=Object(_e.a)((function(e){return{root:{width:"100%",height:"100%",overflow:"hidden",position:"relative"},scrollContainer:{position:"absolute",top:0,left:0,bottom:0,right:-17,overflowY:"scroll",padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overlay:{background:"rgba(255,255,255,0.5)"},rootTop:{justifyContent:"flex-start"},rootApart:{justifyContent:"space-between"},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},captures:{width:"100%","& > div":{marginTop:e.spacing(1)}},progress:{position:"absolute",top:e.spacing(1),left:e.spacing(8),right:e.spacing(8)}}})),kn=function(e){var t,n,c,o=yn(),i=sa(),l=w(),s=Object(a.useRef)(),u=ua(jn),d=u.loopType,p=u.lapTimeInfo,m=u.simpleGame,f=u.captureMasks,b=u.handleClickGame,v=u.handleStartRandomGame,g=u.handleClickCaptureMasks,h=i.loop,O=p.color,j=Object(a.useMemo)((function(){return[{props:{key:"play/stop",onClick:b,disabled:!h.ready||!h.looping&&!m.ready,children:h.looping?"Stop":"Play"}},{props:{key:"playRandom",color:"secondary",onClick:v,disabled:!h.ready||h.looping,children:"Play Random"}},{props:{containerRef:s,key:"chooseMasks",disabled:!h.ready||h.looping,handleClick:m.zip.handleLoadPreparedMasks},Component:On,visible:!h.looping},{props:{key:"loadMasks",variant:"contained",onChange:m.zip.handleZipInputChange,disabled:!h.ready||h.looping||m.zip.loading,children:m.loading?"Loading...":"Load Masks"},Component:gn,visible:!h.looping},{props:{key:"captureMasks",onClick:g,disabled:!h.ready||h.looping,children:"Capture Masks",color:"default"},visible:!h.looping}]}),[h.ready,h.looping,b,m.ready,m.loading,v,m.zip.loading,g,m.zip.handleZipInputChange,m.zip.handleLoadPreparedMasks]);return r.a.createElement("div",{className:o.root},r.a.createElement("div",{className:H()(o.scrollContainer,(c={},Object(T.a)(c,o.overlay,!h.looping),Object(T.a)(c,o.rootTop,!!h.looping),Object(T.a)(c,o.rootApart,!(!(null===(t=m.scores)||void 0===t?void 0:t.length)&&!(null===(n=f.masks)||void 0===n?void 0:n.length))&&l.isFullScreen),c))},r.a.createElement("div",{className:H()(Object(T.a)({},o.optionsTop,!!h.looping)),ref:s},h.looping?r.a.createElement(pn,{offset:70,buttons:[{props:{key:"stop",onClick:b,children:"Stop"}}]}):r.a.createElement(pn,{buttons:j}),h.looping&&"play"===d&&r.a.createElement("div",{className:o.progress},r.a.createElement(it,{color:O,completed:p.percentRemaining}))),l.isFullScreen&&!h.looping&&r.a.createElement(ct,null)))},En=n(295),Cn=n.n(En),wn=n(296),xn=n.n(wn),Sn=Object(j.a)((function(e){return{root:{height:"100%",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"},transition:{textAlign:"center"},header:{marginBottom:e.spacing(2)}}})),In=(wt={},Object(T.a)(wt,Ae.players.SINGLE_PLAYER,Cn.a),Object(T.a)(wt,Ae.players.MULTIPLAYER,xn.a),wt),Tn=function(e){var t=Sn(),n=Object(a.useCallback)((function(t){var n=t.currentTarget.name;e.setPlayerMode(n)}),[e]),c=Object(a.useMemo)((function(){return De.players.map((function(e){return{props:{key:e,name:e,children:e,onClick:n,disabled:!!Pe[e],Icon:In[e],hover:!0}}}))}),[n]);return r.a.createElement("div",{className:t.root},r.a.createElement(pn,{label:"Select Players",buttons:c,layout:"h"}))},Mn=function(e){var t=Nt(),n=Object(a.useRef)(!1),r=Object(a.useMemo)((function(){var n=t.scores.length&&!e.looping?t.scores.reduce((function(e,t){return e+t.score}),0):0,a=+n.toFixed(1)/t.scores.length;return"You finished Time Attack in ".concat(n.toFixed(1),"\n      seconds, averaging ").concat(a.toFixed(1)," seconds per pose!")}),[t,e]);Object(a.useEffect)((function(){n.current||(n.current=!0,t.zip.handleLoadPreparedMasks("custom_mask.zip"))}),[t]);var c=Object(a.useCallback)(Object(E.a)(k.a.mark((function n(){return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.looping?(e.stop(),t.reset()):e.start(t.handleTimeAttackLoop);case 1:case"end":return n.stop()}}),n)}))),[e,t]);return Object(a.useMemo)((function(){return{name:"time attack",simpleGame:t,resultsText:r,handleClickGame:c}}),[t,r,c])},Rn=Object(_e.a)((function(e){return{root:{width:"100%",height:"100%",overflow:"hidden",position:"relative"},scrollContainer:{position:"absolute",top:0,left:0,bottom:0,right:-17,overflowY:"scroll",padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overlay:{background:"rgba(255,255,255,0.5)"},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},screen:{textAlign:"center","& > button":{marginTop:e.spacing(2)}}}})),Ln=function(e){var t,n,a=Rn(),c=sa(),o=w(),i=ua(Mn),l=i.simpleGame,s=i.handleClickGame,u=c.loop;return r.a.createElement("div",{className:a.root},r.a.createElement("div",{className:H()(a.scrollContainer,Object(T.a)({},a.overlay,!u.looping))},r.a.createElement("div",{className:H()(a.screen,Object(T.a)({},a.optionsTop,!!u.looping))},!u.looping&&r.a.createElement(Ht,{primaryText:"Time Attack",secondaryText:(null===(t=l.scores)||void 0===t?void 0:t.length)?"Play Again?":"Match the poses as quickly as you can.",Icon:(null===(n=l.scores)||void 0===n?void 0:n.length)?"replay":"play",iconProps:{color:"secondary",loading:!u.ready,onClick:s},middleContent:o.isFullScreen&&r.a.createElement(ct,{hideClose:!0}),helpContent:["Match each pose as quickly as possible","Your score is based on your total time, and the average time per pose.","Hop to it!"]}))))},An=n(619),Pn=n(620),Dn=n(627),Nn=n(580),Fn=n(173),Un=n.n(Fn),Bn=n(174),_n=n.n(Bn),zn=function(e){var t=w(),n=Object(a.useState)(_t),r=Object(p.a)(n,2),c=r[0],o=r[1],i=Nt({setLapTimeInfo:o}),l=Bt({maxMasks:5,setLapTimeInfo:o}),s=Object(a.useMemo)((function(){return i.multiplayerScores.map((function(t){return t.length&&!e.looping?t.reduce((function(e,t){return e+t.score}),0):0}))}),[i,e]),u=Object(a.useMemo)((function(){return s.map((function(e,t){return"Player ".concat(t?"Two":"One"," scored a total of ").concat(e," points")}))}),[s]),d=Object(a.useState)([[],[]]),m=Object(p.a)(d,2),f=m[0],b=m[1],v=Object(a.useState)(0),g=Object(p.a)(v,2),h=g[0],O=g[1],j=Object(a.useCallback)((function(){O((function(e){return e+1}))}),[]),y=Object(a.useCallback)((function(){e.looping?e.stop():(j(),e.start(l.handleLoop(Object(E.a)(k.a.mark((function e(){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(l.getMasks().map((function(e){var n=e.overlay;return t.dataUriToImageData(n)})));case 2:n=e.sent,0===h?b([n,[]]):1===h&&b((function(e){return[Object(lt.a)(e[0]),n]})),l.removeAllMasks();case 5:case"end":return e.stop()}}),e)}))))))}),[e,l,h,t,j]),C=Object(a.useCallback)((function(){var t=2===h?1:0,n=2===h?0:1;i.setMasks(f[t]),e.start(i.handleMultiplayerLoop(n)),j()}),[e,f,i,h,j]),x=Object(a.useCallback)((function(){O(0),i.clearScores()}),[i]),S=Object(a.useCallback)((function(){e.looping||(h<2?y():h<4?C():x())}),[e.looping,C,y,x,h]);return Object(a.useMemo)((function(){return{name:"local",simpleGame:i,handleClick:S,lapTimeInfo:c,captureMasks:l,setupProgress:h,multiplayerResultsText:u,multiplayerScoreSums:s,NUM_MASKS:5}}),[i,c,l,h,S,u,s])},Yn=Object(_e.a)((function(e){return{root:{width:"100%",height:"100%",overflow:"hidden",position:"relative"},scrollContainer:{position:"absolute",top:0,left:0,bottom:0,right:-17,overflowY:"scroll",padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overlay:{background:"rgba(255,255,255,0.5)"},rootTop:{justifyContent:"flex-start"},rootApart:{justifyContent:"space-between"},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},progress:{position:"absolute",top:e.spacing(1),left:e.spacing(8),right:e.spacing(8)},container:{textAlign:"center"},stepper:{background:"transparent",marginBottom:e.spacing(2)}}})),Gn=Object(_e.a)((function(e){return{root:{backgroundColor:"#ccc",zIndex:1,color:"#fff",width:50,height:50,display:"flex",borderRadius:"50%",justifyContent:"center",alignItems:"center"},active:{backgroundImage:"linear-gradient( 136deg, ".concat(e.palette.secondary.light," 0%, ").concat(e.palette.secondary.main," 50%, ").concat(e.palette.secondary.dark," 100%)"),boxShadow:"0 4px 10px 0 rgba(0,0,0,.25)"},completed:{backgroundImage:"linear-gradient( 136deg, ".concat(e.palette.secondary.light," 0%, ").concat(e.palette.secondary.main," 50%, ").concat(e.palette.secondary.dark," 100%)")}}}));function Vn(e){var t,n=Gn(),a=e.active,c=e.completed,o={1:r.a.createElement(Un.a,null),2:r.a.createElement(Un.a,null),3:r.a.createElement(_n.a,null),4:r.a.createElement(_n.a,null)};return r.a.createElement("div",{className:H()(n.root,(t={},Object(T.a)(t,n.active,a),Object(T.a)(t,n.completed,c),t))},o[String(e.icon)])}var Wn,qn,Xn,Hn=["Player One Capture","Player Two Capture","Player One Play","Player Two Play"],Kn=function(e){var t,n=sa(),c=ua(zn),o=w(),i=Object(p.a)([["One","Two"],["Two","One"]][c.setupProgress%2],2),l=i[0],s=i[1],u=c.setupProgress<2?"Player ".concat(l,", get ready to capture ").concat(c.NUM_MASKS," poses."):"Player ".concat(l,", get ready to play!"),d=c.setupProgress<2?"Player ".concat(s,", please leave the room."):"Good luck!",m=c.setupProgress>=4,f=Object(a.useMemo)((function(){return m?c.multiplayerScoreSums[0]>c.multiplayerScoreSums[1]?"Player One wins!":c.multiplayerScoreSums[0]<c.multiplayerScoreSums[1]?"Player Two wins!":"It's a tie!":""}),[c.multiplayerScoreSums,m]),b=Yn(m);return r.a.createElement("div",{className:b.root},r.a.createElement("div",{className:H()(b.scrollContainer,(t={},Object(T.a)(t,b.overlay,!n.loop.looping),Object(T.a)(t,b.rootTop,!1),Object(T.a)(t,b.rootApart,!1),t))},r.a.createElement("div",{className:H()(b.container,Object(T.a)({},b.optionsTop,!!n.loop.looping))},n.loop.looping?r.a.createElement("div",{className:b.progress},r.a.createElement(it,{color:c.lapTimeInfo.color,completed:c.lapTimeInfo.percentRemaining})):r.a.createElement(Ht,{headerContent:!m&&r.a.createElement(An.a,{className:b.stepper,alternativeLabel:!0,activeStep:c.setupProgress,connector:r.a.createElement(Nn.a,null)},Hn.map((function(e){return r.a.createElement(Pn.a,{key:e},r.a.createElement(Dn.a,{StepIconComponent:Vn},e))}))),primaryText:m?f:u,middleContent:c.setupProgress>=3&&o.isFullScreen&&!n.loop.looping&&r.a.createElement(en,{isFullScreen:o.isFullScreen}),secondaryText:m?"Play again?":d,iconProps:{color:"secondary",loading:!n.loop.ready,onClick:c.handleClick},Icon:m?"replay":"play",helpContent:!m&&["In this game mode two players will compete head to head.","Each player will take turns capturing funky poses for their opponent to try and match.","The player who does the best job matching their opponent's poses will win."]}))))},$n=Object(T.a)({},Ae.screen.PLAY,(Xn={},Object(T.a)(Xn,Ae.players.SINGLE_PLAYER,(Wn={},Object(T.a)(Wn,Ae.mode[Ae.players.SINGLE_PLAYER].PRACTICE,kn),Object(T.a)(Wn,Ae.mode[Ae.players.SINGLE_PLAYER].SURVIVAL,Zt),Object(T.a)(Wn,Ae.mode[Ae.players.SINGLE_PLAYER].TIME_ATTACK,Ln),Wn)),Object(T.a)(Xn,Ae.players.MULTIPLAYER,(qn={},Object(T.a)(qn,Ae.mode[Ae.players.MULTIPLAYER].LOCAL,Kn),Object(T.a)(qn,Ae.mode[Ae.players.MULTIPLAYER].REMOTE,(function(){return"REMOTE Content"})),qn)),Xn)),Zn=function(e){var t,n,a=e.screen.state,c=a.screen,o=a.mode,i=a.players;if(c===Ae.screen.DEFAULT)return r.a.createElement(Tn,{setPlayerMode:e.screen.handlers.setPlayerMode});if(o===Ae.mode.DEFAULT)return r.a.createElement(bn,{screen:e.screen});var l=(null===(t=$n[c])||void 0===t||null===(n=t[i])||void 0===n?void 0:n[o])||Be;return r.a.createElement(l,null)},Jn=function(e,t){switch(t.type){case Me:return Object(M.a)(Object(M.a)({},e),{},{mode:t.value});case Te:return Object(M.a)(Object(M.a)({},e),{},{screen:Ae.screen.PLAY,players:t.value});case Le:return Ne;case Re:var n=Object(M.a)({},e);if(e.mode)n.mode=Ae.mode.DEFAULT;else{if(e.screen===Ae.screen.DEFAULT)return e;n.screen=Ae.screen.DEFAULT,n.players=Ae.players.DEFAULT}return n;default:throw new Error("Invalid action: ".concat(t.type))}},Qn=n(297),ea=n.n(Qn)()(),ta=Object(a.createContext)(),na=function(e){var t=e.children,n=function(){var e=w(),t=Object(a.useRef)(),n=Object(a.useRef)(),r=Object(a.useState)(!1),c=Object(p.a)(r,2),o=c[0],i=c[1],l=Object(a.useState)(!1),s=Object(p.a)(l,2),u=s[0],d=s[1];Object(a.useEffect)((function(){!t.current&&e.ready&&(t.current=!0,ea.load().then((function(){console.log("BodyPix loaded"),i(!0)})).catch(console.error))}),[e]);var m=Object(a.useCallback)(Object(E.a)(k.a.mark((function t(){var n;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o){t.next=2;break}throw new Error('Please wait for the model to load before calling "predict"');case 2:return t.next=4,ea.predict(e.getVideoAsImageData());case 4:return n=t.sent,t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)}))),[o,e]);return Object(a.useEffect)((function(){!o||n.current||u||(n.current=!0,m().then((function(){d(!0)})))}),[m,o,u]),u?m:null}();return r.a.createElement(ta.Provider,{value:n},t)},aa=function(){var e=w(),t=function(){var e=Object(a.useContext)(ta);if(void 0===e)throw new Error("useBodyPix must be used within a BodyPixProvider");return e}(),n=t&&e.ready,r=function(){var e=Object(a.useRef)(),t=Object(a.useRef)(),n=Object(a.useRef)(),r=Object(a.useRef)(),c=Object(a.useRef)(),o=Object(a.useCallback)((function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t.current=a,e.current=a,r.current=0,n.current=0,c.current=0}),[]),i=Object(a.useCallback)((function(){c.current=0}),[]),l=Object(a.useCallback)((function(a){var l=!1;t.current||(l=!0,o(a));var s=a-e.current;c.current+=s;var u=0,d=0;n.current++&&(u=1e3/s,d=r.current/n.current,r.current+=u);var p=a-t.current;return e.current=a,{first:l,timestamp:a,fps:u,avgFps:d,elapsed:p,frames:n.current,lapTime:c.current,resetLapTime:i}}),[o,i]);return Object(a.useMemo)((function(){return{update:l,reset:o}}),[l,o])}(),c=function(){var e=Object(a.useRef)(),t=Mt().handlers.speech,n=Object(a.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.onBeforeStartLap,a=t.onLap,r=t.onEnd,c=t.maxLaps,o=t.setLapTimeInfo,i=t.lapDuration,l=void 0===i?3e3:i,s=t.postLapDelay,u=void 0===s?1e3:s,d=t.announceSeconds,p=void 0===d||d;a&&!e.current&&(e.current={onBeforeStartLap:n,onBeforeComplete:!1,onBeforeStarted:!1,onEndCalled:!1,onLap:a,onEnd:r,maxLaps:c,numLaps:0,lapDuration:l,postLapDelay:u,setLapTimeInfo:o,announceSeconds:p},o&&e.current.setLapTimeInfo(_t))}),[]),r=Object(a.useCallback)(function(){var n=Object(E.a)(k.a.mark((function n(a){var r,c,o,i,l,s,u,d,p,m,f;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=a.time,c=a.webcam,o=a.predict,i=a.stop,!e.current){n.next=40;break}if(!e.current.onBeforeStartLap||e.current.onBeforeComplete){n.next=13;break}if(!e.current.onBeforeStarted){n.next=7;break}return n.abrupt("return");case 7:return e.current.onBeforeStarted=!0,n.next=10,e.current.onBeforeStartLap({time:r,webcam:c,predict:o,stop:i});case 10:return e.current.onBeforeComplete=!0,r.resetLapTime(),n.abrupt("return");case 13:if(!e.current.maxLaps||e.current.numLaps!==e.current.maxLaps){n.next=26;break}if(!e.current.onEnd){n.next=24;break}if(e.current.onEndCalled){n.next=21;break}return e.current.onEndCalled=!0,n.next=19,e.current.onEnd({time:r,webcam:c,predict:o,stop:i});case 19:return e.current=null,n.abrupt("return",i());case 21:return n.abrupt("return");case 24:return e.current=null,n.abrupt("return",i());case 26:if(l=Math.floor(r.lapTime/100)/10,s=+Math.max(e.current.lapDuration/1e3-l,0).toFixed(1),e.current.setLapTimeInfo&&(u=Math.min(Number(s)/e.current.lapDuration*1e5,100),d=100-u,p=Ve(u),m=s.toFixed(1),f={percent:d,percentRemaining:u,color:p,secondsRemaining:m},e.current.setLapTimeInfo(f)),s&&e.current.announceSeconds&&e.current.lastSpeech!==s&&parseInt(s,10)===Number(s)&&(e.current.lastSpeech=s,t.say("".concat(s))),!(r.lapTime>=e.current.lapDuration)||e.current.handlerCalled){n.next=39;break}return e.current.numLaps++,e.current.handlerCalled=!0,e.current.handlerResolved=!1,n.next=36,e.current.onLap({time:r,webcam:c,predict:o,stop:i,lapNum:e.current.numLaps});case 36:e.current.handlerResolved=!0,n.next=40;break;case 39:r.lapTime>=e.current.lapDuration+e.current.postLapDelay&&e.current.handlerResolved&&(r.resetLapTime(),e.current.handlerCalled=!1,e.current.handlerResolved=!1);case 40:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[t]),c=Object(a.useCallback)((function(){e.current=null}),[]);return Object(a.useMemo)((function(){return{clear:c,useTimer:n,handleLap:r,timerRef:e}}),[c,n,r,e])}(),o=Object(a.useRef)(),i=Object(a.useRef)(),l=Object(a.useState)(!1),s=Object(p.a)(l,2),u=s[0],d=s[1],m=Object(a.useCallback)((function(){c.clear(),r.reset(),o.current=!0,d(!0)}),[r,c]),f=Object(a.useCallback)((function(){o.current=!1,d(!1)}),[]),b=Object(a.useCallback)(function(){var n=Object(E.a)(k.a.mark((function n(a){var l,s,u;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return l=r.update(a),s={time:l,webcam:e,predict:t,timerRef:c.timerRef,useTimer:c.useTimer,stop:f},n.next=4,i.current(s);case 4:u=n.sent,c.handleLap(s),o.current?requestAnimationFrame(b):(f(),i.current=null,e.clearCanvas(),u&&u());case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[e,t,c,r,f]),v=Object(a.useCallback)(function(){var e=Object(E.a)(k.a.mark((function e(a){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=4;break}throw new Error("The loop is not ready");case 4:if(!o.current){e.next=8;break}throw new Error("The loop is already running");case 8:if(t){e.next=12;break}throw new Error("Please wait for BodyPix to load...");case 12:if(a){e.next=14;break}throw new Error("A loop handler is required when calling loop.start");case 14:return i.current=a,m(),e.abrupt("return",requestAnimationFrame(b));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[b,t,m,n]);return Object(a.useMemo)((function(){return{start:v,looping:u,ready:n,stop:f}}),[v,u,f,n])},ra=function(){var e=aa(),t=Object(a.useState)(null),n=Object(p.a)(t,2),r=n[0],c=n[1],o=function(){var e=Object(a.useReducer)(Jn,Ne),t=Object(p.a)(e,2),n=t[0],r=t[1],c=Object(a.useCallback)((function(e){if(!De.screen.includes(e))throw new Error("Unknown screen: ".concat(e));r({type:Ie,value:e})}),[]),o=Object(a.useCallback)((function(e){if(![].concat(Object(lt.a)(De.mode[Ae.players.SINGLE_PLAYER]),Object(lt.a)(De.mode[Ae.players.MULTIPLAYER])).includes(e))throw new Error("Unknown gameMode: ".concat(e));r({type:Me,value:e})}),[]),i=Object(a.useCallback)((function(e){if(!De.players.includes(e))throw new Error("Unknown playerMode: ".concat(e));e===Ae.players.MULTIPLAYER&&o(Ae.mode[Ae.players.MULTIPLAYER].LOCAL),r({type:Te,value:e})}),[o]),l=Object(a.useCallback)((function(){r({type:Le})}),[]),s=Object(a.useCallback)((function(){r({type:Re})}),[]);return[n,Object(a.useMemo)((function(){return{setScreen:c,resetState:l,setGameMode:o,reverseState:s,setPlayerMode:i}}),[c,l,o,s,i])]}(),i=Object(p.a)(o,2),l=i[0],s=i[1],u=Object(a.useState)(!1),d=Object(p.a)(u,2),m=d[0],f=d[1],b=Object(a.useRef)(),v=Mt(),g=Object(a.useState)(!1),h=Object(p.a)(g,2),O=h[0],j=h[1],y=Object(a.useCallback)((function(){j(!0)}),[]),k=Object(a.useCallback)((function(){j(!1)}),[]),E=Object(a.useCallback)((function(){f(!0)}),[]),C=Object(a.useMemo)((function(){return{onHomeScreen:l.screen===Ae.screen.DEFAULT,handleBack:l.players===Ae.players.MULTIPLAYER?s.resetState:s.reverseState,toggleAudio:v.handlers.toggle,audioState:v.state,openHelp:y,closeHelp:k,helpOpen:O}}),[l,s,v,k,y,O]);return Object(a.useEffect)((function(){b.current||l.screen===Ae.screen.DEFAULT&&(b.current=!0)}),[l]),Object(a.useEffect)((function(){l.screen!==Ae.screen.DEFAULT&&l.mode!==Ae.mode.DEFAULT||!r||c(null)}),[l,r]),Object(a.useEffect)((function(){l.screen!==Ae.screen.DEFAULT&&l.mode!==Ae.mode.DEFAULT||!e.looping||e.stop()}),[l,e]),Object(a.useMemo)((function(){return{screen:{state:l,handlers:s},mode:r,loop:e,setMode:c,headerController:C,warning:{completed:m,handleCloseWarning:E}}}),[r,e,l,s,C,E,m])},ca=n(621),oa=Object(j.a)((function(e){return{title:{color:"red",fontStyle:"italic"},actions:{paddingLeft:e.spacing(2),paddingRight:e.spacing(2)},dialogContent:{fontStyle:24},group:{marginTop:e.spacing(2)}}})),ia=Object(a.memo)((function(e){var t=e.open,n=e.handleClose,a=oa();return r.a.createElement(ge.a,{"aria-labelledby":"warning",open:t},r.a.createElement(he.a,{disableTypography:!0,id:"warning",className:a.title},r.a.createElement(g.a,{variant:"h5"},"Warning!")),r.a.createElement(Oe.a,{dividers:!0,className:a.dialogContent},r.a.createElement(g.a,{component:"h2",variant:"h6"},"physically demanding"),r.a.createElement(g.a,{gutterBottom:!0},"Be careful when moving. Consider consulting a medical professional before playing."),r.a.createElement("div",{className:a.group},r.a.createElement(g.a,{component:"h2",variant:"h6"},"Large Space Required"),r.a.createElement(g.a,{gutterBottom:!0},"Ensure that you have a large open playing area that will allow you to move around safely."))),r.a.createElement(ca.a,{className:a.actions},r.a.createElement(sn.a,{color:"secondary",onClick:n,variant:"contained"},"Acknowledge")))})),la=Object(a.createContext)(),sa=function(){var e=Object(a.useContext)(la);if(!e)throw new Error("useGame must be called from inside the <Game> component.");return e},ua=function(e){var t=sa(),n=t.loop,r=t.setMode,c=e(n);return Object(a.useEffect)((function(){r(c)}),[c,r]),c},da=Object(a.memo)((function(e){e.webcam;var t=ra();return r.a.createElement(la.Provider,{value:t},r.a.createElement(ia,{open:!t.warning.completed,handleClose:t.warning.handleCloseWarning}),r.a.createElement(we,{controller:t.headerController}),r.a.createElement(Ue,{screenState:t.screen.state}),r.a.createElement(ve,{overlay:!t.screen.state.mode,headerController:t.headerController},r.a.createElement(Zn,{screen:t.screen})),r.a.createElement(an,{screen:t.screen}))})),pa=function(){return r.a.createElement("div",null,"Sorry, but this game requires a webcam. Please plug in a webcam and refresh the page.")},ma=Object(j.a)((function(e){return{root:{maxWidth:1100,margin:"0 auto ".concat(e.spacing(2),"px")}}})),fa=Object(a.memo)((function(e){var t=w(),n=t.currentDeviceId,c=t.hasVideo,o=t.cameras,i=t.autoStartDeviceId,l=Object(a.useRef)();Object(a.useEffect)((function(){c&&o.length&&(n||i)&&!l.current&&(l.current=!0,t.start().catch(console.error))}),[c,o,n,i,t]);var s=ma();return r.a.createElement("main",{className:s.root},c?r.a.createElement(da,{webcam:t}):r.a.createElement(pa,null))})),ba=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return[].concat(t,["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"']).join(",")},va=Object(h.a)({palette:{primary:{main:"#FFFFFF"},secondary:{main:"#000000"}},typography:{useNextVariants:!0,fontFamily:ba("Orbitron"),body1:{fontWeight:600,fontFamily:ba("Rajdhani"),fontSize:18}},overrides:{}});var ga=function(){var e=Object(a.useState)(!1),t=Object(p.a)(e,2),n=t[0],c=t[1],o=Object(a.useRef)();return Object(a.useEffect)((function(){var e=setInterval((function(){window.cvReady&&(c(!0),clearInterval(e))}),200);return function(){clearInterval(e)}}),[]),Object(a.useEffect)((function(){o.current||(o.current=!0,f.a.init({selector:".background"}))})),r.a.createElement(O.a,{theme:va},r.a.createElement(b.BrowserView,null,r.a.createElement(S,null,r.a.createElement(na,null,r.a.createElement(Rt,null,r.a.createElement(Dt,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,null),r.a.createElement(fa,{cvReady:n}))))))),r.a.createElement(b.MobileView,null,r.a.createElement(g.a,{component:"h1",variant:"h6"},"To play Carbon Copy, open this site on a laptop or desktop computer.")))};o.a.render(r.a.createElement(ga,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[312,1,2]]]);
//# sourceMappingURL=main.0c022850.chunk.js.map