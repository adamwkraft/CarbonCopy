{"version":3,"sources":["images/stick_figure_in_box.png","worker/bodyPix.js","serviceWorker.js","context/webcam.js","components/Loader.js","components/SelectAndCheck.js","components/WebcamSelect.js","components/PermissionNeeded.js","components/Webcam.js","lib/constants.js","hooks/sfx.js","hooks/speech.js","hooks/audioController.js","context/audio.js","lib/screenConstants.js","components/GlobalHeader.js","components/DefaultHeader.js","components/GameScreens/ScreenHeader.js","components/Null.js","lib/score.js","components/MasksGrid.js","components/ScoreResults.js","components/CapturedMasks.js","components/GameScreens/SinglePlayer/BasicFooter.js","components/ProgressBar.js","lib/util.js","hooks/zip.js","hooks/iterateMask.js","context/carbon.js","hooks/carbonController.js","hooks/loopHandlers/simpleGame.js","hooks/loopHandlers/captureMasks.js","hooks/lapTimer.js","hooks/screenHooks/survival.js","components/GameInfoBox.js","components/GameScreens/SinglePlayer/Survival.js","components/GameScreens/SinglePlayer/SurvivalFooter.js","components/GameScreens/MultiPlayer/MultiplayerFooter.js","components/GameScreens/ScreenFooter.js","components/Options.js","components/SelectGameMode.js","components/FileUpload.js","components/GameSelect.js","hooks/screenHooks/practice.js","components/GameScreens/SinglePlayer/Practice.js","components/ChoosePlayers.js","hooks/screenHooks/timeAttack.js","components/GameScreens/SinglePlayer/TimeAttack.js","hooks/screenHooks/local.js","components/GameScreens/MultiPlayer/Local.js","components/GameScreens/ScreenContent.js","hooks/screenController.js","hooks/bodyPixController.js","context/bodyPix.js","hooks/loop.js","hooks/loopTime.js","hooks/game.js","components/Game.js","components/Main/NoWebcam.js","components/Main/index.js","App/App.js","index.js"],"names":["module","exports","addMethods","methods","w","Worker","name","Boolean","window","location","hostname","match","webcamContext","createContext","useWebcam","state","useContext","Error","hasVideo","navigator","mediaDevices","getUserMedia","WebcamProvider","children","rootRef","useRef","videoRef","canvasRef","useState","ctx","setCtx","flipX","setFlipX","ready","setReady","cameras","setCameras","hidden","__setHidden","scratchpad","setScratchpad","videoError","setVideoError","videoStream","setVideoStream","permissionNeeded","setPermissionNeeded","permissionDenied","setPermissionDenied","undefined","currentDeviceId","setCurrentDeviceId","autoStartDeviceId","_setAutoStartDeviceId","useEffect","current","getContext","canvas","document","createElement","width","height","_ctx","setVisible","useCallback","_setHidden","clearScratchpad","clearRect","clearCanvas","stopVideo","getTracks","forEach","track","stop","startVideo","userConstraintsOrDeviceIdx","a","console","error","userConstraints","isDeviceIdx","deviceIdx","log","constraints","video","exact","audio","deviceId","stream","getCapabilities","srcObject","message","toLowerCase","includes","Promise","all","resolve","onloadedmetadata","onloadeddata","then","start","discoverCameras","enumerateDevices","devices","foundCameras","filter","kind","label","map","currentCamera","idx","lastIndexOf","slice","toggleFlipX","setAutoStartDeviceId","localStorage","setItem","clearAutoStartDeviceId","removeItem","imageDataToDataUri","imageData","putImageData","dataUri","toDataURL","dataUriToImageData","img","Image","src","onload","drawImage","getImageData","getVideoAsImageData","autoStartId","getItem","foundEmptyDevice","foundDeviceId","reduce","acc","warn","hasFullScreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","fullScreen","setFullScreen","onTransition","isFullScreen","fullscreenElement","addEventListener","removeEventListener","enterFullScreen","exitFullScreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","msExitFullscreen","toggleFullScreen","context","useMemo","Provider","value","Loader","color","styleProps","useSpring","to","opacity","from","config","stiff","div","style","version","id","xmlns","x","y","viewBox","enableBackground","fill","d","attributeName","attributeType","type","dur","repeatCount","noop","useStyles","makeStyles","theme","root","props","position","arrowIcon","marginLeft","spacing","tooltip","margin","arrow","fontSize","content","display","borderStyle","paper","border","popper","top","left","marginTop","borderWidth","borderColor","palette","grey","bottom","marginBottom","right","marginRight","SelectAndCheck","classes","Math","random","isMountedRef","anchorEl","setAnchorEl","arrowRef","setArrowRef","handleClickSelect","event","currentTarget","closeSelect","handleCloseSelect","onClose","handleClickCheckbox","onClickCheckbox","target","handleClickSelectItem","onSelect","open","className","Button","disableRipple","variant","aria-haspopup","button","onClick","aria-controls","SelectProps","activeTitle","title","Menu","keepMounted","elevation","getContentAnchorEl","anchorOrigin","vertical","horizontal","transformOrigin","MenuProps","options","i","key","text","selected","tooltipTitle","checked","checkboxValue","TooltipAndCheckbox","_Checkbox","Checkbox","tooltipText","Tooltip","PopperProps","popperOptions","modifiers","enabled","element","Fragment","ref","enterDelay","tooltipEnterDelay","leaveDelay","tooltipLeaveDelay","aria-label","placement","tooltipPlacement","MenuItem","MenuItemProps","ListItemText","primary","toString","WebcamSelect","webcam","selectedCamera","_selectedCamera","none","some","camera","handleSelectCamera","handleSetDefaultCamera","length","alignItems","justifyContent","padding","borderRadius","textAlign","PermissionNeeded","slideProps","transform","slow","fadeProps","wobbly","Paper","container","Typography","component","rel","href","fs","maxWidth","paddingLeft","paddingRight","overflow","zIndex","background","overlay","overlayColor","loader","Webcam","autoPlay","videoWidth","videoHeight","IconButton","useSfx","audioRef","play","soundName","AudioContext","webkitAudioContext","mozAudioContext","source","createBufferSource","myRequest","Request","fetch","response","arrayBuffer","buffer","decodeAudioData","decodedData","connect","destination","makeSound","playSuccessSound","playFailureSound","playCameraSound","synth","speechSynthesis","useAudioController","audioState","setAudioState","speech","voices","setVoices","voice","setVoice","allVoices","getVoices","say","utterance","SpeechSynthesisUtterance","speak","countdown","onEnd","onEach","setTimeout","Array","_","num","useSpeech","sfx","toggle","stateRef","handlers","audioContext","useAudio","AudioProvider","screenTypes","screenStates","screen","DEFAULT","PLAY","players","SINGLE_PLAYER","MULTIPLAYER","mode","PRACTICE","SURVIVAL","TIME_ATTACK","LOCAL","REMOTE","wipScreens","item","screenStatesArrays","Object","entries","stateKey","statesObj","values","modeAcc","playerModeKey","playerModesObj","initialScreenState","btn","back","volume","closeButton","info","stickImage","DialogTitle","withStyles","other","disableTypography","DialogContent","MuiDialogContent","memo","setOpen","handleClose","tutorial","markTutorialCompleted","onHomeScreen","size","goHome","classnames","goBack","Dialog","aria-labelledby","completed","dividers","gutterBottom","alt","heading","DefaultHeader","game","useGame","Headers","ScreenHeader","screenState","HeaderContent","Null","rawScoreToTenBinScore","score","p","max","min","round","scoreToColor","alpha","r","g","hex","b","hexToRGB","red","green","blue","e","tenBinScoreToColor","tenBinScoreToPercent","masks","masksHeader","masksList","flexFlow","maskContainer","imgContainer","removeMask","transition","iconBtn","backgroundColor","actions","MasksGrid","actionButtons","getDataUri","getImageChild","getPaperProps","PaperProps","Icon","maskItem","paperProps","ScoreResults","results","fixedGameScore","toFixed","CapturedMasks","captureMasks","handlePlay","PlayIcon","DownloadIcon","downloadMasks","CloseIcon","removeAllMasks","binary","BasicFooter","showTimeAttackResults","simpleGame","handlePlayCapturedMasks","resultsText","showResults","loop","looping","scores","hideClose","clearScores","flip","pWebkitTransform","filler","ProgressBar","getOpenCvMaskFromSegmentation","segmentation","flipped","data","binaryBytes","Uint8ClampedArray","parseInt","isPerson","bytes_index","binaryImageData","ImageData","segData","cv","matFromImageData","rgbaPlanes","MatVector","split","pre_mask","Mat","threshold","get","THRESH_BINARY","contours","hierarchy","findContours","RETR_CCOMP","CHAIN_APPROX_SIMPLE","mask","zeros","rows","cols","CV_8UC1","contourArea","drawContours","LINE_8","delete","getSegmentationeOverlayAndBinaryImageData","CV_8UC4","setTo","borderMask","M","ones","CV_8U","anchor","Point","dilate","BORDER_CONSTANT","morphologyDefaultBorderValue","subtract","merge","overlayImageData","getScore","targetImageData","bytes","union","intersection","isInPolygon","isIntersection","isMissedPolygon","isPersonOutOfPolygon","isInteresting","getScoreAndOverlayForSegmentationAndImageData","segmentationMask","segOverlay","segOverlayImageData","targetData","targetRgbaPlanes","mergedImage","addWeighted","mergedOverlayImageData","targetOverlay","saveAs","blob","filename","msSaveOrOpenBlob","msSaveBlob","elem","URL","createObjectURL","download","body","documentElement","appendChild","click","dispatchEvent","MouseEvent","view","bubbles","cancelable","revokeObjectURL","getMaskName","useZip","setMasks","zipLoading","setZipLoading","loadZippedMasks","file","JSZip","loadAsync","endsWith","async","binaryMasks","b64","masksAsImageData","handleZipInputChange","handleLoadPreparedMasks","external","reject","JSZipUtils","getBinaryContent","process","err","handleLoadRandomMaskSet","floor","loading","useIterateMask","masksRef","maskRef","maskIdxRef","_setMasks","newMasks","reset","shuffle","temporaryValue","randomIndex","array","currentIndex","resetAndShuffle","next","currentMask","getNumMasks","hasMasks","carbonContext","useCarbon","CarbonProvider","carbonRef","carbonState","setCarbonState","__carbonate__","useCarbonController","useSimpleGame","setLapTimeInfo","promRef","roundTracker","maskIterator","lastTimeAttackSuccess","setScores","multiplayerScores","setMultiplayerScores","zip","handleBasicLoop","playerIndex","controller","time","first","useTimer","maxLaps","announceSeconds","onLap","predict","newState","handleLoop","handleMultiplayerLoop","handleSurvivalLoop","lapDuration","tenBinScore","t_sec","timerRef","handleTimeAttackLoop","postLapDelay","currentMaskIdx","segmentationMs","elapsed","segmentationSec","numSecs","Number","catch","useCaptureMasks","maxMasks","maskCountRef","arg","getMasks","index","folder","imageDataUri","decode","dataBase64","base64","generateAsync","zipFile","onLoopEnd","onBeforeStartLap","overlayDataUri","binaryDataUri","initialLapInfo","percent","percentRemaining","secondsRemaining","useSurvival","lapTimeInfo","loadedRef","handleClickGame","handleClickCaptureMasks","help","maxHeight","helpBtn","icon","GameInfoBox","headerContent","middleContent","footerContent","primaryText","secondaryText","helpContent","iconProps","isLoading","showHelp","setShowHelp","toggleHelp","IconComponent","CircularProgress","replay","ReplayIcon","classNames","subtext","disabled","isArray","flexDirection","optionsTop","progress","getSurvivalPaperProps","ind","Survival","survival","useGameMode","SurvivalFooter","minWidth","MultiplayerFooter","multiplayerResultsText","Footers","ScreenFooter","Footer","buttons","h","v","fontWeight","main","secondary","getConfig","offset","Options","trail","useTrail","labelTrail","layout","Component","visible","componentProps","iconButton","gameMode","header","SelectGameMode","handleSetGameMode","setGameMode","obj","fileInput","FileUpload","onChange","multiple","buttonProps","fileRef","handleFileUpload","fileObject","disallowMultiple","allFiles","files","filteredFiles","resetFile","GameSelect","setWidth","clientWidth","React","handleOpen","handleClick","fullWidth","containerRef","usePractice","loopType","setLoopType","handleStartRandomGame","scrollContainer","overflowY","rootTop","rootApart","captures","Practice","practice","timerColor","Icons","PersonIcon","PeopleAltIcon","ChoosePlayers","handleSetPlayerMode","setPlayerMode","playerMode","useTimeAttack","total","average","TimeAttack","timeAttack","useLocal","multiplayerScoreSums","playerIdx","setupProgress","setSetupProgress","incrementProgress","handleCapture","handlePlayGame","maskIndex","handleReset","NUM_MASKS","stepper","useColorlibStepIconStyles","active","backgroundImage","light","dark","boxShadow","ColorlibStepIcon","icons","1","2","3","4","String","stepperLabels","Local","local","replayPhase","winnerText","Stepper","alternativeLabel","activeStep","connector","StepConnector","Step","StepLabel","StepIconComponent","Screens","ScreenContent","Content","reducer","action","bodyPixWorker","BodyPixWorker","bodyPixContext","BodyPixProvider","loadRef","preloadRef","netReady","setNetReady","netPreloaded","setNetPreloaded","load","useBodyPixController","useLoop","useBodyPix","loopReady","loopTime","lastTimeRef","startTimeRef","totalFramesRef","fpsSumRef","lapTime","timestamp","resetLapTime","update","deltaTime","fps","avgFps","frames","useLoopTime","lapTimer","onBeforeComplete","onBeforeStarted","onEndCalled","numLaps","handleLap","secondsPassed","lapInfo","lastSpeech","handlerCalled","handlerResolved","lapNum","clear","useLapTimer","loopingRef","handleLoopRef","setLooping","setStartLoop","setStopLoop","cleanup","requestAnimationFrame","useGameController","setMode","useReducer","dispatch","setScreen","resetState","reverseState","useScreenController","screenHandlers","tutorialCompleted","setTutorialCompleted","tutorialRef","gameContext","useGameModeHook","NoWebcam","startedRef","createMuiTheme","cvReady","setCvReady","particlesRef","interval","setInterval","clearInterval","Particles","init","selector","CssBaseline","ReactDOM","render","getElementById","serviceWorker","registration","unregister"],"mappings":"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","file":"static/js/main.c496117e.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/stick_figure_in_box.66cc93bc.png\";","\n\t\t\t\tvar addMethods = require(\"../../node_modules/workerize-loader/dist/rpc-wrapper.js\")\n\t\t\t\tvar methods = [\"load\",\"predict\"]\n\t\t\t\tmodule.exports = function() {\n\t\t\t\t\tvar w = new Worker(__webpack_public_path__ + \"e7c4556103d7ca32aea4.worker.js\", { name: \"[hash].worker.js\" })\n\t\t\t\t\taddMethods(w, methods)\n\t\t\t\t\t\n\t\t\t\t\treturn w\n\t\t\t\t}\n\t\t\t","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/),\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA',\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.',\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React, {\n  createContext,\n  useState,\n  useMemo,\n  useCallback,\n  useRef,\n  useEffect,\n  useContext,\n} from 'react';\n\nexport const webcamContext = createContext();\n\nexport const useWebcam = () => {\n  const state = useContext(webcamContext);\n\n  if (!state) {\n    throw new Error('useWebcam must be used within a WebcamProvider');\n  }\n\n  return state;\n};\n\nconst VIDEO_WIDTH = 1280;\nconst VIDEO_HEIGHT = 720;\nconst AUTOSTART_KEY = 'AutoStartId';\nconst hasVideo = !!navigator?.mediaDevices?.getUserMedia;\n\nconst WebcamProvider = ({ children }) => {\n  const rootRef = useRef();\n  const videoRef = useRef();\n  const canvasRef = useRef();\n  const [ctx, setCtx] = useState(null);\n  const [flipX, setFlipX] = useState(true);\n  const [ready, setReady] = useState(false);\n  const [cameras, setCameras] = useState([]);\n  const [hidden, __setHidden] = useState(true);\n  const [scratchpad, setScratchpad] = useState(null);\n  const [videoError, setVideoError] = useState(null);\n  const [videoStream, setVideoStream] = useState(null);\n  const [permissionNeeded, setPermissionNeeded] = useState(false);\n  const [permissionDenied, setPermissionDenied] = useState(false);\n  const [currentDeviceId, setCurrentDeviceId] = useState(undefined);\n  const [autoStartDeviceId, _setAutoStartDeviceId] = useState(undefined);\n\n  useEffect(() => {\n    if (canvasRef.current && !ctx) {\n      setCtx(canvasRef.current.getContext('2d'));\n    } else if (ctx && !canvasRef.current) {\n      setCtx(null);\n    }\n  }, [ctx]);\n\n  // create a scratchpad for performing image transformations\n  // without cluttering the main canvas\n  useEffect(() => {\n    if (ready && !scratchpad) {\n      const canvas = document.createElement('canvas');\n      canvas.width = canvasRef.current.width;\n      canvas.height = canvasRef.current.height;\n      const _ctx = canvas.getContext('2d');\n\n      setScratchpad({ ctx: _ctx, canvas });\n    }\n  }, [scratchpad, ready]);\n\n  const setVisible = useCallback(() => {\n    __setHidden(false);\n  }, []);\n\n  const _setHidden = useCallback(() => {\n    __setHidden(true);\n  }, []);\n\n  const clearScratchpad = useCallback(() => {\n    scratchpad.ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n  }, [scratchpad]);\n\n  const clearCanvas = useCallback(() => {\n    ctx.clearRect(0, 0, canvasRef.current?.width, canvasRef.current?.height);\n  }, [ctx]);\n\n  const stopVideo = useCallback(() => {\n    if (videoStream) {\n      videoStream.getTracks().forEach((track) => track.stop());\n    }\n\n    setVideoError(null);\n    setVideoStream(null);\n    setReady(false);\n    setCurrentDeviceId(undefined);\n  }, [videoStream]);\n\n  const startVideo = useCallback(\n    async (userConstraintsOrDeviceIdx) => {\n      stopVideo();\n\n      if (!hasVideo) {\n        const message = 'Video not supported';\n\n        console.error(message);\n        setVideoError(message);\n\n        return;\n      }\n\n      const isDeviceIdx = typeof userConstraintsOrDeviceIdx === 'number';\n\n      const userConstraints = isDeviceIdx ? {} : userConstraintsOrDeviceIdx || {};\n      const deviceIdx = isDeviceIdx ? userConstraintsOrDeviceIdx : userConstraints.deviceIdx;\n\n      try {\n        console.log('Finding Webcams...');\n        const constraints = {\n          video: {\n            width: { exact: userConstraints.width || VIDEO_WIDTH },\n            height: { exact: userConstraints.height || VIDEO_HEIGHT },\n          },\n          audio: false,\n        };\n\n        if (deviceIdx !== undefined) {\n          userConstraints.deviceId = cameras[deviceIdx]?.deviceId;\n        }\n\n        if (userConstraints.deviceId) {\n          constraints.video.deviceId = { exact: userConstraints.deviceId };\n        }\n\n        const stream = await navigator.mediaDevices.getUserMedia(constraints);\n        const deviceId = stream.getTracks()[0]?.getCapabilities()?.deviceId;\n\n        console.log('Found webcam!');\n        setVideoStream(stream);\n        setCurrentDeviceId(deviceId);\n        setVideoError(false);\n        setPermissionDenied(false);\n        setPermissionNeeded(false);\n        videoRef.current.srcObject = stream;\n      } catch (e) {\n        const message = 'Error starting video.';\n        console.error(message);\n        console.error(e.message);\n        if (e.message?.toLowerCase?.()?.includes?.('permission denied')) {\n          setPermissionDenied(true);\n        }\n        setVideoStream(null);\n        setReady(false);\n        setVideoError(message);\n\n        return;\n      }\n\n      return await Promise.all([\n        new Promise((resolve) => {\n          videoRef.current.onloadedmetadata = () => resolve();\n        }),\n        new Promise((resolve) => {\n          videoRef.current.onloadeddata = () => resolve();\n        }),\n      ]).then(() => {\n        console.log('Webcam ready!');\n        setReady(true);\n        __setHidden(false);\n      });\n    },\n    [stopVideo, videoRef, cameras],\n  );\n\n  const start = useCallback(async () => startVideo({ deviceId: autoStartDeviceId }), [\n    autoStartDeviceId,\n    startVideo,\n  ]);\n\n  const discoverCameras = useCallback(async () => {\n    const enumerateDevices = navigator?.mediaDevices?.enumerateDevices;\n\n    if (!enumerateDevices) {\n      console.error('Cannot get cameras.');\n\n      return [];\n    }\n\n    const devices = await navigator.mediaDevices.enumerateDevices();\n    const foundCameras = devices\n      .filter(\n        ({ kind, label }) => kind === 'videoinput' && !label.includes('CamTwist'), // filter by video elements and remove CamTwist virtual devices\n      )\n      .map((currentCamera) => {\n        let label;\n        const idx = currentCamera.label.lastIndexOf(' (');\n        if (idx > -1) label = currentCamera.label.slice(0, idx);\n\n        return label ? { deviceId: currentCamera.deviceId, label } : currentCamera;\n      });\n\n    setCameras(foundCameras);\n\n    return foundCameras;\n  }, []);\n\n  const toggleFlipX = useCallback(() => setFlipX((state) => !state), []);\n\n  const setAutoStartDeviceId = useCallback((deviceId) => {\n    window.localStorage.setItem(AUTOSTART_KEY, deviceId);\n    _setAutoStartDeviceId(deviceId);\n  }, []);\n\n  const clearAutoStartDeviceId = useCallback(() => {\n    window.localStorage.removeItem(AUTOSTART_KEY);\n    _setAutoStartDeviceId(null);\n  }, []);\n\n  const imageDataToDataUri = useCallback(\n    (imageData) => {\n      clearScratchpad();\n      scratchpad.ctx.putImageData(imageData, 0, 0);\n      const dataUri = scratchpad.canvas.toDataURL('image/png');\n      clearScratchpad();\n\n      return dataUri;\n    },\n    [scratchpad, clearScratchpad],\n  );\n\n  const dataUriToImageData = useCallback(\n    async (dataUri) => {\n      console.log('DATA URI: ', dataUri);\n      clearScratchpad();\n      const img = new Image();\n      img.src = dataUri;\n\n      await new Promise((resolve) => {\n        img.onload = () => {\n          scratchpad.ctx.drawImage(img, 0, 0);\n          resolve();\n        };\n      });\n\n      const imageData = scratchpad.ctx.getImageData(\n        0,\n        0,\n        canvasRef.current.width,\n        canvasRef.current.height,\n      );\n      clearScratchpad();\n\n      return imageData;\n    },\n    [clearScratchpad, scratchpad],\n  );\n\n  const getVideoAsImageData = useCallback(() => {\n    clearScratchpad();\n    scratchpad.ctx.drawImage(videoRef.current, 0, 0);\n    const imageData = scratchpad.ctx.getImageData(\n      0,\n      0,\n      canvasRef.current.width,\n      canvasRef.current.height,\n    );\n    clearScratchpad();\n\n    return imageData;\n  }, [clearScratchpad, scratchpad]);\n\n  useEffect(() => {\n    discoverCameras().then((foundCameras) => {\n      const autoStartId = window.localStorage.getItem(AUTOSTART_KEY);\n\n      let foundEmptyDevice = false;\n      let foundDeviceId = foundCameras[0]?.deviceId;\n      foundDeviceId =\n        foundCameras.reduce((acc, { deviceId, label }, idx) => {\n          if (!deviceId) foundEmptyDevice = true;\n\n          if (deviceId === autoStartId) return deviceId;\n\n          return acc || (label.includes('Built-in') ? deviceId : null);\n        }, null) || foundDeviceId;\n\n      if (foundDeviceId) {\n        setAutoStartDeviceId(foundDeviceId);\n      } else if (foundEmptyDevice) {\n        setPermissionNeeded(true);\n        console.warn('Need video permissions!');\n      } else if (!foundDeviceId && autoStartId) clearAutoStartDeviceId();\n    });\n  }, []); // eslint-disable-line\n\n  const hasFullScreen = !!(\n    rootRef.current?.requestFullscreen ||\n    rootRef.current?.mozRequestFullScreen ||\n    rootRef.current?.webkitRequestFullscreen ||\n    rootRef.current?.msRequestFullscreen\n  );\n\n  const [fullScreen, setFullScreen] = useState(false);\n\n  useEffect(() => {\n    const onTransition = () => {\n      const isFullScreen = !!document.fullscreenElement;\n      setFullScreen(isFullScreen);\n    };\n\n    document.addEventListener('fullscreenchange', onTransition);\n\n    return () => document.removeEventListener('fullscreenchange', onTransition);\n  }, []);\n\n  const enterFullScreen = useCallback(() => {\n    if (!hasFullScreen) return;\n\n    if (rootRef.current.requestFullscreen) {\n      rootRef.current.requestFullscreen();\n    } else if (rootRef.current.mozRequestFullScreen) {\n      /* Firefox */\n      rootRef.current.mozRequestFullScreen();\n    } else if (rootRef.current.webkitRequestFullscreen) {\n      /* Chrome, Safari and Opera */\n      rootRef.current.webkitRequestFullscreen();\n    } else if (rootRef.current.msRequestFullscreen) {\n      /* IE/Edge */\n      rootRef.current.msRequestFullscreen();\n    }\n  }, [hasFullScreen]);\n\n  const exitFullScreen = useCallback(() => {\n    if (!hasFullScreen) return;\n\n    if (document.exitFullscreen) {\n      document.exitFullscreen();\n    } else if (document.mozCancelFullScreen) {\n      /* Firefox */\n      document.mozCancelFullScreen();\n    } else if (document.webkitExitFullscreen) {\n      /* Chrome, Safari and Opera */\n      document.webkitExitFullscreen();\n    } else if (document.msExitFullscreen) {\n      /* IE/Edge */\n      document.msExitFullscreen();\n    }\n  }, [hasFullScreen]);\n\n  const toggleFullScreen = useCallback(() => {\n    if (fullScreen) exitFullScreen();\n    else enterFullScreen();\n  }, [fullScreen, enterFullScreen, exitFullScreen]);\n\n  const context = useMemo(\n    () => ({\n      ctx,\n      ready,\n      flipX,\n      start,\n      hidden,\n      rootRef,\n      cameras,\n      setFlipX,\n      videoRef,\n      hasVideo,\n      _setHidden,\n      canvasRef,\n      stopVideo,\n      setVisible,\n      startVideo,\n      videoError,\n      scratchpad,\n      clearCanvas,\n      toggleFlipX,\n      videoStream,\n      hasFullScreen,\n      exitFullScreen,\n      clearScratchpad,\n      currentDeviceId,\n      enterFullScreen,\n      stop: stopVideo,\n      discoverCameras,\n      permissionNeeded,\n      permissionDenied,\n      toggleFullScreen,\n      autoStartDeviceId,\n      imageDataToDataUri,\n      dataUriToImageData,\n      getVideoAsImageData,\n      setAutoStartDeviceId,\n      clearAutoStartDeviceId,\n      isFullScreen: fullScreen,\n    }),\n    [\n      ctx,\n      ready,\n      flipX,\n      start,\n      hidden,\n      cameras,\n      setFlipX,\n      _setHidden,\n      stopVideo,\n      fullScreen,\n      setVisible,\n      startVideo,\n      videoError,\n      scratchpad,\n      toggleFlipX,\n      clearCanvas,\n      videoStream,\n      hasFullScreen,\n      exitFullScreen,\n      clearScratchpad,\n      currentDeviceId,\n      enterFullScreen,\n      discoverCameras,\n      permissionNeeded,\n      permissionDenied,\n      toggleFullScreen,\n      autoStartDeviceId,\n      imageDataToDataUri,\n      dataUriToImageData,\n      getVideoAsImageData,\n      setAutoStartDeviceId,\n      clearAutoStartDeviceId,\n    ],\n  );\n\n  return <webcamContext.Provider value={context}>{children}</webcamContext.Provider>;\n};\n\nexport default WebcamProvider;\n","import React from 'react';\nimport { useSpring, animated, config } from 'react-spring';\n\nconst Loader = ({ color = '#fff' }) => {\n  const styleProps = useSpring({ to: { opacity: 1 }, from: { opacity: 0 }, config: config.stiff });\n\n  // https://codepen.io/nikhil8krishnan\n  return (\n    <animated.div style={styleProps}>\n      <svg\n        version=\"1.1\"\n        id=\"L7\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        x=\"0px\"\n        y=\"0px\"\n        viewBox=\"0 0 100 100\"\n        enableBackground=\"new 0 0 100 100\"\n      >\n        <path\n          fill={color}\n          d=\"M31.6,3.5C5.9,13.6-6.6,42.7,3.5,68.4c10.1,25.7,39.2,38.3,64.9,28.1l-3.1-7.9c-21.3,8.4-45.4-2-53.8-23.3\n    c-8.4-21.3,2-45.4,23.3-53.8L31.6,3.5z\"\n        >\n          <animateTransform\n            attributeName=\"transform\"\n            attributeType=\"XML\"\n            type=\"rotate\"\n            dur=\"2s\"\n            from=\"0 50 50\"\n            to=\"360 50 50\"\n            repeatCount=\"indefinite\"\n          />\n        </path>\n        <path\n          fill={color}\n          d=\"M42.3,39.6c5.7-4.3,13.9-3.1,18.1,2.7c4.3,5.7,3.1,13.9-2.7,18.1l4.1,5.5c8.8-6.5,10.6-19,4.1-27.7\n    c-6.5-8.8-19-10.6-27.7-4.1L42.3,39.6z\"\n        >\n          <animateTransform\n            attributeName=\"transform\"\n            attributeType=\"XML\"\n            type=\"rotate\"\n            dur=\"1s\"\n            from=\"0 50 50\"\n            to=\"-360 50 50\"\n            repeatCount=\"indefinite\"\n          />\n        </path>\n        <path\n          fill={color}\n          d=\"M82,35.7C74.1,18,53.4,10.1,35.7,18S10.1,46.6,18,64.3l7.6-3.4c-6-13.5,0-29.3,13.5-35.3s29.3,0,35.3,13.5\n    L82,35.7z\"\n        >\n          <animateTransform\n            attributeName=\"transform\"\n            attributeType=\"XML\"\n            type=\"rotate\"\n            dur=\"2s\"\n            from=\"0 50 50\"\n            to=\"360 50 50\"\n            repeatCount=\"indefinite\"\n          />\n        </path>\n      </svg>\n    </animated.div>\n  );\n};\n\nexport default Loader;\n","import PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/styles';\nimport React, { useMemo, useCallback, useState } from 'react';\n\nimport Menu from '@material-ui/core/Menu';\nimport Button from '@material-ui/core/Button';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ArrowDropUpIcon from '@material-ui/icons/ArrowDropUp';\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\nimport { useRef } from 'react';\nimport { useEffect } from 'react';\n\nconst noop = () => {};\n\nconst useStyles = makeStyles((theme) => ({\n  root: (props) => ({\n    position: 'relative',\n  }),\n  arrowIcon: (props) => ({\n    marginLeft: theme.spacing(1),\n  }),\n  tooltip: (props) => ({\n    position: 'relative',\n    margin: 0,\n  }),\n  arrow: (props) => ({\n    position: 'absolute',\n    fontSize: 6,\n    '&::before': {\n      content: '\"\"',\n      margin: 'auto',\n      display: 'block',\n      width: 0,\n      height: 0,\n      borderStyle: 'solid',\n    },\n  }),\n  paper: {\n    border: '1px solid #d3d4d5',\n  },\n  popper: (props) => ({\n    '&[x-placement*=\"bottom\"] $arrow': {\n      top: 0,\n      left: 0,\n      marginTop: '-0.95em',\n      width: '2em',\n      height: '1em',\n      '&::before': {\n        borderWidth: '0 1em 1em 1em',\n        borderColor: `transparent transparent ${theme.palette.grey[700]} transparent`,\n      },\n    },\n    '&[x-placement*=\"top\"] $arrow': {\n      bottom: 0,\n      left: 0,\n      marginBottom: '-0.95em',\n      width: '2em',\n      height: '1em',\n      '&::before': {\n        borderWidth: '1em 1em 0 1em',\n        borderColor: `${theme.palette.grey[700]} transparent transparent transparent`,\n      },\n    },\n    '&[x-placement*=\"right\"] $arrow': {\n      left: 0,\n      marginLeft: '-0.95em',\n      height: '2em',\n      width: '1em',\n      '&::before': {\n        borderWidth: '1em 1em 1em 0',\n        borderColor: `transparent ${theme.palette.grey[700]} transparent transparent`,\n      },\n    },\n    '&[x-placement*=\"left\"] $arrow': {\n      right: 0,\n      marginRight: '-0.95em',\n      height: '2em',\n      width: '1em',\n      '&::before': {\n        borderWidth: '1em 0 1em 1em',\n        borderColor: `transparent transparent transparent ${theme.palette.grey[700]}`,\n      },\n    },\n  }),\n}));\n\nconst SelectAndCheck = (props) => {\n  const classes = useStyles(props);\n  const id = useMemo(Math.random, []);\n\n  const isMountedRef = useRef();\n  const [anchorEl, setAnchorEl] = useState(null);\n  const [arrowRef, setArrowRef] = useState(null);\n\n  useEffect(() => {\n    isMountedRef.current = true;\n\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n\n  const handleClickSelect = useCallback((event) => {\n    if (isMountedRef.current) setAnchorEl(event.currentTarget);\n  }, []);\n\n  const closeSelect = useCallback(() => {\n    if (isMountedRef.current) setAnchorEl(null);\n  }, []);\n\n  const handleCloseSelect = useCallback(async () => {\n    const keepOpen = await (props.onClose || noop)();\n\n    if (keepOpen !== true) {\n      closeSelect();\n    }\n  }, [closeSelect, props.onClose]);\n\n  const handleClickCheckbox = useCallback(\n    (event) => {\n      (props.onClickCheckbox || noop)(event.target.value, handleCloseSelect);\n    },\n    [props.onClickCheckbox, handleCloseSelect],\n  );\n\n  const handleClickSelectItem = useCallback(\n    (value) => async (event) => {\n      if (event.target.type === 'checkbox') {\n        return;\n      }\n\n      const keepOpen = await (props.onSelect || noop)(value);\n\n      if (keepOpen !== true) {\n        handleCloseSelect();\n      }\n    },\n    [handleCloseSelect, props.onSelect],\n  );\n\n  const open = !!anchorEl;\n\n  return (\n    <div className={classes.root}>\n      <Button\n        disableRipple\n        variant=\"outlined\"\n        aria-haspopup=\"true\"\n        className={classes.button}\n        onClick={handleClickSelect}\n        aria-controls={`select-and-check-${id}`}\n        {...props.SelectProps}\n      >\n        {open ? props.activeTitle || props.title : props.title}\n        {open ? (\n          <ArrowDropUpIcon className={classes.arrowIcon} />\n        ) : (\n          <ArrowDropDownIcon className={classes.arrowIcon} />\n        )}\n      </Button>\n      <Menu\n        keepMounted\n        open={open}\n        elevation={0}\n        anchorEl={anchorEl}\n        getContentAnchorEl={null}\n        onClose={handleCloseSelect}\n        id={`select-and-check-${id}`}\n        classes={{ paper: classes.paper }}\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n        transformOrigin={{ vertical: 'top', horizontal: 'center' }}\n        {...props.MenuProps}\n      >\n        {props.options?.map(\n          ({ key, value, text, selected, tooltipTitle, checked, checkboxValue }, i) => {\n            let TooltipAndCheckbox = null;\n\n            if (typeof checked === 'boolean') {\n              const _Checkbox = (\n                <Checkbox\n                  checked={checked}\n                  onClick={handleClickCheckbox}\n                  value={checkboxValue === undefined ? value : checkboxValue}\n                />\n              );\n              const tooltipText = tooltipTitle || props.tooltipTitle;\n\n              TooltipAndCheckbox = tooltipText ? (\n                <Tooltip\n                  classes={{ tooltip: classes.tooltip, popper: classes.popper }}\n                  PopperProps={{\n                    popperOptions: {\n                      modifiers: {\n                        arrow: {\n                          enabled: !!arrowRef,\n                          element: arrowRef,\n                        },\n                      },\n                    },\n                  }}\n                  title={\n                    <React.Fragment>\n                      {tooltipText}\n                      <span className={classes.arrow} ref={setArrowRef} />\n                    </React.Fragment>\n                  }\n                  enterDelay={props.tooltipEnterDelay === undefined ? 750 : props.tooltipEnterDelay}\n                  leaveDelay={props.tooltipLeaveDelay || 0}\n                  aria-label=\"checkbox\"\n                  placement={props.tooltipPlacement || 'top'}\n                >\n                  {_Checkbox}\n                </Tooltip>\n              ) : (\n                _Checkbox\n              );\n            }\n\n            return (\n              <MenuItem\n                key={key || i}\n                onClick={handleClickSelectItem(value)}\n                selected={selected}\n                {...props.MenuItemProps}\n              >\n                {TooltipAndCheckbox}\n                <ListItemText primary={text || value?.toString()} />\n              </MenuItem>\n            );\n          },\n        )}\n      </Menu>\n    </div>\n  );\n};\n\nSelectAndCheck.propTypes = {\n  styles: PropTypes.object,\n  onClose: PropTypes.func,\n  title: PropTypes.string,\n  onSelect: PropTypes.func,\n  MenuProps: PropTypes.object,\n  SelectProps: PropTypes.object,\n  activeTitle: PropTypes.string,\n  tooltipTitle: PropTypes.string,\n  MenuItemProps: PropTypes.object,\n  onClickCheckbox: PropTypes.func,\n  tooltipEnterDelay: PropTypes.number,\n  tooltipLeaveDelay: PropTypes.number,\n  tooltipPlacement: PropTypes.string,\n  options: PropTypes.arrayOf(PropTypes.object).isRequired,\n};\n\nexport default SelectAndCheck;\n","import PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/styles';\nimport React, { useMemo, useCallback } from 'react';\n\nimport SelectAndCheck from './SelectAndCheck';\nimport { useWebcam } from '../context/webcam';\n\nconst useStyles = makeStyles((theme) => ({\n  root: (props) => ({}),\n}));\n\nconst WebcamSelect = (props) => {\n  const webcam = useWebcam();\n  const classes = useStyles({ ...props, ...webcam });\n\n  const selectedCamera = useMemo(() => {\n    let _selectedCamera = { deviceId: null, label: null, none: true };\n\n    if (!webcam.currentDeviceId) {\n      return _selectedCamera;\n    }\n\n    webcam.cameras.some((camera) => {\n      if (camera.deviceId === webcam.currentDeviceId) {\n        _selectedCamera = camera;\n\n        return true;\n      }\n\n      return false;\n    });\n\n    return _selectedCamera;\n  }, [webcam.cameras, webcam.currentDeviceId]);\n\n  const handleSelectCamera = useCallback(\n    (deviceId) => {\n      if (webcam.currentDeviceId !== deviceId) {\n        webcam.startVideo({ deviceId });\n      }\n    },\n    [webcam],\n  );\n\n  const handleSetDefaultCamera = useCallback(\n    (deviceId) => {\n      if (webcam.autoStartDeviceId === deviceId) {\n        webcam.clearAutoStartDeviceId();\n      } else {\n        webcam.setAutoStartDeviceId(deviceId);\n        handleSelectCamera(deviceId);\n      }\n    },\n    [webcam, handleSelectCamera],\n  );\n\n  return (\n    <div className={classes.root}>\n      <SelectAndCheck\n        activeTitle=\"Select Camera\"\n        title={\n          webcam.cameras?.length\n            ? selectedCamera.label || 'No Camera Selected'\n            : 'No Cameras Detected'\n        }\n        onSelect={handleSelectCamera}\n        onClickCheckbox={handleSetDefaultCamera}\n        options={webcam.cameras.map((camera) => ({\n          key: camera.label,\n          value: camera.deviceId,\n          text: camera.label || 'Unknown Device',\n          selected: camera.deviceId === webcam.currentDeviceId,\n          checked: webcam.autoStartDeviceId === camera.deviceId,\n          tooltipTitle:\n            webcam.autoStartDeviceId === camera.deviceId ? 'Remove Default' : 'Set Default',\n        }))}\n      />\n    </div>\n  );\n};\n\nWebcamSelect.propTypes = {\n  styles: PropTypes.object,\n};\n\nexport default WebcamSelect;\n","import React from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport Typography from '@material-ui/core/Typography';\n\nimport WebcamSelect from './WebcamSelect';\n\nimport { Paper } from '@material-ui/core';\nimport { useSpring, config, animated } from 'react-spring';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'absolute',\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  paper: {\n    padding: theme.spacing(2),\n    borderRadius: theme.spacing(1),\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    textAlign: 'center',\n    '& h1': {\n      marginBottom: theme.spacing(2),\n    },\n    '& p': {\n      marginBottom: theme.spacing(1),\n    },\n  },\n}));\n\nconst PermissionNeeded = (props) => {\n  const classes = useStyles(props);\n\n  const slideProps = useSpring({\n    transform: 'translate3d(0,0px,0)',\n    from: { transform: 'translate3d(0,-500px,0)' },\n    config: config.slow,\n  });\n\n  const fadeProps = useSpring({\n    to: { opacity: props.permissionDenied ? 1 : 0 },\n    config: config.wobbly,\n  });\n\n  return (\n    <div className={classes.root}>\n      <animated.div style={slideProps}>\n        <Paper elevation={4} className={classes.paper}>\n          <div className={classes.container}>\n            {!props.permissionDenied ? (\n              <>\n                <Typography component=\"h1\" variant=\"h6\">\n                  In order to play the game, you must grant permission to access your webcam.\n                </Typography>\n                <Typography component=\"p\">Please select a camera.</Typography>\n                <WebcamSelect />\n              </>\n            ) : (\n              <animated.div style={fadeProps}>\n                <Typography component=\"h1\" variant=\"h6\">\n                  It looks like you have denied webcam access.\n                </Typography>\n                <Typography component=\"p\">\n                  Please take a look at{' '}\n                  <a\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    href=\"https://support.google.com/chrome/answer/2693767\"\n                  >\n                    this article\n                  </a>{' '}\n                  in order to enable access.\n                </Typography>\n                <Typography component=\"p\">\n                  Once your webcam has been enabled, return here to play the game!\n                </Typography>\n              </animated.div>\n            )}\n          </div>\n        </Paper>\n      </animated.div>\n    </div>\n  );\n};\n\nPermissionNeeded.propTypes = {};\n\nexport default PermissionNeeded;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Paper from '@material-ui/core/Paper';\nimport { makeStyles } from '@material-ui/styles';\nimport IconButton from '@material-ui/core/IconButton';\nimport { useSpring, animated, config } from 'react-spring';\nimport EnterFullScreen from '@material-ui/icons/Fullscreen';\nimport ExitFullScreen from '@material-ui/icons/FullscreenExit';\n\nimport { maxWidth } from '../lib/constants';\nimport { useWebcam } from '../context/webcam';\n\nimport Loader from './Loader';\nimport PermissionNeeded from './PermissionNeeded';\n\nconst useStyles = makeStyles((theme) => ({\n  root: ({ isFullScreen: fs }) => ({\n    maxWidth,\n    margin: '0 auto',\n    position: 'relative',\n    height: `calc(0.5625 * (100vw - ${theme.spacing(4)}px))`,\n    [`@media(min-width: ${maxWidth}px)`]: {\n      height: fs ? '100%' : `calc(0.5625 * (${maxWidth}px - ${theme.spacing(4)}px))`,\n    },\n    ...(fs\n      ? {\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }\n      : {}),\n  }),\n  container: ({ isFullScreen: fs }) => ({\n    width: '100%',\n    position: 'relative',\n    paddingLeft: fs ? 0 : theme.spacing(2),\n    paddingRight: fs ? 0 : theme.spacing(2),\n  }),\n  video: ({ flipX, isFullScreen: fs }) => ({\n    width: '100%',\n    height: '100%',\n    borderRadius: fs ? 0 : theme.spacing(1),\n    ...(flipX\n      ? {\n          'p-webkit-transform': 'scaleX(- 1)',\n          transform: 'scaleX(-1)',\n        }\n      : {}),\n  }),\n  canvas: ({ isFullScreen: fs }) => ({\n    borderRadius: fs ? 0 : theme.spacing(1),\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    paddingLeft: fs ? 0 : theme.spacing(2),\n    paddingRight: fs ? 0 : theme.spacing(2),\n  }),\n  children: ({ isFullScreen: fs }) => ({\n    borderRadius: fs ? 0 : theme.spacing(1),\n    overflow: 'hidden',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    bottom: 5,\n    zIndex: 1,\n    paddingLeft: fs ? 0 : theme.spacing(2),\n    paddingRight: fs ? 0 : theme.spacing(2),\n  }),\n  fullScreen: {\n    position: 'absolute',\n    bottom: theme.spacing(1.5),\n    right: ({ isFullScreen: fs }) => theme.spacing(fs ? 1.5 : 3),\n    zIndex: 20,\n    '&:hover': {\n      background: 'rgba(255,255,255,0.25)',\n    },\n  },\n  overlay: ({ overlayColor, isFullScreen }) => ({\n    background: overlayColor,\n    position: 'absolute',\n    top: 0,\n    bottom: 5,\n    left: isFullScreen ? 0 : theme.spacing(2),\n    right: isFullScreen ? 0 : theme.spacing(2),\n    borderRadius: isFullScreen ? 0 : theme.spacing(1),\n    zIndex: 0,\n  }),\n  loader: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: 0,\n    width: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    '& > div': {\n      width: 100,\n      height: 100,\n    },\n  },\n  paper: {\n    top: 0,\n    bottom: 5,\n    zIndex: -1,\n    position: 'absolute',\n    left: theme.spacing(2),\n    right: theme.spacing(2),\n    borderRadius: theme.spacing(1),\n  },\n}));\n\nconst Webcam = ({ overlay, ...props }) => {\n  const webcam = useWebcam();\n  const overlayColor = typeof overlay !== 'string' ? 'rgba(255,255,255,0.5)' : overlay;\n  const classes = useStyles({ ...props, ...webcam, overlayColor });\n\n  const styleProps = useSpring({ to: { opacity: !webcam.hidden ? 1 : 0 }, config: config.stiff });\n\n  return (\n    <div ref={webcam.rootRef} className={classes.root}>\n      <animated.div style={styleProps} className={classes.container}>\n        <>\n          <video\n            autoPlay={true}\n            ref={webcam.videoRef}\n            className={classes.video}\n            width={webcam.videoRef?.current?.videoWidth}\n            height={webcam.videoRef?.current?.videoHeight}\n          />\n          <canvas\n            ref={webcam.canvasRef}\n            className={classes.canvas}\n            width={webcam.videoRef?.current?.videoWidth}\n            height={webcam.videoRef?.current?.videoHeight}\n          />\n          {!webcam.hidden && overlay && <div className={classes.overlay} />}\n          {props.children && !webcam.hidden && (\n            <div className={classes.children}>{props.children}</div>\n          )}\n          {webcam.hasFullScreen && (\n            <IconButton\n              color=\"secondary\"\n              className={classes.fullScreen}\n              onClick={webcam.toggleFullScreen}\n            >\n              {webcam.isFullScreen ? (\n                <ExitFullScreen color=\"secondary\" />\n              ) : (\n                <EnterFullScreen color=\"secondary\" />\n              )}\n            </IconButton>\n          )}\n        </>\n        {!webcam.isFullScreen && <Paper elevation={4} className={classes.paper} />}\n      </animated.div>\n      {webcam.permissionNeeded ? (\n        <PermissionNeeded permissionDenied={webcam.permissionDenied} />\n      ) : (\n        webcam.hidden && (\n          <div className={classes.loader}>\n            <div>\n              <Loader color=\"#000\" />\n            </div>\n          </div>\n        )\n      )}\n    </div>\n  );\n};\n\nWebcam.propTypes = {\n  styles: PropTypes.object,\n};\n\nexport default Webcam;\n","export const maxWidth = 1100;\n\nexport const numShippedMasks = 3;\n\nexport const DEBUG = process.env.NODE_ENV !== 'production';\n","import { useCallback } from 'react';\n\nfunction makeSound(src) {\n  // Create a instance of AudioContext interface\n  window.AudioContext = window.AudioContext || window.webkitAudioContext || window.mozAudioContext;\n  var context = new AudioContext();\n  const source = context.createBufferSource();\n\n  var myRequest = new Request(src);\n\n  return fetch(myRequest)\n    .then(function (response) {\n      return response.arrayBuffer();\n    })\n    .then(function (buffer) {\n      context.decodeAudioData(buffer, function (decodedData) {\n        source.buffer = decodedData;\n        source.connect(context.destination);\n      });\n      return source.start(0);\n    });\n}\n\nexport const useSfx = (audioRef) => {\n  if (!audioRef) {\n    throw new Error('audioRef is required when calling useSfx');\n  }\n\n  const play = useCallback(\n    (soundName) => {\n      if (!audioRef.current) return;\n      return makeSound(soundName);\n    },\n    [audioRef],\n  );\n\n  const playSuccessSound = useCallback(\n    () => play(process.env.PUBLIC_URL + '/sounds/metallic_clank.ogg'),\n    [play],\n  );\n\n  const playFailureSound = useCallback(\n    () => play(process.env.PUBLIC_URL + '/sounds/glass_shatter.ogg'),\n    [play],\n  );\n\n  const playCameraSound = useCallback(() => play(process.env.PUBLIC_URL + '/sounds/camera.ogg'), [\n    play,\n  ]);\n\n  return { playSuccessSound, playFailureSound, playCameraSound };\n};\n","import { useState, useEffect, useCallback } from 'react';\n\nconst synth = window.speechSynthesis;\n\nexport const useSpeech = (audioRef) => {\n  if (!audioRef) {\n    throw new Error('audioRef is required when calling useSpeech');\n  }\n\n  const [voices, setVoices] = useState(null);\n  const [voice, setVoice] = useState(null);\n\n  useEffect(() => {\n    if (!voices) {\n      const allVoices = synth.getVoices();\n      setVoices(allVoices);\n      setVoice(allVoices[0]);\n    }\n  }, [voices]);\n\n  const say = useCallback(\n    (text) => {\n      if (!audioRef.current) return;\n\n      const utterance = new SpeechSynthesisUtterance(text);\n      utterance.voice = voice;\n      synth.speak(utterance);\n    },\n    [voice, audioRef],\n  );\n\n  const countdown = useCallback(\n    (from, { onEnd, onEach } = {}) => {\n      if (onEnd) setTimeout(onEnd, from * 1000);\n      Array.from({ length: from }).forEach((_, idx) => {\n        const num = from - idx;\n        setTimeout(() => {\n          say(num);\n          if (onEach) onEach(num);\n        }, idx * 1000);\n      });\n    },\n    [say],\n  );\n\n  return { say, countdown };\n};\n","import { useMemo, useRef, useState, useEffect, useCallback } from 'react';\nimport { useSfx } from './sfx';\nimport { useSpeech } from './speech';\n\nconst LS_AUDIO = '__audio_muted__';\n\nexport const useAudioController = () => {\n  const audioRef = useRef(true);\n  const [audioState, setAudioState] = useState(true);\n\n  const speech = useSpeech(audioRef);\n  const sfx = useSfx(audioRef);\n\n  useEffect(() => {\n    const muteAudio = localStorage.getItem(LS_AUDIO);\n\n    if (muteAudio) {\n      setAudioState(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (audioState && !audioRef.current) {\n      audioRef.current = true;\n      localStorage.removeItem(LS_AUDIO);\n    } else if (!audioState && audioRef.current) {\n      audioRef.current = false;\n      localStorage.setItem(LS_AUDIO, 'true');\n    }\n  }, [audioState]);\n\n  const toggle = useCallback(() => {\n    setAudioState((state) => !state);\n  }, []);\n\n  const audio = useMemo(\n    () => ({\n      state: audioState,\n      stateRef: audioRef,\n      handlers: { toggle, speech, sfx },\n    }),\n    [audioState, toggle, speech, sfx],\n  );\n\n  return audio;\n};\n","import React, { useContext, createContext } from 'react';\n\nimport { useAudioController } from '../hooks/audioController';\n\nexport const audioContext = createContext();\n\nexport const useAudio = () => {\n  const state = useContext(audioContext);\n\n  if (state === undefined) {\n    throw new Error('useAudio must be used within a AudioProvider');\n  }\n\n  return state;\n};\n\nconst AudioProvider = ({ children }) => {\n  const context = useAudioController();\n\n  return <audioContext.Provider value={context}>{children}</audioContext.Provider>;\n};\n\nexport default AudioProvider;\n","export const screenTypes = {\n  SET_SCREEN: 'set_screen',\n  SET_PLAYER_MODE: 'set_player_mode',\n  SET_GAME_MODE: 'set_game_mode',\n  REVERSE: 'reverse_state',\n  RESET: 'reset_state',\n};\n\nconst SINGLE_PLAYER = 'Single Player';\nconst MULTIPLAYER = 'Multi Player';\n\nexport const screenStates = {\n  screen: {\n    DEFAULT: 'start',\n    PLAY: 'play',\n  },\n  players: {\n    SINGLE_PLAYER,\n    MULTIPLAYER,\n    DEFAULT: null,\n  },\n  mode: {\n    [SINGLE_PLAYER]: {\n      PRACTICE: 'Practice',\n      SURVIVAL: 'Survival',\n      TIME_ATTACK: 'Time Attack',\n    },\n    [MULTIPLAYER]: {\n      LOCAL: 'Multiplayer',\n      REMOTE: 'Remote Multiplayer',\n    },\n    DEFAULT: null,\n  },\n};\n\n// identifies these values as works in progress, ie disabled buttons\nexport const wipScreens = [screenStates.mode[MULTIPLAYER].REMOTE].reduce(\n  (acc, item) => ({ ...acc, [item]: !!1 }),\n  {},\n);\n\nexport const screenStatesArrays = Object.entries(screenStates).reduce(\n  (acc, [stateKey, statesObj]) => ({\n    ...acc,\n    [stateKey]:\n      stateKey !== 'mode'\n        ? Object.values(statesObj).filter((_) => _)\n        : Object.entries(statesObj).reduce(\n            (modeAcc, [playerModeKey, playerModesObj]) => ({\n              ...modeAcc,\n              [playerModeKey]: playerModesObj === null ? null : Object.values(playerModesObj), // check for the default: null thing and get rid of it\n            }),\n            {},\n          ),\n  }),\n  {},\n);\n\nexport const initialScreenState = {\n  screen: screenStates.screen.DEFAULT,\n  mode: screenStates.mode.DEFAULT,\n  players: screenStates.players.DEFAULT,\n};\n","import PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport React, { memo, useState, useCallback } from 'react';\nimport Dialog from '@material-ui/core/Dialog';\nimport { makeStyles } from '@material-ui/styles';\nimport { withStyles } from '@material-ui/core/styles';\nimport HomeIcon from '@material-ui/icons/Home';\nimport BackIcon from '@material-ui/icons/ArrowLeft';\nimport IconButton from '@material-ui/core/IconButton';\nimport VolumeUpIcon from '@material-ui/icons/VolumeUp';\nimport VolumeOffIcon from '@material-ui/icons/VolumeOff';\n\nimport WebcamSelect from './WebcamSelect';\nimport { useAudio } from '../context/audio';\nimport { screenStates } from '../lib/screenConstants';\nimport { maxWidth } from '../lib/constants';\nimport { useSpring, config, animated } from 'react-spring';\n\nimport MuiDialogTitle from '@material-ui/core/DialogTitle';\nimport MuiDialogContent from '@material-ui/core/DialogContent';\nimport CloseIcon from '@material-ui/icons/Close';\nimport Typography from '@material-ui/core/Typography';\nimport stickImage from '../images/stick_figure_in_box.png';\n\nconst useStyles = makeStyles((theme) => ({\n  btn: {\n    border: '2px solid grey',\n  },\n  back: {\n    marginLeft: theme.spacing(2),\n  },\n  options: {\n    marginTop: theme.spacing(2),\n    paddingLeft: theme.spacing(2),\n    paddingRight: theme.spacing(2),\n    width: '100%',\n    maxWidth,\n    display: 'flex',\n    margin: '0 auto',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  right: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  volume: {\n    marginLeft: theme.spacing(1),\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500],\n  },\n  info: {\n    marginLeft: theme.spacing(2),\n    width: '34px',\n    height: '34px',\n  },\n  stickImage: {\n    width: '100%',\n  },\n}));\n\nconst styles = (theme) => ({\n  root: {\n    margin: 0,\n    padding: theme.spacing(2),\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500],\n  },\n});\n\nconst DialogTitle = withStyles(styles)((props) => {\n  const { children, classes, onClose, ...other } = props;\n  return (\n    <MuiDialogTitle disableTypography className={classes.root} {...other}>\n      <Typography variant=\"h6\">{children}</Typography>\n      {onClose ? (\n        <IconButton aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      ) : null}\n    </MuiDialogTitle>\n  );\n});\n\nconst DialogContent = withStyles((theme) => ({\n  root: {\n    padding: theme.spacing(2),\n    textAlign: 'center',\n  },\n}))(MuiDialogContent);\n\nconst GlobalHeader = (props) => {\n  const classes = useStyles();\n  const audio = useAudio();\n  const [open, setOpen] = useState(false);\n\n  const handleClose = useCallback(() => {\n    setOpen(false);\n    props.tutorial.markTutorialCompleted();\n  }, [props.tutorial]);\n\n  const onHomeScreen = props.screen === screenStates.screen.DEFAULT;\n  const styleProps = useSpring({ to: { opacity: !onHomeScreen ? 1 : 0 }, config: config.stiff });\n\n  return (\n    <div className={classes.options}>\n      <div>\n        {!onHomeScreen && (\n          <animated.div style={styleProps}>\n            <IconButton className={classes.btn} size=\"small\" onClick={props.goHome}>\n              <HomeIcon />\n            </IconButton>\n            <IconButton\n              size=\"small\"\n              className={classnames(classes.btn, classes.back)}\n              onClick={\n                props.players === screenStates.players.MULTIPLAYER ? props.goHome : props.goBack\n              }\n            >\n              <BackIcon />\n            </IconButton>\n            <IconButton\n              size=\"small\"\n              className={classnames(classes.btn, classes.info)}\n              onClick={() => {\n                setOpen(true);\n              }}\n            >\n              <b>i</b>\n            </IconButton>\n            <Dialog\n              onClose={handleClose}\n              aria-labelledby=\"customized-dialog-title\"\n              open={open || !props.tutorial.completed}\n            >\n              <DialogTitle id=\"customized-dialog-title\" onClose={handleClose}>\n                Set Up\n              </DialogTitle>\n              <DialogContent dividers>\n                <Typography gutterBottom>\n                  Place your webcam at a distance and ensure there is enough space around you to\n                  move safely.\n                </Typography>\n                <img src={stickImage} className={classes.stickImage} alt=\"Stick Figure\" />\n              </DialogContent>\n            </Dialog>\n          </animated.div>\n        )}\n      </div>\n      <div className={classes.right}>\n        <WebcamSelect />\n        <IconButton className={classes.volume} size=\"small\" onClick={audio.handlers.toggle}>\n          {audio.state ? <VolumeUpIcon /> : <VolumeOffIcon />}\n        </IconButton>\n      </div>\n    </div>\n  );\n};\n\nGlobalHeader.propTypes = {\n  mode: PropTypes.string,\n  screen: PropTypes.string,\n  goHome: PropTypes.func.isRequired,\n  goBack: PropTypes.func.isRequired,\n  tutorial: PropTypes.object.isRequired,\n};\n\nexport default memo(GlobalHeader);\n","import React from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport { Typography } from '@material-ui/core';\nimport { useGame } from '../components/Game';\nimport { useWebcam } from '../context/webcam';\nimport { animated, config, useSpring } from 'react-spring';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    marginLeft: theme.spacing(2),\n  },\n  heading: {\n    marginBottom: theme.spacing(1),\n  },\n}));\n\nconst DefaultHeader = (props) => {\n  const classes = useStyles();\n  const webcam = useWebcam();\n\n  const game = useGame();\n\n  const styleProps = useSpring({ to: { opacity: !webcam.hidden ? 1 : 0 }, config: config.stiff });\n\n  const text = webcam.hidden\n    ? ''\n    : game?.screen?.state?.mode ||\n      (game?.screen?.state?.screen === 'play' ? 'Choose Mode' : 'Select Players');\n\n  return (\n    <header className={classes.root}>\n      <Typography component=\"h1\" variant=\"h6\" className={classes.heading}>\n        <animated.div style={styleProps}>{text}</animated.div>\n      </Typography>\n    </header>\n  );\n};\n\nDefaultHeader.propTypes = {};\n\nexport default DefaultHeader;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/styles';\n\nimport DefaultHeader from '../DefaultHeader';\nimport { screenStates } from '../../lib/screenConstants';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    marginTop: theme.spacing(2),\n  },\n}));\n\nconst Headers = {\n  [screenStates.screen.DEFAULT]: {\n    [screenStates.players.DEFAULT]: null,\n  },\n  [screenStates.screen.PLAY]: {\n    [screenStates.players.SINGLE_PLAYER]: null,\n    [screenStates.players.MULTIPLAYER]: null,\n  },\n};\n\nconst ScreenHeader = (props) => {\n  const classes = useStyles();\n\n  const { screen, players } = props.screenState;\n\n  const HeaderContent = Headers[screen]?.[players] || DefaultHeader;\n\n  return (\n    <header className={classes.root}>\n      <HeaderContent />\n    </header>\n  );\n};\n\nScreenHeader.propTypes = {\n  screenState: PropTypes.object.isRequired,\n};\n\nexport default ScreenHeader;\n","const Null = () => null;\n\nexport default Null;\n","import hexToRGB from 'hex-rgb';\n\nexport const rawScoreToTenBinScore = (score) => {\n  // Takes in score from [0-100] and returns score [1-10]\n  const lowThresh = 25;\n  const highThresh = 88;\n  const p = (score - lowThresh) / (highThresh - lowThresh);\n  return Math.max(1, Math.min(10, Math.round(p * 10)));\n};\n\nexport const tenBinScoreToPercent = (score) => {\n  // Returns a percent value between [0.0, 100.0]\n  score = Math.min(Math.max(score, 0), 10);\n  return (score / 10) * 100;\n};\n\nexport const scoreToColor = (score, alpha) => {\n  // Returns a hex color value from reg to green based on score from 0-100\n  // Using from: https://gist.github.com/mlocati/7210513\n  var r,\n    g,\n    b = 0;\n  if (score < 50) {\n    r = 255;\n    g = Math.round(5.1 * score);\n  } else {\n    g = 255;\n    r = Math.round(510 - 5.1 * score);\n  }\n  var h = r * 0x10000 + g * 0x100 + b * 0x1;\n  const hex = '#' + ('000000' + h.toString(16)).slice(-6);\n\n  if (alpha) {\n    try {\n      const { red, green, blue } = hexToRGB(hex);\n      return `rgba(${red}, ${green}, ${blue}, ${alpha})`;\n    } catch (e) {\n      console.error(e, { score, alpha, hex });\n      return 'rgba(255, 255, 255, 0)';\n    }\n  }\n\n  return hex;\n};\n\nexport const tenBinScoreToColor = (score, alpha) =>\n  scoreToColor(tenBinScoreToPercent(score), alpha);\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/core';\n\nimport Paper from '@material-ui/core/Paper';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\n\nimport CloseIcon from '@material-ui/icons/Close';\n\nconst useStyles = makeStyles((theme) => ({\n  masks: {\n    padding: theme.spacing(2),\n    background: 'rgba(255,255,255,0.5)',\n  },\n  masksHeader: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  masksList: {\n    display: 'flex',\n    flexFlow: 'row wrap',\n    justifyContent: 'space-around',\n  },\n  maskContainer: {\n    marginTop: theme.spacing(2),\n  },\n  imgContainer: {\n    width: 200,\n    position: 'relative',\n    border: '1px solid grey',\n    padding: theme.spacing(0.5),\n    borderRadius: theme.spacing(1),\n    '&:hover': {\n      '& > div': {\n        background: 'rgba(255,0,0,0.65)',\n      },\n    },\n  },\n  img: {\n    width: '100%',\n    background: 'rgba(0,0,0,0)',\n  },\n  removeMask: {\n    top: 0,\n    left: 0,\n    bottom: 0,\n    width: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    position: 'absolute',\n    transition: 'all 100ms',\n    justifyContent: 'center',\n    '&:hover': {\n      '& > button': {\n        display: 'inherit',\n      },\n    },\n  },\n  iconBtn: {\n    display: 'none',\n    color: 'black',\n    backgroundColor: 'rgba(255,255,255,0.5)',\n    '&:hover': {\n      backgroundColor: 'rgba(255,255,255,0.75)',\n    },\n    '&:active, &:focused': {\n      backgroundColor: 'rgba(255,255,255,0.9)',\n    },\n  },\n  actions: {\n    '& > button': {\n      marginRight: theme.spacing(1),\n      '& :last-of-type': {\n        marginRight: 0,\n      },\n    },\n  },\n}));\n\nconst MasksGrid = (props) => {\n  const classes = useStyles();\n\n  const {\n    masks,\n    onClose,\n    title,\n    actions,\n    actionButtons,\n    getDataUri,\n    getImageChild,\n    getPaperProps,\n    PaperProps = {},\n  } = props;\n\n  return (\n    !!masks?.length && (\n      <Paper className={classes.masks} elevation={4}>\n        <div className={classes.masksHeader}>\n          {typeof title === 'string' ? (\n            <Typography variant=\"h6\" component=\"h3\">\n              {title}\n            </Typography>\n          ) : (\n            title || null\n          )}\n          {actions || actionButtons ? (\n            <div className={classes.actions}>\n              {actionButtons.map(({ Icon, onClick, key }) => (\n                <IconButton key={key} size=\"small\" onClick={onClick}>\n                  <Icon />\n                </IconButton>\n              ))}\n            </div>\n          ) : (\n            onClose && (\n              <div className={classes.actions}>\n                <IconButton size=\"small\" onClick={onClose}>\n                  <CloseIcon />\n                </IconButton>\n              </div>\n            )\n          )}\n        </div>\n        <ul className={classes.masksList}>\n          {masks.map((maskItem, i) => {\n            const dataUri = getDataUri ? getDataUri(maskItem) : maskItem;\n            const paperProps = getPaperProps ? getPaperProps(maskItem, i, masks) : {};\n\n            return (\n              <li key={dataUri} className={classes.maskContainer}>\n                <Paper\n                  elevation={4}\n                  className={classes.imgContainer}\n                  {...PaperProps}\n                  {...paperProps}\n                >\n                  {getImageChild && getImageChild(maskItem, i)}\n                  <img src={dataUri} className={classes.img} alt={`mask #${i}`} />\n                </Paper>\n              </li>\n            );\n          })}\n        </ul>\n      </Paper>\n    )\n  );\n};\n\nMasksGrid.propTypes = {\n  title: PropTypes.node,\n  masks: PropTypes.array,\n  actions: PropTypes.node,\n  onClose: PropTypes.func,\n  getDataUri: PropTypes.func,\n  PaperProps: PropTypes.object,\n  getPaperProps: PropTypes.func,\n  getImageChild: PropTypes.func,\n  actionButtons: PropTypes.array,\n};\n\nexport default MasksGrid;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/core';\n\nimport Typography from '@material-ui/core/Typography';\n\nimport { tenBinScoreToColor } from '../lib/score';\nimport { useMemo } from 'react';\nimport MasksGrid from './MasksGrid';\nimport { useCallback } from 'react';\n\nconst useStyles = makeStyles((theme) => ({\n  score: {\n    textAlign: 'right',\n    paddingRight: theme.spacing(1),\n  },\n}));\n\nconst ScoreResults = ({ results, handleClose, label, ...props }) => {\n  const classes = useStyles();\n\n  const title = useMemo(() => {\n    const gameScoreAverage = results.reduce((acc, { score }) => acc + score, 0) / results.length;\n    const fixedGameScore = gameScoreAverage.toFixed(1);\n    const title = (\n      <Typography variant=\"h6\" component=\"h3\">\n        {label ? label : <>Round Score: {fixedGameScore}</>}\n      </Typography>\n    );\n\n    return title;\n  }, [results, label]);\n\n  const getDataUri = useCallback(({ dataUri }) => dataUri, []);\n  const getPaperProps = useCallback(\n    ({ score }) => ({ style: { background: tenBinScoreToColor(score, 0.4) } }),\n    [],\n  );\n  const getImageChild = useCallback(\n    ({ score }) => <Typography className={classes.score}>{score}</Typography>,\n    [classes.score],\n  );\n\n  return (\n    <MasksGrid\n      title={title}\n      masks={results}\n      onClose={handleClose}\n      getDataUri={getDataUri}\n      getPaperProps={getPaperProps}\n      getImageChild={getImageChild}\n      {...props}\n    />\n  );\n};\n\nScoreResults.propTypes = {\n  label: PropTypes.string,\n  handleClose: PropTypes.func,\n  results: PropTypes.array.isRequired,\n};\n\nexport default ScoreResults;\n","import PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/core';\nimport React, { useMemo, useCallback } from 'react';\n\nimport CloseIcon from '@material-ui/icons/Close';\nimport IconButton from '@material-ui/core/IconButton';\nimport PlayIcon from '@material-ui/icons/PlayCircleOutline';\nimport DownloadIcon from '@material-ui/icons/CloudDownload';\nimport DeleteForeverIcon from '@material-ui/icons/DeleteForever';\n\nimport MasksGrid from './MasksGrid';\n\nconst useStyles = makeStyles((theme) => ({\n  removeMask: {\n    top: 0,\n    left: 0,\n    bottom: 0,\n    width: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    position: 'absolute',\n    transition: 'all 100ms',\n    justifyContent: 'center',\n    '&:hover': {\n      '& > button': {\n        display: 'inherit',\n      },\n    },\n  },\n  iconBtn: {\n    display: 'none',\n    color: 'black',\n    backgroundColor: 'rgba(255,255,255,0.5)',\n    '&:hover': {\n      backgroundColor: 'rgba(255,255,255,0.75)',\n    },\n    '&:active, &:focused': {\n      backgroundColor: 'rgba(255,255,255,0.9)',\n    },\n  },\n}));\n\nconst CapturedMasks = (props) => {\n  const classes = useStyles();\n\n  const { captureMasks, handlePlay } = props;\n\n  const actionButtons = useMemo(\n    () => [\n      {\n        key: 'play',\n        Icon: PlayIcon,\n        onClick: handlePlay,\n      },\n      {\n        key: 'download',\n        Icon: DownloadIcon,\n        onClick: captureMasks.downloadMasks,\n      },\n      {\n        key: 'clear',\n        Icon: CloseIcon,\n        onClick: captureMasks.removeAllMasks,\n      },\n    ],\n    [captureMasks.downloadMasks, captureMasks.removeAllMasks, handlePlay],\n  );\n\n  const getDataUri = useCallback(({ binary: dataUri }) => dataUri, []);\n\n  const getImageChild = useCallback(\n    (maskItem, i) => (\n      <div className={classes.removeMask}>\n        <IconButton name={i} className={classes.iconBtn} onClick={captureMasks.removeMask}>\n          <DeleteForeverIcon fontSize=\"large\" />\n        </IconButton>\n      </div>\n    ),\n    [captureMasks.removeMask, classes.removeMask, classes.iconBtn],\n  );\n\n  return (\n    <MasksGrid\n      title=\"Candidate Masks\"\n      getDataUri={getDataUri}\n      masks={captureMasks.masks}\n      actionButtons={actionButtons}\n      getImageChild={getImageChild}\n    />\n  );\n};\n\nCapturedMasks.propTypes = {\n  handlePlay: PropTypes.func,\n  captureMasks: PropTypes.object.isRequired,\n};\n\nexport default CapturedMasks;\n","import React, { useMemo } from 'react';\nimport { useGame } from '../../Game';\nimport ScoreResults from '../../ScoreResults';\nimport CapturedMasks from '../../CapturedMasks';\nimport { tenBinScoreToColor } from '../../../lib/score';\nimport { makeStyles } from '@material-ui/core';\nimport Typography from '@material-ui/core/Typography';\n\nconst useStyles = makeStyles((theme) => ({\n  score: {\n    textAlign: 'right',\n    paddingRight: theme.spacing(1),\n  },\n}));\n\nconst BasicFooter = (props) => {\n  const game = useGame();\n  const classes = useStyles();\n\n  const showTimeAttackResults = useMemo(\n    () =>\n      game?.mode?.name === 'time attack'\n        ? {\n            getPaperProps: ({ score }) => ({\n              style: { background: tenBinScoreToColor(Math.max(10.5 - score, 0), 0.4) },\n            }),\n            getImageChild: ({ score }) => (\n              <Typography className={classes.score}>{score}s</Typography>\n            ),\n          }\n        : {},\n    [game, classes.score],\n  );\n\n  if (!game.mode) return null;\n\n  const { simpleGame, captureMasks, handlePlayCapturedMasks, resultsText, name } = game.mode;\n\n  const showResults = name === 'time attack' ? !game.loop.looping : true;\n\n  return (\n    <>\n      {showResults && (\n        <ScoreResults\n          label={resultsText}\n          results={simpleGame.scores}\n          handleClose={props.hideClose ? null : simpleGame.clearScores}\n          {...showTimeAttackResults}\n        />\n      )}\n      {captureMasks && (\n        <CapturedMasks captureMasks={captureMasks} handlePlay={handlePlayCapturedMasks} />\n      )}\n    </>\n  );\n};\n\nexport default BasicFooter;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  root: ({ flip, height = 10, background = 'rgba(255,255,255,0)' }) => ({\n    height,\n    background,\n    width: '100%',\n    borderRadius: 50,\n    transform: `scaleX(${flip ? -1 : 1})`,\n    pWebkitTransform: `scaleX(${flip ? -1 : 1})`,\n  }),\n  filler: ({ completed, color }) => ({\n    height: '100%',\n    textAlign: 'left',\n    background: color,\n    width: `${completed}%`,\n    borderRadius: 'inherit',\n  }),\n}));\n\nconst ProgressBar = (props) => {\n  const classes = useStyles(props);\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.filler} />\n    </div>\n  );\n};\n\nProgressBar.propTypes = {\n  flip: PropTypes.bool,\n  color: PropTypes.string.isRequired,\n  completed: PropTypes.number.isRequired,\n  height: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n};\n\nexport default ProgressBar;\n","/* global cv:false */\nimport inside from 'point-in-polygon';\n\nexport const polygonToArray = (polygon, width, height) => {\n  const bytes = new Uint8ClampedArray(width * height * 4);\n  for (let i = 0; i < height * width; ++i) {\n    const x = i % width;\n    const y = parseInt(i / width);\n    const isIn = Number(inside([x, y], polygon)) * 255;\n    bytes[i * 4] = isIn;\n    bytes[i * 4 + 1] = isIn;\n    bytes[i * 4 + 2] = isIn;\n    bytes[i * 4 + 3] = isIn ? 128 : 0;\n  }\n  return new ImageData(bytes, width, height);\n};\n\nexport const getOpenCvMaskFromSegmentation = (segmentation, flipped) => {\n  const { data, width, height } = segmentation;\n  const binaryBytes = new Uint8ClampedArray(segmentation.data.length * 4);\n  // TODO: See if we can directly create CVMat from segmentation.data.\n\n  for (let i = 0; i < height * width; ++i) {\n    const x = i % width;\n    const y = parseInt(i / width);\n\n    const isPerson = data[i];\n    const bytes_index = flipped ? width - x + width * y : i;\n\n    binaryBytes[bytes_index * 4] = isPerson ? 255 : 0; // red\n    binaryBytes[bytes_index * 4 + 1] = isPerson ? 255 : 0; // green\n    binaryBytes[bytes_index * 4 + 2] = isPerson ? 255 : 0; // blue\n    binaryBytes[bytes_index * 4 + 3] = isPerson ? 255 : 0; // alpha\n  }\n  let binaryImageData = new ImageData(binaryBytes, width, height);\n\n  // Load data into Mat.\n  let segData = cv.matFromImageData(binaryImageData);\n\n  // Create a single channel mask.\n  let rgbaPlanes = new cv.MatVector();\n  cv.split(segData, rgbaPlanes);\n  let pre_mask = new cv.Mat();\n  // Threshold on one channel (doesn't matter which one)\n  cv.threshold(rgbaPlanes.get(0), pre_mask, 128, 1, cv.THRESH_BINARY); // Mask is 0s and 1s, type CV_8UC1\n\n  // Use findContours/drawContours to remove small blobs.\n  // See example: https://docs.opencv.org/3.4/d5/daa/tutorial_js_contours_begin.html\n  // TODO: This only updates the overlay. Also update the Mask.\n  let contours = new cv.MatVector();\n  let hierarchy = new cv.Mat();\n  cv.findContours(pre_mask, contours, hierarchy, cv.RETR_CCOMP, cv.CHAIN_APPROX_SIMPLE);\n  let mask = cv.Mat.zeros(pre_mask.rows, pre_mask.cols, cv.CV_8UC1);\n  let area = 0;\n  let minAreaThreshold = 10000; // Can change this, starting off with 100x100.\n  for (let i = 0; i < contours.size(); ++i) {\n    area = cv.contourArea(contours.get(i));\n    if (area > minAreaThreshold) {\n      cv.drawContours(mask, contours, i, [1, 1, 1, 1], -1 /*fill*/, cv.LINE_8, hierarchy, 100);\n    }\n  }\n\n  // Cleanup\n  segData.delete();\n  rgbaPlanes.delete();\n\n  return mask;\n};\n\nexport const getSegmentationeOverlayAndBinaryImageData = (segmentation, flipped) => {\n  const mask = getOpenCvMaskFromSegmentation(segmentation, flipped);\n\n  // Create a Blue opaque overlay with a solid Green border.\n  // NOTE: Images are in RGBA format\n  let rgbaPlanes = new cv.MatVector();\n  let overlay = cv.Mat.zeros(mask.rows, mask.cols, cv.CV_8UC4);\n  cv.split(overlay, rgbaPlanes);\n  // Fill blue channel and alpha using the mask.\n  rgbaPlanes.get(2).setTo([255, 0, 0, 0], mask); // Blue\n  rgbaPlanes.get(3).setTo([128, 0, 0, 0], mask); // Alpha\n  // Get a border mask.\n  let borderSize = 10;\n  let borderMask = new cv.Mat();\n  let M = cv.Mat.ones(borderSize, borderSize, cv.CV_8U);\n  let anchor = new cv.Point(-1, -1);\n  cv.dilate(mask, borderMask, M, anchor, 1, cv.BORDER_CONSTANT, cv.morphologyDefaultBorderValue());\n  cv.subtract(borderMask, mask, borderMask);\n  // Fill solid green using the border mask.\n  rgbaPlanes.get(2).setTo([255, 0, 0, 0], borderMask); // Blue\n  // rgbaPlanes.get(1).setTo([255, 0, 0, 0], borderMask); // Green\n  rgbaPlanes.get(1).setTo([255, 0, 0, 0], borderMask); // Green\n  rgbaPlanes.get(3).setTo([255, 0, 0, 0], borderMask); // Alpha\n  // Merge into final result.\n  cv.merge(rgbaPlanes, overlay);\n  const overlayImageData = new ImageData(\n    new Uint8ClampedArray(overlay.data),\n    overlay.cols,\n    overlay.rows,\n  );\n  // Cleanup\n  rgbaPlanes.delete();\n  mask.delete();\n  overlay.delete();\n  M.delete();\n  borderMask.delete();\n\n  // TODO: only return one image here.\n  return { overlayImageData, binaryImageData: overlayImageData };\n};\n\nexport const getScore = (targetImageData, segmentation, flipped) => {\n  // Just get the score\n  const { data, width, height } = segmentation;\n  const bytes = new Uint8ClampedArray(segmentation.data.length * 4);\n\n  let union = 0;\n  let intersection = 0;\n\n  for (let i = 0; i < height * width; ++i) {\n    const x = i % width;\n    const y = parseInt(i / width);\n\n    const bytes_index = flipped ? width - x + width * y : i;\n\n    const isPerson = data[i];\n    const isInPolygon = !!targetImageData.data[bytes_index * 4 + 2];\n    const isIntersection = isInPolygon && isPerson;\n    const isMissedPolygon = isInPolygon && !isPerson;\n    const isPersonOutOfPolygon = !isInPolygon && isPerson;\n    const isInteresting = isPersonOutOfPolygon || isIntersection || isMissedPolygon;\n\n    if (isIntersection) intersection++;\n    if (isPerson || isInPolygon) union++;\n\n    bytes[bytes_index * 4] = isPersonOutOfPolygon ? 255 : 0; // red\n    bytes[bytes_index * 4 + 1] = isIntersection ? 255 : 0; // green\n    bytes[bytes_index * 4 + 2] = isMissedPolygon ? 255 : 0; // blue\n    bytes[bytes_index * 4 + 3] = isInteresting ? 128 : 0; // alpha\n  }\n\n  const score = Math.round((intersection / (union + 0.0000001)) * 100);\n  return score;\n};\n\nexport const getScoreAndOverlayForSegmentationAndImageData = (\n  targetImageData,\n  segmentation,\n  flipped,\n) => {\n  // Create a visualization of the new segmentation.\n  const segmentationMask = getOpenCvMaskFromSegmentation(segmentation, flipped);\n  let rgbaPlanes = new cv.MatVector();\n  let segOverlay = cv.Mat.zeros(segmentationMask.rows, segmentationMask.cols, cv.CV_8UC4);\n  cv.split(segOverlay, rgbaPlanes);\n  // Fill green channel and alpha using the mask.\n  rgbaPlanes.get(1).setTo([255, 0, 0, 0], segmentationMask); // Green\n  rgbaPlanes.get(3).setTo([128, 0, 0, 0], segmentationMask); // Alpha\n  // Get a border mask.\n  let borderSize = 10;\n  let borderMask = new cv.Mat();\n  let M = cv.Mat.ones(borderSize, borderSize, cv.CV_8U);\n  let anchor = new cv.Point(-1, -1);\n  cv.dilate(\n    segmentationMask,\n    borderMask,\n    M,\n    anchor,\n    1,\n    cv.BORDER_CONSTANT,\n    cv.morphologyDefaultBorderValue(),\n  );\n  cv.subtract(borderMask, segmentationMask, borderMask);\n  // Fill solid green using the border mask.\n  rgbaPlanes.get(1).setTo([255, 0, 0, 0], borderMask); // Green\n  rgbaPlanes.get(3).setTo([255, 0, 0, 0], borderMask); // Alpha\n  // Merge into final result.\n  cv.merge(rgbaPlanes, segOverlay);\n  const segOverlayImageData = new ImageData(\n    new Uint8ClampedArray(segOverlay.data),\n    segOverlay.cols,\n    segOverlay.rows,\n  );\n\n  // Create a mask from the targetImageData.\n  let targetData = cv.matFromImageData(targetImageData);\n  let targetRgbaPlanes = new cv.MatVector();\n  cv.split(targetData, targetRgbaPlanes);\n\n  // Merge the two images.\n  let mergedImage = new cv.Mat();\n  cv.addWeighted(segOverlay, 0.5, targetData, 0.5, 0.0, mergedImage);\n  const mergedOverlayImageData = new ImageData(\n    new Uint8ClampedArray(mergedImage.data),\n    mergedImage.cols,\n    mergedImage.rows,\n  );\n\n  const score = getScore(targetImageData, segmentation, flipped);\n\n  // Cleanup\n  rgbaPlanes.delete();\n  segmentationMask.delete();\n  segOverlay.delete();\n  M.delete();\n  borderMask.delete();\n  mergedImage.delete();\n\n  return { score, targetOverlay: mergedOverlayImageData, segOverlay: segOverlayImageData };\n};\n\nexport const drawPolygon = (ctx, polygon, color = 'rgba(255, 255, 255, 0.5)') => {\n  ctx.fillStyle = color;\n  ctx.beginPath();\n  ctx.moveTo(polygon[0][0], polygon[0][1]);\n  const vertices = polygon.slice(1);\n  vertices.forEach(([x, y]) => {\n    ctx.lineTo(x, y);\n  });\n  ctx.closePath();\n  ctx.fill();\n};\n\nexport const flipPolygon = (polygon, width) => polygon.map(([x, y]) => [width - x, y]);\n\nexport const inflatePolygon = (width, height) => (polygon) =>\n  polygon.map(([x, y]) => [x * width, y * height]);\n\nexport const saveAs = (blob, filename) => {\n  if (typeof navigator.msSaveOrOpenBlob !== 'undefined') {\n    return navigator.msSaveOrOpenBlob(blob, filename);\n  } else if (typeof navigator.msSaveBlob !== 'undefined') {\n    return navigator.msSaveBlob(blob, filename);\n  } else {\n    var elem = window.document.createElement('a');\n    elem.href = window.URL.createObjectURL(blob);\n    elem.download = filename;\n    elem.style = 'display:none;opacity:0;color:transparent;';\n    (document.body || document.documentElement).appendChild(elem);\n    if (typeof elem.click === 'function') {\n      elem.click();\n    } else {\n      elem.target = '_blank';\n      elem.dispatchEvent(\n        new MouseEvent('click', {\n          view: window,\n          bubbles: true,\n          cancelable: true,\n        }),\n      );\n    }\n    URL.revokeObjectURL(elem.href);\n  }\n};\n\nexport const getMaskName = (num) => `set${num}.zip`;\n","import JSZip from 'jszip';\nimport JSZipUtils from 'jszip-utils';\nimport { useCallback, useState, useMemo } from 'react';\n\nimport { getMaskName } from '../lib/util';\nimport { useWebcam } from '../context/webcam';\nimport { numShippedMasks } from '../lib/constants';\n\nexport const useZip = (setMasks) => {\n  const webcam = useWebcam();\n  const [zipLoading, setZipLoading] = useState(false);\n\n  const loadZippedMasks = useCallback(\n    async (file) => {\n      const data = await JSZip.loadAsync(file);\n      console.log('DATA', data);\n      const binaryMasks = await Promise.all(\n        data\n          .filter((name) => name.endsWith('.png'))\n          .map(({ name }) => data.file(name).async('base64')),\n      );\n\n      try {\n        console.log('Getting MASK!', binaryMasks);\n        const masksAsImageData = await Promise.all(\n          binaryMasks.map((b64) => webcam.dataUriToImageData(`data:image/png;base64,${b64}`)),\n        );\n        console.log('GOT MASK!');\n        setMasks(masksAsImageData);\n      } catch {\n        console.log('UH OH');\n      }\n\n      setZipLoading(false);\n    },\n    [setMasks, webcam],\n  );\n\n  const handleZipInputChange = useCallback(\n    async ([file]) => {\n      if (file.type !== 'application/zip') {\n        console.error('Expected a zip file but got', file.type);\n        return;\n      }\n\n      setZipLoading(true);\n      await loadZippedMasks(file);\n    },\n    [loadZippedMasks],\n  );\n\n  const handleLoadPreparedMasks = useCallback(\n    async (filename) => {\n      if (!filename) return;\n\n      setZipLoading(true);\n      const file = await new JSZip.external.Promise((resolve, reject) => {\n        JSZipUtils.getBinaryContent(process.env.PUBLIC_URL + `/masks/${filename}`, (err, data) => {\n          if (err) reject(err);\n          else resolve(data);\n        });\n      });\n      console.log('YEAH', file);\n      await loadZippedMasks(file);\n    },\n    [loadZippedMasks],\n  );\n\n  const handleLoadRandomMaskSet = useCallback(async () => {\n    const num = Math.floor(Math.random() * numShippedMasks);\n    return handleLoadPreparedMasks(getMaskName(num + 1));\n  }, [handleLoadPreparedMasks]);\n\n  const data = useMemo(\n    () => ({\n      loading: zipLoading,\n      handleZipInputChange,\n      handleLoadRandomMaskSet,\n      handleLoadPreparedMasks,\n    }),\n    [zipLoading, handleZipInputChange, handleLoadPreparedMasks, handleLoadRandomMaskSet],\n  );\n\n  return data;\n};\n","import { useMemo, useRef, useState, useCallback } from 'react';\n\n// set masks, iterate masks, retain ref to current mask\nexport const useIterateMask = () => {\n  const masksRef = useRef([]);\n  const maskRef = useRef(null);\n  const maskIdxRef = useRef(0);\n  const [masks, _setMasks] = useState([]);\n\n  const setMasks = useCallback((newMasks) => {\n    _setMasks(newMasks);\n    masksRef.current = typeof newMasks === 'function' ? newMasks(masksRef.current) : newMasks;\n  }, []);\n\n  const reset = useCallback(() => {\n    maskIdxRef.current = 0;\n    maskRef.current = null;\n  }, []);\n\n  const shuffle = useCallback(() => {\n    const array = masks.slice();\n    var currentIndex = array.length,\n      temporaryValue,\n      randomIndex;\n\n    // While there remain elements to shuffle...\n    while (0 !== currentIndex) {\n      // Pick a remaining element...\n      randomIndex = Math.floor(Math.random() * currentIndex);\n      currentIndex -= 1;\n\n      // And swap it with the current element.\n      temporaryValue = array[currentIndex];\n      array[currentIndex] = array[randomIndex];\n      array[randomIndex] = temporaryValue;\n    }\n\n    setMasks(array);\n    masksRef.current = array;\n  }, [masks, setMasks]);\n\n  const resetAndShuffle = useCallback(() => {\n    maskIdxRef.current = 0;\n    maskRef.current = null;\n    shuffle();\n  }, [shuffle]);\n\n  const next = useCallback(() => {\n    const currentMask = masksRef.current[maskIdxRef.current];\n\n    if (!currentMask) {\n      maskRef.current = null;\n      maskIdxRef.current = 0;\n\n      return null;\n    }\n\n    maskRef.current = currentMask;\n    maskIdxRef.current++;\n\n    return currentMask;\n  }, []);\n\n  const getNumMasks = useCallback(() => masksRef.current.length, []);\n\n  const random = useCallback(() => {\n    const mask = masks[Math.floor(Math.random() * masks.length)];\n    maskRef.current = mask;\n    return mask;\n  }, [masks]);\n\n  return useMemo(\n    () => ({\n      next,\n      reset,\n      random,\n      maskRef,\n      setMasks,\n      maskIdxRef,\n      getNumMasks,\n      resetAndShuffle,\n      hasMasks: !!masks.length,\n    }),\n    [next, masks, random, reset, setMasks, resetAndShuffle, getNumMasks],\n  );\n};\n","import React, { useContext, createContext } from 'react';\n\nimport { useCarbonController } from '../hooks/carbonController';\n\nexport const carbonContext = createContext();\n\nexport const useCarbon = () => {\n  const state = useContext(carbonContext);\n\n  if (state === undefined) {\n    throw new Error('useCarbon must be used within a CarbonProvider');\n  }\n\n  return state;\n};\n\nconst CarbonProvider = ({ children }) => {\n  const context = useCarbonController();\n\n  return <carbonContext.Provider value={context}>{children}</carbonContext.Provider>;\n};\n\nexport default CarbonProvider;\n","import { useState, useCallback, useRef, useEffect } from 'react';\nimport { useAudio } from '../context/audio';\n\nexport const useCarbonController = () => {\n  const {\n    handlers: {\n      speech: { say },\n    },\n  } = useAudio();\n\n  const carbonRef = useRef();\n  const [carbonState, setCarbonState] = useState(false);\n\n  useEffect(() => {\n    if (carbonState && !carbonRef.current) {\n      carbonRef.current = true;\n    } else if (!carbonState && carbonRef.current) {\n      carbonRef.current = false;\n    }\n  }, [carbonState]);\n\n  const toggle = useCallback(() => {\n    setCarbonState((state) => {\n      if (!state) {\n        say('Carbon Activated!');\n      }\n      return !state;\n    });\n  }, [say]);\n\n  window.__carbonate__ = toggle;\n\n  return { carbonState, carbonRef };\n};\n","import { useMemo, useRef, useCallback, useState } from 'react';\n\nimport { useZip } from '../zip';\nimport { useAudio } from '../../context/audio';\nimport { useIterateMask } from '../iterateMask';\nimport { useWebcam } from '../../context/webcam';\nimport { rawScoreToTenBinScore } from '../../lib/score';\nimport { getScoreAndOverlayForSegmentationAndImageData, getScore } from '../../lib/util';\nimport { useCarbon } from '../../context/carbon';\n\nexport const useSimpleGame = ({ setLapTimeInfo } = {}) => {\n  const promRef = useRef();\n  const webcam = useWebcam();\n  const { carbonRef } = useCarbon();\n  const roundTracker = useRef(0);\n  const maskIterator = useIterateMask();\n  const lastTimeAttackSuccess = useRef(0);\n  const [scores, setScores] = useState([]);\n  const [multiplayerScores, setMultiplayerScores] = useState([[], []]);\n  const zip = useZip(maskIterator.setMasks);\n  const {\n    handlers: {\n      sfx: { playSuccessSound, playFailureSound },\n      speech: { say },\n    },\n  } = useAudio();\n\n  const clearScores = useCallback(() => {\n    setScores([]);\n    setMultiplayerScores([[], []]);\n  }, []);\n\n  const handleBasicLoop = useCallback(\n    (playerIndex) => async (controller) => {\n      if (controller.time.first) {\n        maskIterator.next(); // load the first mask\n        if (!playerIndex) clearScores();\n        controller.useTimer({\n          maxLaps: maskIterator.getNumMasks(),\n          setLapTimeInfo: setLapTimeInfo,\n          announceSeconds: true,\n          onLap: ({ predict, time, stop }) => {\n            const target = maskIterator.maskRef.current;\n\n            // we actually shouldn't reach this,\n            // because the maxLaps should trigger a stop first\n            if (!target) return stop();\n\n            promRef.current = predict(webcam.videoRef.current).then(async (segmentation) => {\n              const { score, targetOverlay } = getScoreAndOverlayForSegmentationAndImageData(\n                target,\n                segmentation,\n                webcam.flipX,\n              );\n\n              const dataUri = webcam.imageDataToDataUri(targetOverlay);\n\n              if (playerIndex !== undefined) {\n                setMultiplayerScores((state) => {\n                  const newState = [...state];\n                  newState[playerIndex] = [\n                    ...newState[playerIndex],\n                    { score: rawScoreToTenBinScore(score), dataUri },\n                  ];\n\n                  return newState;\n                });\n              } else {\n                setScores((state) => [...state, { score: rawScoreToTenBinScore(score), dataUri }]);\n              }\n\n              webcam.clearCanvas();\n              maskIterator.next();\n            });\n          },\n        });\n      }\n\n      if (maskIterator.maskRef.current) {\n        webcam.ctx.putImageData(maskIterator.maskRef.current, 0, 0);\n      }\n\n      // return a cleanup function to clear the canvas\n      // use a promise ref since we are capturing asynchronously\n      // if first promise not initialized, clear canvas right away\n      return () => {\n        if (promRef.current) promRef.current.then(controller.webcam.clearCanvas);\n        else controller.webcam.clearCanvas();\n      };\n    },\n    [webcam, maskIterator, setLapTimeInfo, clearScores],\n  );\n\n  const handleLoop = useCallback(() => handleBasicLoop(), [handleBasicLoop]);\n\n  const handleMultiplayerLoop = useCallback((playerIndex) => handleBasicLoop(playerIndex), [\n    handleBasicLoop,\n  ]);\n\n  const handleSurvivalLoop = useCallback(\n    async (controller) => {\n      if (controller.time.first) {\n        maskIterator.random();\n        clearScores();\n        controller.useTimer({\n          maxLaps: 9999999, // Good luck surviving this long!\n          lapDuration: 10.0 * 1000, // Initial time\n          setLapTimeInfo: setLapTimeInfo,\n          announceSeconds: true,\n          onLap: ({ predict, time, stop }) => {\n            const target = maskIterator.maskRef.current;\n\n            // we actually shouldn't reach this,\n            // because the maxLaps should trigger a stop first\n            if (!target) return stop();\n\n            promRef.current = predict(webcam.videoRef.current).then(async (segmentation) => {\n              const { score, targetOverlay } = getScoreAndOverlayForSegmentationAndImageData(\n                target,\n                segmentation,\n                webcam.flipX,\n              );\n\n              const scoreToProceed = 4;\n\n              // Play Sound ASAP\n              const tenBinScore = rawScoreToTenBinScore(score);\n              if (tenBinScore < scoreToProceed) {\n                if (carbonRef.current) {\n                  say('Missed it!');\n                } else {\n                  playFailureSound();\n                }\n              } else {\n                if (carbonRef.current) {\n                  say('Got it!');\n                } else {\n                  playSuccessSound();\n                }\n              }\n\n              const dataUri = webcam.imageDataToDataUri(targetOverlay);\n\n              setScores((state) => [...state, { score: rawScoreToTenBinScore(score), dataUri }]);\n\n              webcam.clearCanvas();\n              if (tenBinScore < scoreToProceed) {\n                // Game Over\n                maskIterator.reset();\n                return stop();\n              } else {\n                // Adjust time - multiply (decay) by 0.9.\n                // controller.timerRef.current.lapDuration =\n                //   Math.floor(Math.max(controller.timerRef.current.lapDuration * 0.9, 1) * 10) / 10;\n\n                // Adjust time linear - subtract a fixed value.\n                // controller.timerRef.current.lapDuration =\n                //   Math.floor(Math.max(controller.timerRef.current.lapDuration - 500, 1000) * 10) /\n                //   10;\n\n                // Adjust time, t + 1 = t - log(t) - small_constant\n                // Intervals are: [10, 9.3, 8.6, 7.9, 7.4, 6.7, 6.1, 5.6, 5.0, 4.5, 4.0, 3.6, 3.2, 2.7, 2.4, 2.0, 1.8, 1.5, 1.3, 1.1, 1.0 ...... 0.67]\n                const t_sec = controller.timerRef.current.lapDuration / 1000;\n                controller.timerRef.current.lapDuration =\n                  (t_sec - Math.log(t_sec) / Math.log(50)) * 1000 - 100;\n\n                maskIterator.random();\n              }\n            });\n          },\n        });\n      }\n\n      if (maskIterator.maskRef.current) {\n        webcam.ctx.putImageData(maskIterator.maskRef.current, 0, 0);\n      }\n\n      // return a cleanup function to clear the canvas\n      // use a promise ref since we are capturing asynchronously\n      // if first promise not initialized, clear canvas right away\n      return () => {\n        if (promRef.current) promRef.current.then(controller.webcam.clearCanvas);\n        else controller.webcam.clearCanvas();\n      };\n    },\n    [\n      webcam,\n      maskIterator,\n      setLapTimeInfo,\n      clearScores,\n      carbonRef,\n      playFailureSound,\n      playSuccessSound,\n      say,\n    ],\n  );\n\n  const handleTimeAttackLoop = useCallback(\n    async (controller) => {\n      if (controller.time.first) {\n        maskIterator.resetAndShuffle();\n        maskIterator.next();\n        clearScores();\n        roundTracker.current = 0;\n        lastTimeAttackSuccess.current = 0;\n        controller.useTimer({\n          setLapTimeInfo: setLapTimeInfo,\n          announceSeconds: false,\n          lapDuration: 250,\n          postLapDelay: 0,\n          onLap: ({ predict, time, stop }) => {\n            const currentMaskIdx = maskIterator.maskIdxRef.current;\n            const target = maskIterator.maskRef.current;\n\n            // we will reach this\n            if (!target) {\n              // stop(); TODO: Check if we need this.\n              roundTracker.current = 0;\n              maskIterator.reset();\n              return stop();\n            }\n\n            // if we hit this then we succeeded in the predict promise\n            // but fired a new lap before it succeeded\n            if (roundTracker.current >= currentMaskIdx) return;\n\n            const maxTimeAllowed = 10.0;\n            const segmentationMs = time.elapsed - lastTimeAttackSuccess.current;\n            if (segmentationMs / 1000 >= maxTimeAllowed) {\n              lastTimeAttackSuccess.current = time.elapsed;\n              if (carbonRef.current) {\n                say('Missed it!');\n              } else {\n                playFailureSound();\n              }\n              const dataUri = webcam.imageDataToDataUri(target);\n              setScores((state) => [...state, { score: maxTimeAllowed, dataUri }]);\n              webcam.clearCanvas();\n              maskIterator.next();\n              roundTracker.current++;\n            }\n\n            promRef.current = predict(webcam.videoRef.current)\n              .then(async (segmentation) => {\n                const score = getScore(target, segmentation, webcam.flipX);\n\n                const tenBinScore = rawScoreToTenBinScore(score);\n                if (tenBinScore > 5) {\n                  // if we hit this then we succeeded in the predict promise\n                  // but fired a new lap before it succeeded\n                  if (roundTracker.current >= currentMaskIdx) return;\n                  if (carbonRef.current) {\n                    say('Got it!');\n                  } else {\n                    playSuccessSound();\n                  }\n                  const segmentationSec = segmentationMs / 1000;\n                  lastTimeAttackSuccess.current = time.elapsed;\n                  const numSecs = Number(segmentationSec.toFixed(1));\n\n                  const { targetOverlay } = getScoreAndOverlayForSegmentationAndImageData(\n                    target,\n                    segmentation,\n                    webcam.flipX,\n                  );\n                  const dataUri = webcam.imageDataToDataUri(targetOverlay);\n                  setScores((state) => [...state, { score: numSecs, dataUri }]);\n                  webcam.clearCanvas();\n                  maskIterator.next();\n                  roundTracker.current++;\n                }\n              })\n              .catch(console.error);\n          },\n        });\n      }\n\n      if (maskIterator.maskRef.current) {\n        webcam.ctx.putImageData(maskIterator.maskRef.current, 0, 0);\n      }\n\n      // return a cleanup function to clear the canvas\n      // use a promise ref since we are capturing asynchronously\n      // if first promise not initialized, clear canvas right away\n      return () => {\n        if (promRef.current) promRef.current.then(controller.webcam.clearCanvas);\n        else controller.webcam.clearCanvas();\n      };\n    },\n    [\n      webcam,\n      maskIterator,\n      clearScores,\n      setLapTimeInfo,\n      playFailureSound,\n      playSuccessSound,\n      carbonRef,\n      say,\n    ],\n  );\n\n  return useMemo(\n    () => ({\n      zip,\n      scores,\n      multiplayerScores,\n      handleLoop,\n      handleMultiplayerLoop,\n      handleSurvivalLoop,\n      handleTimeAttackLoop,\n      clearScores,\n      reset: maskIterator.reset,\n      ready: maskIterator.hasMasks,\n      setMasks: maskIterator.setMasks,\n    }),\n    [\n      zip,\n      scores,\n      multiplayerScores,\n      handleLoop,\n      handleMultiplayerLoop,\n      handleSurvivalLoop,\n      handleTimeAttackLoop,\n      clearScores,\n      maskIterator.hasMasks,\n      maskIterator.reset,\n      maskIterator.setMasks,\n    ],\n  );\n};\n","import JSZip from 'jszip';\nimport imageDataUri from 'image-data-uri';\nimport { useRef, useCallback, useState } from 'react';\nimport { useAudio } from '../../context/audio';\n\nimport { saveAs, getSegmentationeOverlayAndBinaryImageData } from '../../lib/util';\nimport { useMemo } from 'react';\nimport { useCarbon } from '../../context/carbon';\n\nexport const useCaptureMasks = ({ maxMasks = 0, setLapTimeInfo } = {}) => {\n  const promRef = useRef();\n  const masksRef = useRef([]);\n  const maskCountRef = useRef();\n  const [masks, _setMasks] = useState([]);\n  const { carbonRef } = useCarbon();\n  const {\n    handlers: {\n      sfx: { playCameraSound },\n      speech: { say },\n    },\n  } = useAudio();\n\n  const setMasks = useCallback((arg) => {\n    if (typeof arg === 'function') {\n      _setMasks((state) => {\n        const newState = arg(state);\n        if (newState !== state) {\n          masksRef.current = newState;\n        }\n\n        return newState;\n      });\n    } else {\n      masksRef.current = arg;\n      _setMasks(arg);\n    }\n  }, []);\n\n  const getMasks = useCallback(() => masksRef.current, []);\n\n  const removeMask = useCallback(\n    ({ currentTarget: { name: idx } }) => {\n      // the plus coerces the idx to a number\n      setMasks((state) => state.filter((_, index) => index !== +idx));\n    },\n    [setMasks],\n  );\n\n  const removeAllMasks = useCallback(() => {\n    setMasks([]);\n  }, [setMasks]);\n\n  const downloadMasks = useCallback(() => {\n    const zip = new JSZip();\n    const img = zip.folder('masks');\n    masks.forEach(({ overlay: mask }, idx) => {\n      img.file(`mask-${idx}.png`, imageDataUri.decode(mask).dataBase64, { base64: true });\n    });\n\n    zip.generateAsync({ type: 'blob' }).then((zipFile) => saveAs(zipFile, 'masks.zip'));\n  }, [masks]);\n\n  const handleLoop = useCallback(\n    (onLoopEnd) => async (controller) => {\n      if (controller.time.first) {\n        maskCountRef.current = masks.length;\n        controller.useTimer({\n          announceSeconds: true,\n          lapDuration: 3000, // NOTE: This is the per-loop time used for multiplayer capture.\n          postLapDelay: 2500,\n          maxLaps: maxMasks,\n          setLapTimeInfo: setLapTimeInfo,\n          // run a single prediction before starting the lap to ensure things roll smoothly\n          onBeforeStartLap: async ({ predict, webcam, time, stop }) => {\n            return predict();\n          },\n          onLap: ({ predict, webcam, time, stop }) => {\n            promRef.current = predict(webcam.videoRef.current).then(async (segmentation) => {\n              const {\n                overlayImageData,\n                binaryImageData,\n              } = getSegmentationeOverlayAndBinaryImageData(segmentation, webcam.flipX);\n              // Play Sound\n              if (carbonRef.current) {\n                say('Gotcha!');\n              } else {\n                playCameraSound();\n              }\n              const overlayDataUri = webcam.imageDataToDataUri(overlayImageData);\n              const binaryDataUri = webcam.imageDataToDataUri(binaryImageData);\n\n              webcam.clearCanvas();\n              webcam.ctx.putImageData(overlayImageData, 0, 0);\n\n              setMasks((state) => [...state, { overlay: overlayDataUri, binary: binaryDataUri }]);\n\n              await new Promise((resolve) => setTimeout(resolve, 1500));\n              webcam.clearCanvas();\n\n              if (maxMasks && ++maskCountRef.current > maxMasks) {\n                // NOTE: This does not get called if maxLaps is set.\n                return stop();\n              }\n            });\n          },\n          onEnd: async ({ time, webcam, predict, stop }) => {\n            // This is the pause after the last capture to show the mask before clearing.\n            await new Promise((resolve) => setTimeout(resolve, 2000));\n            webcam.clearCanvas();\n          },\n        });\n      }\n\n      // return a cleanup function to clear the canvas\n      // use a promise ref since we are capturing asynchronously\n      // if first promise not initialized, clear canvas right away\n      return () => {\n        if (promRef.current) {\n          promRef.current.then(controller.webcam.clearCanvas).then(() => {\n            if (onLoopEnd) {\n              onLoopEnd();\n            }\n          });\n        } else {\n          controller.webcam.clearCanvas();\n          if (onLoopEnd) {\n            onLoopEnd();\n          }\n        }\n      };\n    },\n    [masks.length, maxMasks, setLapTimeInfo, setMasks, playCameraSound, say, carbonRef],\n  );\n\n  return useMemo(\n    () => ({\n      masks,\n      getMasks,\n      handleLoop,\n      removeMask,\n      downloadMasks,\n      removeAllMasks,\n    }),\n    [masks, getMasks, handleLoop, removeMask, downloadMasks, removeAllMasks],\n  );\n};\n","import { useCallback, useRef, useMemo } from 'react';\nimport { useAudio } from '../context/audio';\nimport { scoreToColor } from '../lib/score';\n\nexport const initialLapInfo = {\n  percent: 0.0,\n  percentRemaining: 100.0,\n  color: scoreToColor(100),\n  secondsRemaining: 0,\n};\n\nexport const useLapTimer = () => {\n  const lapTimer = useRef();\n  const {\n    handlers: { speech },\n  } = useAudio();\n\n  const useTimer = useCallback(\n    ({\n      onBeforeStartLap,\n      onLap,\n      onEnd,\n      maxLaps,\n      setLapTimeInfo,\n      lapDuration = 3000,\n      postLapDelay = 1000,\n      announceSeconds = true,\n    } = {}) => {\n      if (onLap && !lapTimer.current) {\n        lapTimer.current = {\n          onBeforeStartLap,\n          onBeforeComplete: false,\n          onBeforeStarted: false,\n          onEndCalled: false,\n          onLap,\n          onEnd,\n          maxLaps,\n          numLaps: 0,\n          lapDuration,\n          postLapDelay,\n          setLapTimeInfo,\n          announceSeconds,\n        };\n        if (setLapTimeInfo) {\n          lapTimer.current.setLapTimeInfo(initialLapInfo);\n        }\n      }\n    },\n    [],\n  );\n\n  const handleLap = useCallback(\n    async ({ time, webcam, predict, stop }) => {\n      // handleLoop called useTimer\n      if (lapTimer.current) {\n        // if they've provided an initialization function,\n        // run it and don't start the first lap until it resolves\n        if (lapTimer.current.onBeforeStartLap && !lapTimer.current.onBeforeComplete) {\n          if (lapTimer.current.onBeforeStarted) return;\n          else {\n            lapTimer.current.onBeforeStarted = true;\n\n            await lapTimer.current.onBeforeStartLap({ time, webcam, predict, stop });\n            lapTimer.current.onBeforeComplete = true;\n            time.resetLapTime();\n            return;\n          }\n        }\n\n        if (lapTimer.current.maxLaps && lapTimer.current.numLaps === lapTimer.current.maxLaps) {\n          if (lapTimer.current.onEnd) {\n            if (!lapTimer.current.onEndCalled) {\n              lapTimer.current.onEndCalled = true;\n              await lapTimer.current.onEnd({ time, webcam, predict, stop });\n              lapTimer.current = null;\n              return stop();\n            }\n            return;\n          } else {\n            lapTimer.current = null;\n            return stop();\n          }\n        }\n\n        const secondsPassed = Math.floor(time.lapTime / 100) / 10;\n\n        // we get a single instance of -1 so set min to 0\n        const countdown = +Math.max(lapTimer.current.lapDuration / 1000 - secondsPassed, 0).toFixed(\n          1,\n        );\n\n        if (lapTimer.current.setLapTimeInfo) {\n          const percentRemaining = Math.min(\n            (Number(countdown) / lapTimer.current.lapDuration) * 100000,\n            100,\n          );\n          const percent = 100 - percentRemaining;\n          const color = scoreToColor(percentRemaining);\n          const secondsRemaining = countdown.toFixed(1);\n          const lapInfo = {\n            percent,\n            percentRemaining,\n            color,\n            secondsRemaining,\n          };\n          lapTimer.current.setLapTimeInfo(lapInfo);\n        }\n\n        // announce the current countdown time (if not announced yet and requested)\n        if (\n          countdown &&\n          lapTimer.current.announceSeconds &&\n          lapTimer.current.lastSpeech !== countdown &&\n          parseInt(countdown, 10) === Number(countdown) // only speak ints\n        ) {\n          lapTimer.current.lastSpeech = countdown;\n          speech.say(`${countdown}`);\n        }\n\n        // Once we've reached the end of the lap\n        // fire the provided onLap handler and set handlerCalled so we don't call it again until next lap\n        if (time.lapTime >= lapTimer.current.lapDuration && !lapTimer.current.handlerCalled) {\n          lapTimer.current.numLaps++;\n          lapTimer.current.handlerCalled = true;\n          lapTimer.current.handlerResolved = false;\n          await lapTimer.current.onLap({\n            time,\n            webcam,\n            predict,\n            stop,\n            lapNum: lapTimer.current.numLaps,\n          });\n          lapTimer.current.handlerResolved = true;\n        } else if (\n          time.lapTime >= lapTimer.current.lapDuration + lapTimer.current.postLapDelay &&\n          lapTimer.current.handlerResolved\n        ) {\n          // we've already called the lap handler\n          // and the handler has resolved\n          // and delayed an additional amount of time\n          // so we reset the lapTime and mark the handler as ready to be called again\n          time.resetLapTime();\n          lapTimer.current.handlerCalled = false;\n          lapTimer.current.handlerResolved = false;\n        }\n      }\n    },\n    [speech],\n  );\n\n  const clear = useCallback(() => {\n    lapTimer.current = null;\n  }, []);\n\n  return useMemo(\n    () => ({\n      clear,\n      useTimer,\n      handleLap,\n      timerRef: lapTimer,\n    }),\n    [clear, useTimer, handleLap, lapTimer],\n  );\n};\n","import { useState } from 'react';\nimport { useRef, useEffect, useMemo, useCallback } from 'react';\nimport { useSimpleGame } from '../loopHandlers/simpleGame';\nimport { useCaptureMasks } from '../loopHandlers/captureMasks';\nimport { initialLapInfo } from '../lapTimer';\n\nexport const useSurvival = (loop) => {\n  const [lapTimeInfo, setLapTimeInfo] = useState(initialLapInfo);\n  const simpleGame = useSimpleGame({ setLapTimeInfo });\n  const captureMasks = useCaptureMasks({ setLapTimeInfo });\n\n  const resultsText = useMemo(\n    () =>\n      `You survived ${simpleGame?.scores?.length - 1} round${\n        simpleGame?.scores?.length !== 2 ? 's' : ''\n      }.`,\n    [simpleGame.scores],\n  );\n\n  const loadedRef = useRef(false);\n  useEffect(() => {\n    if (!loadedRef.current) {\n      loadedRef.current = true;\n      simpleGame.zip.handleLoadPreparedMasks('survival_2.zip'); // TODO: Make a BETTER Survival Set.\n    }\n  }, [simpleGame]);\n\n  const handleClickGame = useCallback(async () => {\n    if (loop.looping) {\n      loop.stop();\n    } else {\n      loop.start(simpleGame.handleSurvivalLoop);\n    }\n  }, [loop, simpleGame]);\n\n  const handleClickCaptureMasks = useCallback(() => {\n    if (loop.looping) {\n      loop.stop();\n    } else {\n      loop.start(captureMasks.handleLoop());\n    }\n  }, [loop, captureMasks]);\n\n  const survival = useMemo(\n    () => ({\n      name: 'survival',\n      loop,\n      simpleGame,\n      lapTimeInfo,\n      resultsText,\n      captureMasks,\n      handleClickGame,\n      handleClickCaptureMasks,\n    }),\n    [\n      loop,\n      simpleGame,\n      lapTimeInfo,\n      resultsText,\n      captureMasks,\n      handleClickGame,\n      handleClickCaptureMasks,\n    ],\n  );\n\n  return survival;\n};\n","import PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport React, { useCallback, useMemo, useState } from 'react';\n\nimport { CircularProgress, makeStyles } from '@material-ui/core';\n\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\nimport IconButton from '@material-ui/core/IconButton';\n\nimport PlayIcon from '@material-ui/icons/PlayCircleOutline';\nimport HelpIcon from '@material-ui/icons/Help';\nimport ReplayIcon from '@material-ui/icons/Replay';\n\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    position: 'relative',\n    padding: theme.spacing(1),\n    paddingRight: theme.spacing(5),\n    paddingLeft: theme.spacing(5),\n    background: 'rgba(255,255,255,0.95)',\n    marginTop: theme.spacing(2),\n    textAlign: 'center',\n    '& h2': {\n      marginBottom: theme.spacing(4),\n    },\n    '& h3': {\n      marginBottom: theme.spacing(1),\n    },\n  },\n  help: {\n    maxHeight: 200,\n    marginTop: theme.spacing(2),\n    '& > div > p': {\n      marginBottom: theme.spacing(1),\n      fontSize: 16,\n    },\n  },\n  helpBtn: {\n    position: 'absolute',\n    bottom: theme.spacing(1),\n    right: theme.spacing(1),\n  },\n  icon: {\n    fontSize: 50,\n  },\n  marginTop: {\n    marginTop: theme.spacing(2),\n  },\n}));\n\nconst GameInfoBox = ({\n  headerContent,\n  middleContent,\n  footerContent,\n  primaryText,\n  secondaryText,\n  helpContent,\n  iconProps: { loading: isLoading, ...iconProps } = {},\n  Icon,\n}) => {\n  const [showHelp, setShowHelp] = useState(false);\n  const toggleHelp = useCallback(() => {\n    setShowHelp((a) => !a);\n  }, []);\n\n  const classes = useStyles();\n\n  const IconComponent = useMemo(\n    () => (isLoading ? CircularProgress : { play: PlayIcon, replay: ReplayIcon }[Icon] || Icon),\n    [Icon, isLoading],\n  );\n\n  return (\n    <Paper className={classes.paper}>\n      {headerContent}\n      {primaryText && (\n        <Typography component=\"h3\" variant=\"h5\">\n          {primaryText}\n        </Typography>\n      )}\n      {middleContent}\n      {secondaryText && (\n        <Typography\n          component=\"h4\"\n          variant=\"h6\"\n          className={classNames(classes.subtext, {\n            [classes.marginTop]: middleContent,\n          })}\n        >\n          {secondaryText}\n        </Typography>\n      )}\n      {IconComponent && (\n        <IconButton size=\"medium\" disabled={isLoading} {...iconProps}>\n          <IconComponent className={classes.icon} color={iconProps.color || 'primary'} />\n        </IconButton>\n      )}\n      {footerContent}\n      {helpContent && (\n        <div className={classes.help}>\n          {showHelp && (\n            <div className={classes.helpContent}>\n              {Array.isArray(helpContent) ? (\n                <>\n                  {helpContent.map((text) => (\n                    <p key={text}>{text}</p>\n                  ))}\n                </>\n              ) : (\n                helpContent\n              )}\n            </div>\n          )}\n          <IconButton size=\"small\" className={classes.helpBtn} onClick={toggleHelp}>\n            <HelpIcon />\n          </IconButton>\n        </div>\n      )}\n    </Paper>\n  );\n};\n\nGameInfoBox.propTypes = {\n  headerContent: PropTypes.node,\n  primaryText: PropTypes.string,\n  secondaryText: PropTypes.string,\n  children: PropTypes.node,\n  helpContent: PropTypes.node,\n  footerContent: PropTypes.node,\n  iconProps: PropTypes.object,\n  Icon: PropTypes.node,\n};\n\nexport default GameInfoBox;\n","import React from 'react';\nimport classnames from 'classnames';\nimport { makeStyles } from '@material-ui/core';\n\nimport ProgressBar from '../../ProgressBar';\nimport SurvivalFooter from './SurvivalFooter';\nimport { useGameMode } from '../../Game';\nimport { useSurvival } from '../../../hooks/screenHooks/survival';\nimport { useWebcam } from '../../../context/webcam';\nimport GameInfoBox from '../../GameInfoBox';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    padding: theme.spacing(1),\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'column',\n  },\n  overlay: {\n    background: 'rgba(255,255,255,0.5)',\n  },\n  options: {\n    display: 'flex',\n    alignItems: 'center',\n    flexDirection: 'column',\n    justifyContent: 'space-between',\n    marginBottom: theme.spacing(1),\n    '& > *': {\n      marginTop: theme.spacing(2),\n    },\n  },\n  optionsTop: {\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'row',\n    width: '100%',\n    paddingLeft: theme.spacing(10),\n    paddingRight: theme.spacing(10),\n  },\n  progress: {\n    position: 'absolute',\n    top: theme.spacing(1),\n    left: theme.spacing(8),\n    right: theme.spacing(8),\n  },\n}));\n\nexport const getSurvivalPaperProps = (_, ind, masks) =>\n  ind === masks.length - 1\n    ? {\n        style: { background: 'rgba(255, 0, 0, 0.4)' },\n      }\n    : {};\n\nconst Survival = (props) => {\n  const classes = useStyles();\n  const survival = useGameMode(useSurvival);\n  const webcam = useWebcam();\n  const { loop, lapTimeInfo, handleClickGame } = survival;\n\n  // TODO: add an animation for the screen content on page transition\n\n  return (\n    <div\n      className={classnames(classes.root, {\n        [classes.overlay]: !loop.looping,\n      })}\n    >\n      <div\n        className={classnames(classes.options, {\n          [classes.optionsTop]: !!loop.looping,\n        })}\n      >\n        {loop.looping ? (\n          <div className={classes.progress}>\n            <ProgressBar color={lapTimeInfo.color} completed={lapTimeInfo.percentRemaining} />\n          </div>\n        ) : (\n          <GameInfoBox\n            primaryText=\"Survival\"\n            secondaryText=\"Match the poses and survive as long as you can.\"\n            middleContent={webcam.isFullScreen && <SurvivalFooter />}\n            Icon=\"play\"\n            iconProps={{\n              onClick: handleClickGame,\n              loading: !loop.ready,\n              color: 'secondary',\n            }}\n            helpContent={[\n              'You will have a limited number of time to match each pose.',\n              'Successfully match a pose by being within its lines when the timer runs out.',\n              'If your score is high enough, you will move on to the next round.',\n              'You will have less time each round.',\n              'How long can you survive?',\n            ]}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Survival;\n","import React from 'react';\n\nimport ScoreResults from '../../ScoreResults';\nimport { useGame } from '../../Game';\nimport { getSurvivalPaperProps } from './Survival';\n\nconst SurvivalFooter = (props) => {\n  const game = useGame();\n  if (!game.mode) return null;\n\n  const { simpleGame, resultsText } = game.mode;\n\n  return (\n    !game.loop.looping && (\n      <ScoreResults\n        label={resultsText}\n        getImageChild={null}\n        results={simpleGame.scores}\n        handleClose={simpleGame.clearScores}\n        getPaperProps={getSurvivalPaperProps}\n      />\n    )\n  );\n};\n\nexport default SurvivalFooter;\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core';\n\nimport ScoreResults from '../../ScoreResults';\nimport { useGame } from '../../Game';\n\nconst useStyles = makeStyles((theme) => ({\n  root: ({ isFullScreen }) => ({\n    minWidth: isFullScreen ? '50%' : 'auto',\n    '& > div:first-of-type': {\n      marginTop: theme.spacing(2),\n      marginBottom: theme.spacing(2),\n    },\n  }),\n}));\n\nconst MultiplayerFooter = (props) => {\n  const game = useGame();\n  const classes = useStyles(props);\n\n  if (!game.mode) return null;\n  const { simpleGame, multiplayerResultsText } = game.mode;\n\n  return (\n    !game.loop.looping && (\n      <div className={classes.root}>\n        <ScoreResults label={multiplayerResultsText[0]} results={simpleGame.multiplayerScores[0]} />\n        <ScoreResults label={multiplayerResultsText[1]} results={simpleGame.multiplayerScores[1]} />\n      </div>\n    )\n  );\n};\n\nexport default MultiplayerFooter;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { screenStates } from '../../lib/screenConstants';\n\nimport Null from '../Null';\nimport { maxWidth } from '../../lib/constants';\nimport { makeStyles } from '@material-ui/styles';\nimport BasicFooter from './SinglePlayer/BasicFooter';\nimport SurvivalFooter from './SinglePlayer/SurvivalFooter';\nimport MultiplayerFooter from './MultiPlayer/MultiplayerFooter';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    maxWidth,\n    margin: '0 auto',\n    paddingLeft: theme.spacing(2),\n    paddingRight: theme.spacing(2),\n    '& > div': {\n      marginTop: theme.spacing(2),\n    },\n  },\n}));\n\nconst Footers = {\n  [screenStates.screen.PLAY]: {\n    [screenStates.players.SINGLE_PLAYER]: {\n      [screenStates.mode[screenStates.players.SINGLE_PLAYER].PRACTICE]: BasicFooter,\n      [screenStates.mode[screenStates.players.SINGLE_PLAYER].SURVIVAL]: SurvivalFooter,\n      [screenStates.mode[screenStates.players.SINGLE_PLAYER].TIME_ATTACK]: BasicFooter,\n    },\n    [screenStates.players.MULTIPLAYER]: {\n      [screenStates.mode[screenStates.players.MULTIPLAYER].LOCAL]: MultiplayerFooter,\n      [screenStates.mode[screenStates.players.MULTIPLAYER].REMOTE]: () => 'REMOTE footer',\n    },\n  },\n};\n\nconst ScreenFooter = (props) => {\n  const classes = useStyles();\n\n  const { screen, players, mode } = props.screen.state;\n\n  const Footer = Footers[screen]?.[players]?.[mode] || Null;\n\n  return (\n    <div className={classes.root}>\n      <Footer />\n    </div>\n  );\n};\n\nScreenFooter.propTypes = {\n  screen: PropTypes.object.isRequired,\n};\n\nexport default ScreenFooter;\n","import React from 'react';\nimport classnames from 'classnames';\nimport Button from '@material-ui/core/Button';\nimport { IconButton, makeStyles, Typography } from '@material-ui/core';\nimport { animated, useTrail, config } from 'react-spring';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    flexDirection: 'column',\n    justifyContent: 'space-between',\n    marginBottom: theme.spacing(1),\n    '& > div > *': {\n      marginTop: theme.spacing(2),\n    },\n  },\n  buttons: {\n    display: 'flex',\n  },\n  h: {\n    flexDirection: 'row',\n  },\n  v: {\n    flexDirection: 'column',\n  },\n  minWidth: {\n    minWidth: 150,\n  },\n  label: {\n    color: 'white',\n    fontWeight: 'bold',\n    background: theme.palette.primary.main,\n    padding: theme.spacing(1),\n    borderRadius: theme.spacing(1),\n    border: `${theme.spacing(0.5)}px solid white`,\n  },\n  icon: {\n    fontSize: 120,\n    border: `${theme.spacing(0.5)}px solid white`,\n    borderRadius: '50%',\n    padding: theme.spacing(1),\n    background: theme.palette.secondary.main,\n    color: 'white',\n  },\n}));\n\nconst getConfig = (offset) => ({\n  transform: 'translate3d(0,0px,0)',\n  from: { transform: `translate3d(0,-${offset}px,0)` },\n  config: config.wobbly,\n});\n\nconst Options = (props) => {\n  const classes = useStyles();\n  const trail = useTrail(props.buttons.length, getConfig(props.offset || 100));\n  const labelTrail = useTrail(1, getConfig((props.offset || 100) + 200));\n\n  return (\n    <div className={classes.root}>\n      {props.label &&\n        labelTrail.map((styleProps, idx) => (\n          <animated.div style={styleProps}>\n            <Typography component=\"h2\" variant=\"h3\" className={classes.label}>\n              {props.label}\n            </Typography>\n          </animated.div>\n        ))}\n      <div\n        className={classnames(classes.buttons, {\n          [classes.h]: props.layout === 'h',\n          [classes.v]: props.layout !== 'h',\n        })}\n      >\n        {trail.map((styleProps, idx) => {\n          const {\n            Component,\n            visible = true,\n            props: { Icon, ...componentProps } = {},\n          } = props.buttons[idx];\n\n          return visible ? (\n            <animated.div key={componentProps.key} style={styleProps}>\n              {Component ? (\n                <Component {...componentProps} />\n              ) : Icon ? (\n                <IconButton\n                  size=\"large\"\n                  variant=\"contained\"\n                  className={classes.iconButton}\n                  {...componentProps}\n                >\n                  <Icon className={classes.icon} />\n                </IconButton>\n              ) : (\n                <Button\n                  color=\"primary\"\n                  variant=\"contained\"\n                  {...componentProps}\n                  className={classes.minWidth}\n                />\n              )}\n            </animated.div>\n          ) : null;\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default Options;\n","import PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/styles';\nimport React, { useCallback, useMemo } from 'react';\nimport { useCarbon } from '../context/carbon';\nimport { screenStatesArrays, wipScreens } from '../lib/screenConstants';\n\nimport Options from './Options';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    flexDirection: 'column',\n    '& button': {\n      marginTop: theme.spacing(2),\n    },\n  },\n  gameMode: {\n    textAlign: 'center',\n  },\n  header: {\n    marginTop: theme.spacing(4),\n    marginBottom: theme.spacing(2),\n  },\n}));\n\nconst SelectGameMode = (props) => {\n  const classes = useStyles();\n  const { carbonState } = useCarbon();\n\n  const handleSetGameMode = useCallback(\n    ({ currentTarget: { name } }) => {\n      props.screen.handlers.setGameMode(name);\n    },\n    [props.screen.handlers],\n  );\n\n  const buttons = useMemo(\n    () =>\n      screenStatesArrays.mode[props.screen.state.players]\n        ?.map((gameMode) => ({\n          props: {\n            key: gameMode,\n            name: gameMode,\n            children: gameMode,\n            onClick: handleSetGameMode,\n            disabled: !!wipScreens[gameMode],\n          },\n        }))\n        .filter((obj) => (!carbonState ? obj.props.name !== 'Practice' : true)), // Only show Practice in Carbonate mode.\n    [props.screen.state.players, handleSetGameMode, carbonState],\n  );\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.gameMode}>\n        <Options buttons={buttons} />\n      </div>\n    </div>\n  );\n};\n\nSelectGameMode.propTypes = {\n  screen: PropTypes.object.isRequired,\n};\n\nexport default SelectGameMode;\n","import PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/styles';\nimport React, { useCallback, useRef } from 'react';\n\nimport Button from '@material-ui/core/Button';\n\nconst useStyles = makeStyles((theme) => ({\n  fileInput: {\n    display: 'none',\n  },\n}));\n\nconst FileUpload = ({ onChange, multiple, children, filter, ...buttonProps }) => {\n  const classes = useStyles();\n\n  const fileRef = useRef();\n\n  const handleFileUpload = useCallback(\n    (fileObject) => {\n      if (!fileObject) return;\n\n      const disallowMultiple = multiple === false;\n      const allFiles = fileObject.target ? Array.from(fileObject.target.files) : fileObject.files;\n      let filteredFiles = filter ? allFiles.filter(filter) : allFiles;\n\n      if (disallowMultiple && filteredFiles.length > 1) {\n        filteredFiles = filteredFiles.slice(0, 1);\n      }\n\n      onChange(filteredFiles);\n    },\n    [onChange, multiple, filter],\n  );\n\n  const resetFile = useCallback(() => {\n    fileRef.current.value = null;\n  }, [fileRef]);\n\n  return (\n    <Button component=\"label\" {...buttonProps}>\n      {children}\n      <input\n        type=\"file\"\n        ref={fileRef}\n        className={classes.fileInput}\n        onClick={resetFile}\n        onChange={handleFileUpload}\n        multiple={multiple !== false}\n      />\n    </Button>\n  );\n};\n\nFileUpload.propTypes = {\n  multiple: PropTypes.bool,\n  filterFiles: PropTypes.func,\n  buttonProps: PropTypes.object,\n  onChange: PropTypes.func.isRequired,\n};\n\nexport default FileUpload;\n","import PropTypes from 'prop-types';\nimport Menu from '@material-ui/core/Menu';\nimport Button from '@material-ui/core/Button';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useRef, useCallback, useEffect, useState } from 'react';\n\nimport { numShippedMasks } from '../lib/constants';\n\nconst useStyles = makeStyles((theme) => ({\n  item: (width) => ({\n    minWidth: width - theme.spacing(4),\n    textAlign: 'center',\n  }),\n}));\n\nconst GameSelect = (props) => {\n  const [width, setWidth] = useState(0);\n  const classes = useStyles(width);\n\n  const ref = useRef();\n  useEffect(() => {\n    if (ref.current) {\n      setWidth(ref.current.clientWidth);\n    }\n  }, []);\n\n  const [anchorEl, setAnchorEl] = React.useState(null);\n\n  const handleOpen = useCallback((event) => {\n    setAnchorEl(event.currentTarget);\n  }, []);\n\n  const handleClose = useCallback(() => {\n    setAnchorEl(null);\n  }, []);\n\n  const handleClick = useCallback(\n    (name) => () => {\n      props.handleClick(name);\n      handleClose();\n    },\n    [props, handleClose],\n  );\n\n  return (\n    <>\n      <div ref={ref}>\n        <Button\n          fullWidth={true}\n          variant=\"contained\"\n          aria-haspopup=\"true\"\n          onClick={handleOpen}\n          aria-controls=\"mask-menu\"\n          disabled={props.disabled}\n        >\n          Select Masks\n        </Button>\n      </div>\n      <Menu\n        id=\"mask-menu\"\n        keepMounted={true}\n        anchorEl={anchorEl}\n        getContentAnchorEl={null}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'center',\n        }}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'center',\n        }}\n        onClose={handleClose}\n        open={Boolean(anchorEl)}\n        container={props.containerRef.current || null}\n      >\n        {Array.from({ length: numShippedMasks }).map((_, idx) => (\n          <MenuItem key={idx} button={true} onClick={handleClick(`set${idx + 1}.zip`)}>\n            <span className={classes.item}>Game {idx + 1}</span>\n          </MenuItem>\n        ))}\n      </Menu>\n    </>\n  );\n};\n\nGameSelect.propTypes = {\n  value: PropTypes.string,\n  containerRef: PropTypes.object,\n  disabled: PropTypes.bool.isRequired,\n  handleClick: PropTypes.func.isRequired,\n};\n\nexport default GameSelect;\n","import { useMemo, useCallback, useState, useEffect } from 'react';\n\nimport { useWebcam } from '../../context/webcam';\nimport { useSimpleGame } from '../loopHandlers/simpleGame';\nimport { useCaptureMasks } from '../loopHandlers/captureMasks';\nimport { initialLapInfo } from '../lapTimer';\n\nexport const usePractice = (loop) => {\n  const webcam = useWebcam();\n  const [lapTimeInfo, setLapTimeInfo] = useState(initialLapInfo);\n  const simpleGame = useSimpleGame({ setLapTimeInfo });\n  const captureMasks = useCaptureMasks({ setLapTimeInfo });\n  const [loopType, setLoopType] = useState(null);\n\n  useEffect(() => {\n    if (!loop.looping && loopType) {\n      setLoopType(null);\n    }\n  }, [loop.looping, loopType]);\n\n  const handleClickGame = useCallback(async () => {\n    if (loop.looping) {\n      loop.stop();\n      simpleGame.reset();\n    } else {\n      loop.start(simpleGame.handleLoop);\n      setLoopType('play');\n    }\n  }, [loop, simpleGame]);\n\n  const handleStartRandomGame = useCallback(async () => {\n    if (loop.looping) return;\n\n    await simpleGame.zip.handleLoadRandomMaskSet();\n    handleClickGame();\n  }, [handleClickGame, loop.looping, simpleGame.zip]);\n\n  const handleClickCaptureMasks = useCallback(() => {\n    if (loop.looping) {\n      loop.stop();\n      simpleGame.reset();\n    } else {\n      loop.start(captureMasks.handleLoop());\n      setLoopType('capture');\n    }\n  }, [loop, captureMasks, simpleGame]);\n\n  const handlePlayCapturedMasks = useCallback(async () => {\n    if (loop.looping) return;\n\n    const masks = await Promise.all(\n      captureMasks.masks.map(({ overlay }) => webcam.dataUriToImageData(overlay)),\n    );\n    simpleGame.setMasks(masks);\n    handleClickGame();\n  }, [captureMasks.masks, simpleGame, webcam, handleClickGame, loop.looping]);\n\n  const practice = useMemo(\n    () => ({\n      name: 'practice',\n      loopType,\n      simpleGame,\n      lapTimeInfo,\n      captureMasks,\n      handleClickGame,\n      handleStartRandomGame,\n      handlePlayCapturedMasks,\n      handleClickCaptureMasks,\n    }),\n    [\n      loopType,\n      simpleGame,\n      lapTimeInfo,\n      captureMasks,\n      handleClickGame,\n      handleStartRandomGame,\n      handlePlayCapturedMasks,\n      handleClickCaptureMasks,\n    ],\n  );\n\n  return practice;\n};\n","import classnames from 'classnames';\nimport React, { useRef, useMemo } from 'react';\nimport { makeStyles } from '@material-ui/core';\n\nimport Options from '../../Options';\nimport BasicFooter from './BasicFooter';\nimport FileUpload from '../../FileUpload';\nimport GameSelect from '../../GameSelect';\nimport ProgressBar from '../../ProgressBar';\n\nimport { useGame, useGameMode } from '../../Game';\nimport { useWebcam } from '../../../context/webcam';\nimport { usePractice } from '../../../hooks/screenHooks/practice';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    width: '100%',\n    height: '100%',\n    overflow: 'hidden',\n    position: 'relative',\n  },\n  scrollContainer: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: -17,\n    overflowY: 'scroll',\n    padding: theme.spacing(1),\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'column',\n  },\n  overlay: {\n    background: 'rgba(255,255,255,0.5)',\n  },\n  rootTop: {\n    justifyContent: 'flex-start',\n  },\n  rootApart: {\n    justifyContent: 'space-between',\n  },\n  optionsTop: {\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'row',\n    width: '100%',\n    paddingLeft: theme.spacing(10),\n    paddingRight: theme.spacing(10),\n  },\n  captures: {\n    width: '100%',\n    '& > div': {\n      marginTop: theme.spacing(1),\n    },\n  },\n  progress: {\n    position: 'absolute',\n    top: theme.spacing(1),\n    left: theme.spacing(8),\n    right: theme.spacing(8),\n  },\n}));\n\nconst Practice = (props) => {\n  const classes = useStyles();\n\n  const game = useGame();\n  const webcam = useWebcam();\n  const containerRef = useRef();\n  const practice = useGameMode(usePractice);\n\n  const {\n    loopType,\n    lapTimeInfo,\n    simpleGame,\n    captureMasks,\n    handleClickGame,\n    handleStartRandomGame,\n    handleClickCaptureMasks,\n  } = practice;\n\n  const { loop } = game;\n\n  const timerColor = lapTimeInfo.color;\n\n  const buttons = useMemo(\n    () => [\n      {\n        props: {\n          key: 'play/stop',\n          onClick: handleClickGame,\n          disabled: !loop.ready || (!loop.looping && !simpleGame.ready),\n          children: loop.looping ? 'Stop' : 'Play',\n        },\n      },\n      {\n        props: {\n          key: 'playRandom',\n          color: 'secondary',\n          onClick: handleStartRandomGame,\n          disabled: !loop.ready || loop.looping,\n          children: 'Play Random',\n        },\n      },\n      {\n        props: {\n          containerRef,\n          key: 'chooseMasks',\n          disabled: !loop.ready || loop.looping,\n          handleClick: simpleGame.zip.handleLoadPreparedMasks,\n        },\n        Component: GameSelect,\n        visible: !loop.looping,\n      },\n      {\n        props: {\n          key: 'loadMasks',\n          variant: 'contained',\n          onChange: simpleGame.zip.handleZipInputChange,\n          disabled: !loop.ready || loop.looping || simpleGame.zip.loading,\n          children: simpleGame.loading ? 'Loading...' : 'Load Masks',\n        },\n        Component: FileUpload,\n        visible: !loop.looping,\n      },\n      {\n        props: {\n          key: 'captureMasks',\n          onClick: handleClickCaptureMasks,\n          disabled: !loop.ready || loop.looping,\n          children: 'Capture Masks',\n          color: 'default',\n        },\n        visible: !loop.looping,\n      },\n    ],\n    [\n      loop.ready,\n      loop.looping,\n      handleClickGame,\n      simpleGame.ready,\n      simpleGame.loading,\n      handleStartRandomGame,\n      simpleGame.zip.loading,\n      handleClickCaptureMasks,\n      simpleGame.zip.handleZipInputChange,\n      simpleGame.zip.handleLoadPreparedMasks,\n    ],\n  );\n\n  return (\n    <div className={classes.root}>\n      <div\n        className={classnames(classes.scrollContainer, {\n          [classes.overlay]: !loop.looping,\n          [classes.rootTop]: !!loop.looping,\n          [classes.rootApart]:\n            !!(simpleGame.scores?.length || captureMasks.masks?.length) && webcam.isFullScreen,\n        })}\n      >\n        <div\n          className={classnames({\n            [classes.optionsTop]: !!loop.looping,\n          })}\n          ref={containerRef}\n        >\n          {loop.looping ? (\n            <Options\n              offset={70}\n              buttons={[\n                {\n                  props: {\n                    key: 'stop',\n                    onClick: handleClickGame,\n                    children: 'Stop',\n                  },\n                },\n              ]}\n            />\n          ) : (\n            <Options buttons={buttons} />\n          )}\n          {loop.looping && loopType === 'play' && (\n            <div className={classes.progress}>\n              <ProgressBar color={timerColor} completed={lapTimeInfo.percentRemaining} />\n            </div>\n          )}\n        </div>\n        {webcam.isFullScreen && !loop.looping && <BasicFooter />}\n      </div>\n    </div>\n  );\n};\n\nexport default Practice;\n","import PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/styles';\nimport React, { useCallback, useMemo } from 'react';\n\nimport PersonIcon from '@material-ui/icons/Person';\nimport PeopleAltIcon from '@material-ui/icons/PeopleAlt';\n\nimport Options from './Options';\nimport { screenStates, screenStatesArrays, wipScreens } from '../lib/screenConstants';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    flexDirection: 'column',\n    justifyContent: 'center',\n  },\n  transition: {\n    textAlign: 'center',\n  },\n  header: {\n    marginBottom: theme.spacing(2),\n  },\n}));\n\nconst Icons = {\n  [screenStates.players.SINGLE_PLAYER]: PersonIcon,\n  [screenStates.players.MULTIPLAYER]: PeopleAltIcon,\n};\n\nconst ChoosePlayers = (props) => {\n  const classes = useStyles();\n\n  const handleSetPlayerMode = useCallback(\n    ({ currentTarget: { name } }) => {\n      props.setPlayerMode(name);\n    },\n    [props],\n  );\n\n  const buttons = useMemo(\n    () =>\n      screenStatesArrays.players.map((playerMode) => ({\n        props: {\n          key: playerMode,\n          name: playerMode,\n          children: playerMode,\n          onClick: handleSetPlayerMode,\n          disabled: !!wipScreens[playerMode],\n          Icon: Icons[playerMode],\n        },\n      })),\n    [handleSetPlayerMode],\n  );\n\n  return (\n    <div className={classes.root}>\n      <Options label=\"Select Players\" buttons={buttons} layout=\"h\" />\n    </div>\n  );\n};\n\nChoosePlayers.propTypes = {\n  setPlayerMode: PropTypes.func.isRequired,\n};\n\nexport default ChoosePlayers;\n","import { useMemo, useCallback } from 'react';\n\nimport { useSimpleGame } from '../loopHandlers/simpleGame';\nimport { useRef } from 'react';\nimport { useEffect } from 'react';\n\nexport const useTimeAttack = (loop) => {\n  const simpleGame = useSimpleGame();\n\n  const loadedRef = useRef(false);\n\n  const resultsText = useMemo(() => {\n    let total =\n      simpleGame.scores.length && !loop.looping\n        ? simpleGame.scores.reduce((acc, { score }) => acc + score, 0)\n        : 0;\n    const average = +total.toFixed(1) / simpleGame.scores.length;\n\n    return `You finished Time Attack in ${total.toFixed(1)}\n      seconds, averaging ${average.toFixed(1)} seconds per pose!`;\n  }, [simpleGame, loop]);\n\n  useEffect(() => {\n    if (!loadedRef.current) {\n      loadedRef.current = true;\n      simpleGame.zip.handleLoadPreparedMasks('adam_custom_mask_stuff.zip');\n    }\n  }, [simpleGame]);\n\n  const handleClickGame = useCallback(async () => {\n    if (loop.looping) {\n      loop.stop();\n      simpleGame.reset();\n    } else {\n      loop.start(simpleGame.handleTimeAttackLoop);\n    }\n  }, [loop, simpleGame]);\n\n  const timeAttack = useMemo(\n    () => ({\n      name: 'time attack',\n      simpleGame,\n      resultsText,\n      handleClickGame,\n    }),\n    [simpleGame, resultsText, handleClickGame],\n  );\n\n  return timeAttack;\n};\n","import React from 'react';\nimport classnames from 'classnames';\nimport { makeStyles } from '@material-ui/core';\n\nimport BasicFooter from './BasicFooter';\n\nimport { useGame, useGameMode } from '../../Game';\nimport { useWebcam } from '../../../context/webcam';\nimport { useTimeAttack } from '../../../hooks/screenHooks/timeAttack';\nimport GameInfoBox from '../../GameInfoBox';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    width: '100%',\n    height: '100%',\n    overflow: 'hidden',\n    position: 'relative',\n  },\n  scrollContainer: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: -17,\n    overflowY: 'scroll',\n    padding: theme.spacing(1),\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'column',\n  },\n  overlay: {\n    background: 'rgba(255,255,255,0.5)',\n  },\n  optionsTop: {\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'row',\n    width: '100%',\n    paddingLeft: theme.spacing(10),\n    paddingRight: theme.spacing(10),\n  },\n  screen: {\n    textAlign: 'center',\n    '& > button': {\n      marginTop: theme.spacing(2),\n    },\n  },\n}));\n\nconst TimeAttack = (props) => {\n  const classes = useStyles();\n\n  const game = useGame();\n  const webcam = useWebcam();\n  const timeAttack = useGameMode(useTimeAttack);\n\n  const { simpleGame, handleClickGame } = timeAttack;\n\n  const { loop } = game;\n  // TODO: add an animation for the screen content on page transition\n\n  return (\n    <div className={classes.root}>\n      <div\n        className={classnames(classes.scrollContainer, {\n          [classes.overlay]: !loop.looping,\n        })}\n      >\n        <div\n          className={classnames(classes.screen, {\n            [classes.optionsTop]: !!loop.looping,\n          })}\n        >\n          {!loop.looping && (\n            <GameInfoBox\n              primaryText=\"Time Attack\"\n              secondaryText={\n                simpleGame.scores?.length ? 'Play Again?' : 'Match the poses as quickly as you can.'\n              }\n              Icon={simpleGame.scores?.length ? 'replay' : 'play'}\n              iconProps={{\n                color: 'secondary',\n                loading: !loop.ready,\n                onClick: handleClickGame,\n              }}\n              middleContent={webcam.isFullScreen && <BasicFooter hideClose={true} />}\n              helpContent={[\n                'Match each pose as quickly as possible',\n                'Your score is based on your total time, and the average time per pose.',\n                'Hop to it!',\n              ]}\n            />\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default TimeAttack;\n","import { useMemo, useCallback, useState } from 'react';\n\nimport { useWebcam } from '../../context/webcam';\nimport { useSimpleGame } from '../loopHandlers/simpleGame';\nimport { useCaptureMasks } from '../loopHandlers/captureMasks';\nimport { initialLapInfo } from '../lapTimer';\nimport { DEBUG } from '../../lib/constants';\n\nconst NUM_MASKS = DEBUG ? 1 : 5;\n\nexport const useLocal = (loop) => {\n  const webcam = useWebcam();\n  const [lapTimeInfo, setLapTimeInfo] = useState(initialLapInfo);\n  const simpleGame = useSimpleGame({ setLapTimeInfo });\n  const captureMasks = useCaptureMasks({ maxMasks: NUM_MASKS, setLapTimeInfo });\n\n  const multiplayerScoreSums = useMemo(\n    () =>\n      simpleGame.multiplayerScores.map((scores) =>\n        scores.length && !loop.looping ? scores.reduce((acc, { score }) => acc + score, 0) : 0,\n      ),\n    [simpleGame, loop],\n  );\n\n  const multiplayerResultsText = useMemo(\n    () =>\n      multiplayerScoreSums.map(\n        (score, playerIdx) =>\n          `Player ${playerIdx ? 'Two' : 'One'} scored a total of ${score} points`,\n      ),\n    [multiplayerScoreSums],\n  );\n\n  const [masks, setMasks] = useState([[], []]);\n  const [setupProgress, setSetupProgress] = useState(0);\n  const incrementProgress = useCallback(() => {\n    setSetupProgress((_) => _ + 1);\n  }, []);\n\n  const handleCapture = useCallback(() => {\n    if (loop.looping) {\n      loop.stop();\n    } else {\n      incrementProgress();\n      loop.start(\n        captureMasks.handleLoop(async () => {\n          const imageData = await Promise.all(\n            captureMasks.getMasks().map(({ overlay }) => webcam.dataUriToImageData(overlay)),\n          );\n\n          if (setupProgress === 0) {\n            setMasks([imageData, []]);\n          } else if (setupProgress === 1) {\n            setMasks((state) => [[...state[0]], imageData]);\n          }\n          captureMasks.removeAllMasks();\n        }),\n      );\n    }\n  }, [loop, captureMasks, setupProgress, webcam, incrementProgress]);\n\n  const handlePlayGame = useCallback(() => {\n    const maskIndex = setupProgress === 2 ? 1 : 0;\n    const playerIndex = setupProgress === 2 ? 0 : 1;\n\n    simpleGame.setMasks(masks[maskIndex]);\n    loop.start(simpleGame.handleMultiplayerLoop(playerIndex));\n    incrementProgress();\n  }, [loop, masks, simpleGame, setupProgress, incrementProgress]);\n\n  const handleReset = useCallback(() => {\n    setSetupProgress(0);\n    simpleGame.clearScores();\n  }, [simpleGame]);\n\n  const handleClick = useCallback(() => {\n    if (loop.looping) return;\n\n    if (setupProgress < 2) {\n      handleCapture();\n    } else if (setupProgress < 4) {\n      handlePlayGame();\n    } else {\n      handleReset();\n    }\n  }, [loop.looping, handlePlayGame, handleCapture, handleReset, setupProgress]);\n\n  const local = useMemo(\n    () => ({\n      name: 'local',\n      simpleGame,\n      handleClick,\n      lapTimeInfo,\n      captureMasks,\n      setupProgress,\n      multiplayerResultsText,\n      multiplayerScoreSums,\n      NUM_MASKS,\n    }),\n    [\n      simpleGame,\n      lapTimeInfo,\n      captureMasks,\n      setupProgress,\n      handleClick,\n      multiplayerResultsText,\n      multiplayerScoreSums,\n    ],\n  );\n\n  return local;\n};\n","import React, { useMemo } from 'react';\nimport classnames from 'classnames';\nimport ProgressBar from '../../ProgressBar';\nimport { makeStyles } from '@material-ui/core';\n\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepLabel from '@material-ui/core/StepLabel';\nimport StepConnector from '@material-ui/core/StepConnector';\nimport CameraAltIcon from '@material-ui/icons/CameraAlt';\nimport EmojiPeopleIcon from '@material-ui/icons/EmojiPeople';\n\nimport { useGame, useGameMode } from '../../Game';\n\nimport { useLocal } from '../../../hooks/screenHooks/local';\nimport { useWebcam } from '../../../context/webcam';\nimport MultiplayerFooter from './MultiplayerFooter';\nimport GameInfoBox from '../../GameInfoBox';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    width: '100%',\n    height: '100%',\n    overflow: 'hidden',\n    position: 'relative',\n  },\n  scrollContainer: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: -17,\n    overflowY: 'scroll',\n    padding: theme.spacing(1),\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'column',\n  },\n  overlay: {\n    background: 'rgba(255,255,255,0.5)',\n  },\n  rootTop: {\n    justifyContent: 'flex-start',\n  },\n  rootApart: {\n    justifyContent: 'space-between',\n  },\n  optionsTop: {\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'row',\n    width: '100%',\n    paddingLeft: theme.spacing(10),\n    paddingRight: theme.spacing(10),\n  },\n  progress: {\n    position: 'absolute',\n    top: theme.spacing(1),\n    left: theme.spacing(8),\n    right: theme.spacing(8),\n  },\n  container: {\n    textAlign: 'center',\n  },\n  stepper: {\n    background: 'transparent',\n    marginBottom: theme.spacing(2),\n  },\n}));\n\nconst useColorlibStepIconStyles = makeStyles((theme) => ({\n  root: {\n    backgroundColor: '#ccc',\n    zIndex: 1,\n    color: '#fff',\n    width: 50,\n    height: 50,\n    display: 'flex',\n    borderRadius: '50%',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  active: {\n    backgroundImage: `linear-gradient( 136deg, ${theme.palette.secondary.light} 0%, ${theme.palette.secondary.main} 50%, ${theme.palette.secondary.dark} 100%)`,\n    boxShadow: '0 4px 10px 0 rgba(0,0,0,.25)',\n  },\n  completed: {\n    backgroundImage: `linear-gradient( 136deg, ${theme.palette.primary.light} 0%, ${theme.palette.primary.main} 50%, ${theme.palette.primary.dark} 100%)`,\n  },\n}));\n\nfunction ColorlibStepIcon(props) {\n  const classes = useColorlibStepIconStyles();\n  const { active, completed } = props;\n\n  const icons = {\n    1: <CameraAltIcon />,\n    2: <CameraAltIcon />,\n    3: <EmojiPeopleIcon />,\n    4: <EmojiPeopleIcon />,\n  };\n\n  return (\n    <div\n      className={classnames(classes.root, {\n        [classes.active]: active,\n        [classes.completed]: completed,\n      })}\n    >\n      {icons[String(props.icon)]}\n    </div>\n  );\n}\n\nconst stepperLabels = [\n  'Player One Capture',\n  'Player Two Capture',\n  'Player One Play',\n  'Player Two Play',\n];\n\nconst Local = (props) => {\n  const game = useGame();\n  const local = useGameMode(useLocal);\n  const webcam = useWebcam();\n\n  const [primary, secondary] = [\n    ['One', 'Two'],\n    ['Two', 'One'],\n  ][local.setupProgress % 2];\n\n  const text =\n    local.setupProgress < 2\n      ? `Player ${primary}, get ready to capture ${local.NUM_MASKS} poses.`\n      : `Player ${primary}, get ready to play!`;\n\n  const subtext =\n    local.setupProgress < 2 ? `Player ${secondary}, please leave the room.` : `Good luck!`;\n\n  const replayPhase = local.setupProgress >= 4;\n\n  const winnerText = useMemo(() => {\n    if (!replayPhase) return '';\n    if (local.multiplayerScoreSums[0] > local.multiplayerScoreSums[1]) return 'Player One wins!';\n    if (local.multiplayerScoreSums[0] < local.multiplayerScoreSums[1]) return 'Player Two wins!';\n    return \"It's a tie!\";\n  }, [local.multiplayerScoreSums, replayPhase]);\n\n  const classes = useStyles(replayPhase);\n\n  return (\n    <div className={classes.root}>\n      <div\n        className={classnames(classes.scrollContainer, {\n          [classes.overlay]: !game.loop.looping,\n          [classes.rootTop]: false,\n          [classes.rootApart]: !!false,\n        })}\n      >\n        <div\n          className={classnames(classes.container, {\n            [classes.optionsTop]: !!game.loop.looping,\n          })}\n        >\n          {!game.loop.looping ? (\n            <GameInfoBox\n              headerContent={\n                !replayPhase && (\n                  <Stepper\n                    className={classes.stepper}\n                    alternativeLabel\n                    activeStep={local.setupProgress}\n                    connector={<StepConnector />}\n                  >\n                    {stepperLabels.map((label) => (\n                      <Step key={label}>\n                        <StepLabel StepIconComponent={ColorlibStepIcon}>{label}</StepLabel>\n                      </Step>\n                    ))}\n                  </Stepper>\n                )\n              }\n              primaryText={replayPhase ? winnerText : text}\n              middleContent={\n                local.setupProgress >= 3 &&\n                webcam.isFullScreen &&\n                !game.loop.looping && <MultiplayerFooter isFullScreen={webcam.isFullScreen} />\n              }\n              secondaryText={replayPhase ? 'Play again?' : subtext}\n              iconProps={{\n                color: replayPhase ? 'primary' : 'secondary',\n                loading: !game.loop.ready,\n                onClick: local.handleClick,\n              }}\n              Icon={replayPhase ? 'replay' : 'play'}\n              helpContent={\n                !replayPhase && [\n                  'In this game mode two players will compete head to head.',\n                  'Each player will take turns capturing funky poses for their opponent to try and match.',\n                  \"The player who does the best job matching their opponent's poses will win.\",\n                ]\n              }\n            />\n          ) : (\n            <div className={classes.progress}>\n              <ProgressBar\n                color={local.lapTimeInfo.color}\n                completed={local.lapTimeInfo.percentRemaining}\n              />\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nLocal.propTypes = {};\n\nexport default Local;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { screenStates } from '../../lib/screenConstants';\n\nimport Null from '../Null';\nimport SelectGameMode from '../SelectGameMode';\nimport Practice from './SinglePlayer/Practice';\nimport Survival from './SinglePlayer/Survival';\nimport ChoosePlayers from '../ChoosePlayers';\nimport TimeAttack from './SinglePlayer/TimeAttack';\nimport Local from './MultiPlayer/Local';\n\nconst Screens = {\n  [screenStates.screen.PLAY]: {\n    [screenStates.players.SINGLE_PLAYER]: {\n      [screenStates.mode[screenStates.players.SINGLE_PLAYER].PRACTICE]: Practice,\n      [screenStates.mode[screenStates.players.SINGLE_PLAYER].SURVIVAL]: Survival,\n      [screenStates.mode[screenStates.players.SINGLE_PLAYER].TIME_ATTACK]: TimeAttack,\n    },\n    [screenStates.players.MULTIPLAYER]: {\n      [screenStates.mode[screenStates.players.MULTIPLAYER].LOCAL]: Local,\n      [screenStates.mode[screenStates.players.MULTIPLAYER].REMOTE]: () => 'REMOTE Content',\n    },\n  },\n};\n\nconst ScreenContent = (props) => {\n  const { screen, mode, players } = props.screen.state;\n\n  if (screen === screenStates.screen.DEFAULT)\n    return <ChoosePlayers setPlayerMode={props.screen.handlers.setPlayerMode} />;\n  if (mode === screenStates.mode.DEFAULT) return <SelectGameMode screen={props.screen} />;\n\n  const Content = Screens[screen]?.[players]?.[mode] || Null;\n\n  return <Content />;\n};\n\nScreenContent.propTypes = {\n  screen: PropTypes.object.isRequired,\n};\n\nexport default ScreenContent;\n","import { useReducer, useMemo, useCallback } from 'react';\n\nimport {\n  initialScreenState,\n  screenStates,\n  screenTypes,\n  screenStatesArrays,\n} from '../lib/screenConstants';\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case screenTypes.SET_GAME_MODE:\n      return { ...state, mode: action.value };\n    case screenTypes.SET_PLAYER_MODE:\n      return { ...state, screen: screenStates.screen.PLAY, players: action.value };\n    case screenTypes.RESET:\n      return initialScreenState;\n    case screenTypes.REVERSE: {\n      const newState = { ...state };\n      if (state.mode) {\n        newState.mode = screenStates.mode.DEFAULT;\n      } else if (state.screen !== screenStates.screen.DEFAULT) {\n        newState.screen = screenStates.screen.DEFAULT;\n        newState.players = screenStates.players.DEFAULT;\n      } else return state;\n\n      return newState;\n    }\n    default:\n      throw new Error(`Invalid action: ${action.type}`);\n  }\n};\n\nexport const useScreenController = () => {\n  const [screenState, dispatch] = useReducer(reducer, initialScreenState);\n\n  const setScreen = useCallback((screen) => {\n    if (!screenStatesArrays.screen.includes(screen)) {\n      throw new Error(`Unknown screen: ${screen}`);\n    }\n\n    dispatch({ type: screenTypes.SET_SCREEN, value: screen });\n  }, []);\n\n  const setGameMode = useCallback((gameMode) => {\n    if (\n      ![\n        ...screenStatesArrays.mode[screenStates.players.SINGLE_PLAYER],\n        ...screenStatesArrays.mode[screenStates.players.MULTIPLAYER],\n      ].includes(gameMode)\n    ) {\n      throw new Error(`Unknown gameMode: ${gameMode}`);\n    }\n\n    dispatch({ type: screenTypes.SET_GAME_MODE, value: gameMode });\n  }, []);\n\n  const setPlayerMode = useCallback((playerMode) => {\n    if (!screenStatesArrays.players.includes(playerMode)) {\n      throw new Error(`Unknown playerMode: ${playerMode}`);\n    }\n\n    // TODO: remove this hack\n    if (playerMode === screenStates.players.MULTIPLAYER) {\n      setGameMode(screenStates.mode[screenStates.players.MULTIPLAYER].LOCAL)\n    }\n    \n    dispatch({ type: screenTypes.SET_PLAYER_MODE, value: playerMode });\n  }, [setGameMode]);\n\n  const resetState = useCallback(() => {\n    dispatch({ type: screenTypes.RESET });\n  }, []);\n\n  const reverseState = useCallback(() => {\n    dispatch({ type: screenTypes.REVERSE });\n  }, []);\n\n  const handlers = useMemo(\n    () => ({\n      setScreen,\n      resetState,\n      setGameMode,\n      reverseState,\n      setPlayerMode,\n    }),\n    [setScreen, resetState, setGameMode, reverseState, setPlayerMode],\n  );\n\n  return [screenState, handlers];\n};\n","import { useRef, useState, useEffect, useCallback } from 'react';\n\nimport { useWebcam } from '../context/webcam';\n\n// eslint-disable-next-line import/no-webpack-loader-syntax\nimport BodyPixWorker from 'workerize-loader!../worker/bodyPix';\n\nconst bodyPixWorker = BodyPixWorker();\n\nexport const useBodyPixController = () => {\n  const webcam = useWebcam();\n\n  const loadRef = useRef();\n  const preloadRef = useRef();\n  const [netReady, setNetReady] = useState(false);\n  const [netPreloaded, setNetPreloaded] = useState(false);\n\n  // load the model on the first mount\n  useEffect(() => {\n    if (!loadRef.current && webcam.ready) {\n      loadRef.current = true;\n      bodyPixWorker\n        .load()\n        .then(() => {\n          console.log('BodyPix loaded');\n          setNetReady(true);\n        })\n        .catch(console.error);\n    }\n  }, [webcam]);\n\n  // TODO: Make it possible to tweak bodyPix settings\n  const predict = useCallback(async () => {\n    if (!netReady) {\n      throw new Error('Please wait for the model to load before calling \"predict\"');\n    }\n\n    const segmentation = await bodyPixWorker.predict(webcam.getVideoAsImageData());\n\n    // console.log({segmentation});\n\n    return segmentation;\n  }, [netReady, webcam]);\n\n  // pre load the model by running a first prediction\n  useEffect(() => {\n    if (netReady && !preloadRef.current && !netPreloaded) {\n      preloadRef.current = true;\n      predict().then(() => {\n        setNetPreloaded(true);\n      });\n    }\n  }, [predict, netReady, netPreloaded]);\n\n  // don't return the prediction fn until the model has processed the first frame\n  return netPreloaded ? predict : null;\n};\n","import React, { useContext, createContext } from 'react';\n\nimport { useBodyPixController } from '../hooks/bodyPixController';\n\nexport const bodyPixContext = createContext();\n\nexport const useBodyPix = () => {\n  const state = useContext(bodyPixContext);\n\n  // specifically check for undefined, not just truthy\n  // bc bodyPixController returns null before it is ready\n  if (state === undefined) {\n    throw new Error('useBodyPix must be used within a BodyPixProvider');\n  }\n\n  return state;\n};\n\nconst BodyPixProvider = ({ children }) => {\n  const context = useBodyPixController();\n\n  return <bodyPixContext.Provider value={context}>{children}</bodyPixContext.Provider>;\n};\n\nexport default BodyPixProvider;\n","import { useRef, useState, useCallback, useMemo } from 'react';\n\nimport { useLoopTime } from './loopTime';\nimport { useLapTimer } from './lapTimer';\nimport { useWebcam } from '../context/webcam';\nimport { useBodyPix } from '../context/bodyPix';\n\nexport const useLoop = () => {\n  const webcam = useWebcam();\n  const predict = useBodyPix();\n  const loopReady = predict && webcam.ready;\n\n  const loopTime = useLoopTime();\n  const lapTimer = useLapTimer();\n\n  const loopingRef = useRef();\n  const handleLoopRef = useRef();\n  const [looping, setLooping] = useState(false);\n\n  // set the flags to start the loop\n  const setStartLoop = useCallback(() => {\n    // we clear the lapTimer here as opposed to after \"stopping\" the loop to avoid async errors\n    lapTimer.clear();\n    loopTime.reset();\n    loopingRef.current = true;\n    setLooping(true);\n  }, [loopTime, lapTimer]);\n\n  // clear loop flags to trigger end of loop\n  // not synchronous, loop will terminate on next pass\n  const setStopLoop = useCallback(() => {\n    loopingRef.current = false;\n    setLooping(false);\n  }, []);\n\n  // fn passed to requestAnimationFrame\n  // keeps time and runs handleLoop fn passed to start\n  const loop = useCallback(\n    async (timestamp) => {\n      const time = loopTime.update(timestamp);\n      const controller = {\n        time,\n        webcam,\n        predict,\n        timerRef: lapTimer.timerRef,\n        useTimer: lapTimer.useTimer,\n        stop: setStopLoop,\n      };\n\n      const cleanup = await handleLoopRef.current(controller);\n\n      lapTimer.handleLap(controller);\n\n      if (loopingRef.current) {\n        requestAnimationFrame(loop);\n      } else {\n        setStopLoop();\n        handleLoopRef.current = null;\n        webcam.clearCanvas();\n        if (cleanup) cleanup();\n      }\n    },\n    [webcam, predict, lapTimer, loopTime, setStopLoop],\n  );\n\n  const start = useCallback(\n    async (handleLoop) => {\n      if (!loopReady) {\n        throw new Error('The loop is not ready');\n      } else if (loopingRef.current) {\n        throw new Error('The loop is already running');\n      } else if (!predict) {\n        throw new Error('Please wait for BodyPix to load...');\n      } else if (!handleLoop) {\n        throw new Error('A loop handler is required when calling loop.start');\n      }\n\n      handleLoopRef.current = handleLoop;\n      setStartLoop();\n\n      return requestAnimationFrame(loop);\n    },\n    [loop, predict, setStartLoop, loopReady],\n  );\n\n  const controller = useMemo(\n    () => ({\n      start,\n      looping,\n      ready: loopReady,\n      stop: setStopLoop,\n    }),\n    [start, looping, setStopLoop, loopReady],\n  );\n\n  return controller;\n};\n","import { useCallback, useRef, useMemo } from 'react';\n\nexport const useLoopTime = () => {\n  const lastTimeRef = useRef();\n  const startTimeRef = useRef();\n  const totalFramesRef = useRef();\n  const fpsSumRef = useRef();\n  const lapTime = useRef();\n\n  const reset = useCallback((timestamp = 0) => {\n    startTimeRef.current = timestamp;\n    lastTimeRef.current = timestamp;\n    fpsSumRef.current = 0;\n    totalFramesRef.current = 0;\n    lapTime.current = 0;\n  }, []);\n\n  const resetLapTime = useCallback(() => {\n    lapTime.current = 0;\n  }, []);\n\n  const update = useCallback(\n    (timestamp) => {\n      let first = false;\n      if (!startTimeRef.current) {\n        first = true;\n        reset(timestamp);\n      }\n\n      const deltaTime = timestamp - lastTimeRef.current;\n      lapTime.current += deltaTime;\n\n      let fps = 0;\n      let avgFps = 0;\n\n      // start calculating after the first loop to avoid dividing by 0\n      if (totalFramesRef.current++) {\n        fps = 1000 / deltaTime;\n        avgFps = fpsSumRef.current / totalFramesRef.current;\n        fpsSumRef.current += fps;\n      }\n\n      const elapsed = timestamp - startTimeRef.current;\n      lastTimeRef.current = timestamp;\n\n      return {\n        first,\n        timestamp,\n        fps,\n        avgFps,\n        elapsed,\n        frames: totalFramesRef.current,\n        lapTime: lapTime.current,\n        resetLapTime,\n      };\n    },\n    [reset, resetLapTime],\n  );\n\n  const controller = useMemo(() => ({ update, reset }), [update, reset]);\n\n  return controller;\n};\n","import { useCallback, useMemo, useRef, useState } from 'react';\n\nimport { useScreenController } from './screenController';\nimport { useEffect } from 'react';\nimport { screenStates } from '../lib/screenConstants';\nimport { useLoop } from './loop';\n\nconst TUTORIAL_LS_KEY = '__TUTORIAL_COMPLETE__';\n\nexport const useGameController = () => {\n  const loop = useLoop();\n  const [mode, setMode] = useState(null);\n  const [screenState, screenHandlers] = useScreenController();\n  const [tutorialCompleted, setTutorialCompleted] = useState(true);\n  const tutorialRef = useRef();\n\n  const markTutorialCompleted = useCallback(() => {\n    setTutorialCompleted(true);\n  }, []);\n\n  useEffect(() => {\n    if (tutorialRef.current) return;\n\n    const hasCompletedTutorial = !!localStorage.getItem(TUTORIAL_LS_KEY);\n\n    if (hasCompletedTutorial) return;\n\n    if (screenState.screen === screenStates.screen.DEFAULT) {\n      tutorialRef.current = true;\n      localStorage.setItem(TUTORIAL_LS_KEY, true);\n      setTutorialCompleted(false);\n    }\n  }, [screenState]);\n\n  useEffect(() => {\n    if (\n      (screenState.screen === screenStates.screen.DEFAULT ||\n        screenState.mode === screenStates.mode.DEFAULT) &&\n      mode\n    ) {\n      setMode(null);\n    }\n  }, [screenState, mode]);\n\n  useEffect(() => {\n    if (\n      (screenState.screen === screenStates.screen.DEFAULT ||\n        screenState.mode === screenStates.mode.DEFAULT) &&\n      loop.looping\n    ) {\n      loop.stop();\n    }\n  }, [screenState, loop]);\n\n  const gameController = useMemo(\n    () => ({\n      screen: {\n        state: screenState,\n        handlers: screenHandlers,\n      },\n      mode,\n      loop,\n      setMode,\n      tutorial: {\n        completed: tutorialCompleted,\n        markTutorialCompleted,\n      },\n    }),\n    [screenState, screenHandlers, mode, loop, tutorialCompleted, markTutorialCompleted],\n  );\n\n  return gameController;\n};\n","import PropTypes from 'prop-types';\nimport React, { memo, createContext, useContext, useEffect } from 'react';\n\nimport Webcam from './Webcam';\nimport GlobalHeader from './GlobalHeader';\nimport ScreenHeader from './GameScreens/ScreenHeader';\nimport ScreenFooter from './GameScreens/ScreenFooter';\nimport ScreenContent from './GameScreens/ScreenContent';\n\nimport { useGameController } from '../hooks/game';\n\nconst gameContext = createContext();\n\nexport const useGame = () => {\n  const state = useContext(gameContext);\n\n  if (!state) {\n    throw new Error('useGame must be called from inside the <Game> component.');\n  }\n\n  return state;\n};\n\nexport const useGameMode = (useGameModeHook) => {\n  const { loop, setMode } = useGame();\n  const gameMode = useGameModeHook(loop);\n\n  useEffect(() => {\n    setMode(gameMode);\n  }, [gameMode, setMode]);\n\n  return gameMode;\n};\n\nconst Game = ({ webcam }) => {\n  const game = useGameController();\n\n  return (\n    <gameContext.Provider value={game}>\n      <GlobalHeader\n        tutorial={game.tutorial}\n        mode={game.screen.state.mode}\n        screen={game.screen.state.screen}\n        players={game.screen.state.players}\n        goHome={game.screen.handlers.resetState}\n        goBack={game.screen.handlers.reverseState}\n      />\n      <ScreenHeader screenState={game.screen.state} />\n      <Webcam overlay={!game.screen.state.mode}>\n        <ScreenContent screen={game.screen} />\n      </Webcam>\n      <ScreenFooter screen={game.screen} />\n    </gameContext.Provider>\n  );\n};\n\nGame.propTypes = {\n  webcam: PropTypes.object.isRequired,\n};\n\nexport default memo(Game);\n","import React from 'react';\n\nconst NoWebcam = () => (\n  <div>Sorry, but this game requires a webcam. Please plug in a webcam and refresh the page.</div>\n);\n\nexport default NoWebcam;\n","import PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/styles';\nimport React, { useRef, useEffect, memo } from 'react';\n\nimport { useWebcam } from '../../context/webcam';\n\nimport Game from '../Game';\nimport NoWebcam from './NoWebcam';\nimport { maxWidth } from '../../lib/constants';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    maxWidth,\n    margin: `0 auto ${theme.spacing(2)}px`,\n  },\n}));\n\nconst Main = (props) => {\n  const webcam = useWebcam();\n  const { currentDeviceId, hasVideo, cameras, autoStartDeviceId } = webcam;\n\n  const startedRef = useRef();\n\n  useEffect(() => {\n    if (\n      hasVideo &&\n      cameras.length &&\n      (currentDeviceId || autoStartDeviceId) &&\n      !startedRef.current\n    ) {\n      startedRef.current = true;\n\n      webcam.start().catch(console.error);\n    }\n  }, [hasVideo, cameras, currentDeviceId, autoStartDeviceId, webcam]);\n\n  const classes = useStyles();\n\n  // console.log(\n  //   !hasVideo\n  //     ? 'no webcam'\n  //     : !cameras.length || currentDeviceId === undefined\n  //     ? 'webcams is loading'\n  //     : !currentDeviceId\n  //     ? 'no webcam chosen'\n  //     : 'rendering game',\n  // );\n\n  return (\n    <main className={classes.root}>{!hasVideo ? <NoWebcam /> : <Game webcam={webcam} />}</main>\n  );\n};\n\nMain.propTypes = {\n  cvReady: PropTypes.bool.isRequired,\n};\n\nexport default memo(Main);\n","import Particles from 'particlesjs';\nimport { hot } from 'react-hot-loader';\nimport { CssBaseline } from '@material-ui/core';\nimport React, { useEffect, useState, useRef } from 'react';\nimport { createMuiTheme, MuiThemeProvider } from '@material-ui/core/styles';\nimport primary from '@material-ui/core/colors/deepPurple';\n\nimport Main from '../components/Main';\nimport WebcamProvider from '../context/webcam';\nimport BodyPixProvider from '../context/bodyPix';\nimport AudioProvider from '../context/audio';\nimport CarbonProvider from '../context/carbon';\n\nconst theme = createMuiTheme({\n  palette: {\n    primary,\n  },\n});\n\nfunction App() {\n  const [cvReady, setCvReady] = useState(false);\n  const particlesRef = useRef();\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      if (window.cvReady) {\n        setCvReady(true);\n        clearInterval(interval);\n      }\n    }, 200);\n\n    return () => {\n      clearInterval(interval);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!particlesRef.current) {\n      particlesRef.current = true;\n      Particles.init({\n        selector: '.background',\n      });\n    }\n  });\n\n  return (\n    <MuiThemeProvider theme={theme}>\n      <WebcamProvider>\n        <BodyPixProvider>\n          <AudioProvider>\n            <CarbonProvider>\n              <>\n                <CssBaseline />\n                <Main cvReady={cvReady} />\n              </>\n            </CarbonProvider>\n          </AudioProvider>\n        </BodyPixProvider>\n      </WebcamProvider>\n    </MuiThemeProvider>\n  );\n}\n\nexport default process.env.NODE_ENV === 'production' ? App : hot(module)(App);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as serviceWorker from './serviceWorker';\n\nimport './reset.css';\nimport App from './App/App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}