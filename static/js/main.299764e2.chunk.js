(this.webpackJsonprob_and_adam_code_a_thing=this.webpackJsonprob_and_adam_code_a_thing||[]).push([[0],{281:function(e,t,n){var a=n(556),r=["load","predict"];e.exports=function(){var e=new Worker(n.p+"60a0dfbb6ed702cd6027.worker.js",{name:"[hash].worker.js"});return a(e,r),e}},292:function(e,t,n){e.exports=n(557)},297:function(e,t,n){},311:function(e,t){},313:function(e,t){},361:function(e,t){},363:function(e,t){},391:function(e,t){},393:function(e,t){},394:function(e,t){},400:function(e,t){},402:function(e,t){},420:function(e,t){},422:function(e,t){},434:function(e,t){},437:function(e,t){},442:function(e,t){},444:function(e,t){},467:function(e,t){},557:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(16),o=n.n(c);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(297);var i,l,s,u,d,p,m,f,b,v,g,h=n(4),O=n(260),j=n.n(O),k=n(588),E=n(283),y=n(587),C=n(282),w=n.n(C),x=n(558),S=n(3),L=n.n(S),M=n(10),I=Object(a.createContext)(),R=function(){var e=Object(a.useContext)(I);if(!e)throw new Error("useWebcam must be used within a WebcamProvider");return e},T=!!(null===(i=navigator)||void 0===i||null===(l=i.mediaDevices)||void 0===l?void 0:l.getUserMedia),A=function(e){var t,n,c,o,i=e.children,l=Object(a.useRef)(),s=Object(a.useRef)(),u=Object(a.useRef)(),d=Object(a.useState)(null),p=Object(h.a)(d,2),m=p[0],f=p[1],b=Object(a.useState)(!0),v=Object(h.a)(b,2),g=v[0],O=v[1],j=Object(a.useState)(!1),k=Object(h.a)(j,2),E=k[0],y=k[1],C=Object(a.useState)([]),w=Object(h.a)(C,2),x=w[0],S=w[1],R=Object(a.useState)(!0),A=Object(h.a)(R,2),D=A[0],P=A[1],N=Object(a.useState)(null),F=Object(h.a)(N,2),_=F[0],U=F[1],B=Object(a.useState)(null),z=Object(h.a)(B,2),V=z[0],G=z[1],W=Object(a.useState)(null),Y=Object(h.a)(W,2),q=Y[0],X=Y[1],H=Object(a.useState)(!1),K=Object(h.a)(H,2),$=K[0],Z=K[1],J=Object(a.useState)(!1),Q=Object(h.a)(J,2),ee=Q[0],te=Q[1],ne=Object(a.useState)(void 0),ae=Object(h.a)(ne,2),re=ae[0],ce=ae[1],oe=Object(a.useState)(void 0),ie=Object(h.a)(oe,2),le=ie[0],se=ie[1];Object(a.useEffect)((function(){u.current&&!m?f(u.current.getContext("2d")):m&&!u.current&&f(null)}),[m]),Object(a.useEffect)((function(){if(E&&!_){var e=document.createElement("canvas");e.width=u.current.width,e.height=u.current.height;var t=e.getContext("2d");U({ctx:t,canvas:e})}}),[_,E]);var ue=Object(a.useCallback)((function(){P(!1)}),[]),de=Object(a.useCallback)((function(){P(!0)}),[]),pe=Object(a.useCallback)((function(){_.ctx.clearRect(0,0,u.current.width,u.current.height)}),[_]),me=Object(a.useCallback)((function(){m.clearRect(0,0,u.current.width,u.current.height)}),[m]),fe=Object(a.useCallback)((function(){q&&q.getTracks().forEach((function(e){return e.stop()})),G(null),X(null),y(!1),ce(void 0)}),[q]),be=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(t){var n,a,r,c,o,i,l,u,d,p,m,f,b;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(fe(),T){e.next=6;break}return"Video not supported",console.error("Video not supported"),G("Video not supported"),e.abrupt("return");case 6:return a=(n="number"===typeof t)?{}:t||{},r=n?t:a.deviceIdx,e.prev=9,console.log("Finding Webcams..."),i={video:{width:{exact:a.width||1280},height:{exact:a.height||720}},audio:!1},void 0!==r&&(a.deviceId=null===(l=x[r])||void 0===l?void 0:l.deviceId),a.deviceId&&(i.video.deviceId={exact:a.deviceId}),e.next=16,navigator.mediaDevices.getUserMedia(i);case 16:u=e.sent,d=null===(c=u.getTracks()[0])||void 0===c||null===(o=c.getCapabilities())||void 0===o?void 0:o.deviceId,console.log("Found webcam!"),X(u),ce(d),G(!1),te(!1),Z(!1),s.current.srcObject=u,e.next=37;break;case 27:return e.prev=27,e.t0=e.catch(9),"Error starting video.",console.error("Error starting video."),console.error(e.t0.message),(null===(p=e.t0.message)||void 0===p||null===(m=p.toLowerCase)||void 0===m||null===(f=m.call(p))||void 0===f||null===(b=f.includes)||void 0===b?void 0:b.call(f,"permission denied"))&&te(!0),X(null),y(!1),G("Error starting video."),e.abrupt("return");case 37:return e.next=39,Promise.all([new Promise((function(e){s.current.onloadedmetadata=function(){return e()}})),new Promise((function(e){s.current.onloadeddata=function(){return e()}}))]).then((function(){console.log("Webcam ready!"),y(!0),P(!1)}));case 39:return e.abrupt("return",e.sent);case 40:case"end":return e.stop()}}),e,null,[[9,27]])})));return function(t){return e.apply(this,arguments)}}(),[fe,s,x]),ve=Object(a.useCallback)(Object(M.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",be({deviceId:le}));case 1:case"end":return e.stop()}}),e)}))),[le,be]),ge=Object(a.useCallback)(Object(M.a)(L.a.mark((function e(){var t,n,a,r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=navigator)||void 0===t||null===(n=t.mediaDevices)||void 0===n?void 0:n.enumerateDevices){e.next=4;break}return console.error("Cannot get cameras."),e.abrupt("return",[]);case 4:return e.next=6,navigator.mediaDevices.enumerateDevices();case 6:return a=e.sent,r=a.filter((function(e){var t=e.kind,n=e.label;return"videoinput"===t&&!n.includes("CamTwist")})).map((function(e){var t,n=e.label.lastIndexOf(" (");return n>-1&&(t=e.label.slice(0,n)),t?{deviceId:e.deviceId,label:t}:e})),S(r),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)}))),[]),he=Object(a.useCallback)((function(){return O((function(e){return!e}))}),[]),Oe=Object(a.useCallback)((function(e){window.localStorage.setItem("AutoStartId",e),se(e)}),[]),je=Object(a.useCallback)((function(){window.localStorage.removeItem("AutoStartId"),se(null)}),[]),ke=Object(a.useCallback)((function(e){pe(),_.ctx.putImageData(e,0,0);var t=_.canvas.toDataURL("image/png");return pe(),t}),[_,pe]),Ee=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(t){var n,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pe(),(n=new Image).src=t,e.next=5,new Promise((function(e){n.onload=function(){_.ctx.drawImage(n,0,0),e()}}));case 5:return a=_.ctx.getImageData(0,0,u.current.width,u.current.height),pe(),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[pe,_]),ye=Object(a.useCallback)((function(){pe(),_.ctx.drawImage(s.current,0,0);var e=_.ctx.getImageData(0,0,u.current.width,u.current.height);return pe(),e}),[pe,_]);Object(a.useEffect)((function(){ge().then((function(e){var t=window.localStorage.getItem("AutoStartId"),n=!1,a=e.reduce((function(a,r,c){var o=r.deviceId,i=r.label;return o||(n=!0),a||(o===t||!t&&1===e.length&&0===c||!t&&i.includes("Built-in")?o:null)}),null);a?Oe(a):n?(Z(!0),console.warn("Need video permissions!")):!a&&t&&je()}))}),[]);var Ce=!!((null===(t=l.current)||void 0===t?void 0:t.requestFullscreen)||(null===(n=l.current)||void 0===n?void 0:n.mozRequestFullScreen)||(null===(c=l.current)||void 0===c?void 0:c.webkitRequestFullscreen)||(null===(o=l.current)||void 0===o?void 0:o.msRequestFullscreen)),we=Object(a.useState)(!1),xe=Object(h.a)(we,2),Se=xe[0],Le=xe[1];Object(a.useEffect)((function(){var e=function(){var e=!!document.fullscreenElement;Le(e)};return document.addEventListener("fullscreenchange",e),function(){return document.removeEventListener("fullscreenchange",e)}}),[]);var Me=Object(a.useCallback)((function(){Ce&&(l.current.requestFullscreen?l.current.requestFullscreen():l.current.mozRequestFullScreen?l.current.mozRequestFullScreen():l.current.webkitRequestFullscreen?l.current.webkitRequestFullscreen():l.current.msRequestFullscreen&&l.current.msRequestFullscreen())}),[Ce]),Ie=Object(a.useCallback)((function(){Ce&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())}),[Ce]),Re=Object(a.useCallback)((function(){Se?Ie():Me()}),[Se,Me,Ie]),Te=Object(a.useMemo)((function(){return{ctx:m,ready:E,flipX:g,start:ve,hidden:D,rootRef:l,cameras:x,setFlipX:O,videoRef:s,hasVideo:T,_setHidden:de,canvasRef:u,stopVideo:fe,setVisible:ue,startVideo:be,videoError:V,scratchpad:_,clearCanvas:me,toggleFlipX:he,videoStream:q,hasFullScreen:Ce,exitFullScreen:Ie,clearScratchpad:pe,currentDeviceId:re,enterFullScreen:Me,stop:fe,discoverCameras:ge,permissionNeeded:$,permissionDenied:ee,toggleFullScreen:Re,autoStartDeviceId:le,imageDataToDataUri:ke,dataUriToImageData:Ee,getVideoAsImageData:ye,setAutoStartDeviceId:Oe,clearAutoStartDeviceId:je,isFullScreen:Se}}),[m,E,g,ve,D,x,O,de,fe,Se,ue,be,V,_,he,me,q,Ce,Ie,pe,re,Me,ge,$,ee,Re,le,ke,Ee,ye,Oe,je]);return r.a.createElement(I.Provider,{value:Te},i)},D=n(116),P=n(6),N=n(23),F=n(583),_=n(584),U=n(20),B=n(269),z=n.n(B),V=n(268),G=n.n(V),W=function(e){var t=e.color,n=void 0===t?"#fff":t,a=Object(U.c)({to:{opacity:1},from:{opacity:0},config:U.b.stiff});return r.a.createElement(U.a.div,{style:a},r.a.createElement("svg",{version:"1.1",id:"L7",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 100 100",enableBackground:"new 0 0 100 100"},r.a.createElement("path",{fill:n,d:"M31.6,3.5C5.9,13.6-6.6,42.7,3.5,68.4c10.1,25.7,39.2,38.3,64.9,28.1l-3.1-7.9c-21.3,8.4-45.4-2-53.8-23.3 c-8.4-21.3,2-45.4,23.3-53.8L31.6,3.5z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"2s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"})),r.a.createElement("path",{fill:n,d:"M42.3,39.6c5.7-4.3,13.9-3.1,18.1,2.7c4.3,5.7,3.1,13.9-2.7,18.1l4.1,5.5c8.8-6.5,10.6-19,4.1-27.7 c-6.5-8.8-19-10.6-27.7-4.1L42.3,39.6z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"1s",from:"0 50 50",to:"-360 50 50",repeatCount:"indefinite"})),r.a.createElement("path",{fill:n,d:"M82,35.7C74.1,18,53.4,10.1,35.7,18S10.1,46.6,18,64.3l7.6-3.4c-6-13.5,0-29.3,13.5-35.3s29.3,0,35.3,13.5 L82,35.7z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"2s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"}))))},Y=n(117),q=n(589),X=n(580),H=n(592),K=n(593),$=n(590),Z=n(585),J=n(265),Q=n.n(J),ee=n(266),te=n.n(ee),ne=function(){},ae=Object(x.a)((function(e){return{root:function(e){return{position:"relative"}},arrowIcon:function(t){return{marginLeft:e.spacing(1)}},tooltip:function(e){return{position:"relative",margin:0}},arrow:function(e){return{position:"absolute",fontSize:6,"&::before":{content:'""',margin:"auto",display:"block",width:0,height:0,borderStyle:"solid"}}},paper:{border:"1px solid #d3d4d5"},popper:function(t){return{'&[x-placement*="bottom"] $arrow':{top:0,left:0,marginTop:"-0.95em",width:"2em",height:"1em","&::before":{borderWidth:"0 1em 1em 1em",borderColor:"transparent transparent ".concat(e.palette.grey[700]," transparent")}},'&[x-placement*="top"] $arrow':{bottom:0,left:0,marginBottom:"-0.95em",width:"2em",height:"1em","&::before":{borderWidth:"1em 1em 0 1em",borderColor:"".concat(e.palette.grey[700]," transparent transparent transparent")}},'&[x-placement*="right"] $arrow':{left:0,marginLeft:"-0.95em",height:"2em",width:"1em","&::before":{borderWidth:"1em 1em 1em 0",borderColor:"transparent ".concat(e.palette.grey[700]," transparent transparent")}},'&[x-placement*="left"] $arrow':{right:0,marginRight:"-0.95em",height:"2em",width:"1em","&::before":{borderWidth:"1em 0 1em 1em",borderColor:"transparent transparent transparent ".concat(e.palette.grey[700])}}}}}})),re=function(e){var t,n=ae(e),c=Object(a.useMemo)(Math.random,[]),o=Object(a.useRef)(),i=Object(a.useState)(null),l=Object(h.a)(i,2),s=l[0],u=l[1],d=Object(a.useState)(null),p=Object(h.a)(d,2),m=p[0],f=p[1];Object(a.useEffect)((function(){return o.current=!0,function(){o.current=!1}}),[]);var b=Object(a.useCallback)((function(e){o.current&&u(e.currentTarget)}),[]),v=Object(a.useCallback)((function(){o.current&&u(null)}),[]),g=Object(a.useCallback)(Object(M.a)(L.a.mark((function t(){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e.onClose||ne)();case 2:!0!==t.sent&&v();case 4:case"end":return t.stop()}}),t)}))),[v,e.onClose]),O=Object(a.useCallback)((function(t){(e.onClickCheckbox||ne)(t.target.value,g)}),[e.onClickCheckbox,g]),j=Object(a.useCallback)((function(t){return function(){var n=Object(M.a)(L.a.mark((function n(a){return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("checkbox"!==a.target.type){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,(e.onSelect||ne)(t);case 4:!0!==n.sent&&g();case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}),[g,e.onSelect]),k=!!s;return r.a.createElement("div",{className:n.root},r.a.createElement(X.a,Object.assign({disableRipple:!0,variant:"outlined","aria-haspopup":"true",className:n.button,onClick:b,"aria-controls":"select-and-check-".concat(c)},e.SelectProps),k&&e.activeTitle||e.title,k?r.a.createElement(Q.a,{className:n.arrowIcon}):r.a.createElement(te.a,{className:n.arrowIcon})),r.a.createElement(q.a,Object.assign({keepMounted:!0,open:k,elevation:0,anchorEl:s,getContentAnchorEl:null,onClose:g,id:"select-and-check-".concat(c),classes:{paper:n.paper},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e.MenuProps),null===(t=e.options)||void 0===t?void 0:t.map((function(t,a){var c=t.key,o=t.value,i=t.text,l=t.selected,s=t.tooltipTitle,u=t.checked,d=t.checkboxValue,p=null;if("boolean"===typeof u){var b=r.a.createElement($.a,{checked:u,onClick:O,value:void 0===d?o:d}),v=s||e.tooltipTitle;p=v?r.a.createElement(H.a,{classes:{tooltip:n.tooltip,popper:n.popper},PopperProps:{popperOptions:{modifiers:{arrow:{enabled:!!m,element:m}}}},title:r.a.createElement(r.a.Fragment,null,v,r.a.createElement("span",{className:n.arrow,ref:f})),enterDelay:void 0===e.tooltipEnterDelay?750:e.tooltipEnterDelay,leaveDelay:e.tooltipLeaveDelay||0,"aria-label":"checkbox",placement:e.tooltipPlacement||"top"},b):b}return r.a.createElement(K.a,Object.assign({key:c||a,onClick:j(o),selected:l},e.MenuItemProps),p,r.a.createElement(Z.a,{primary:i||(null===o||void 0===o?void 0:o.toString())}))}))))},ce=Object(x.a)((function(e){return{root:function(e){return{}}}})),oe=function(e){var t,n=R(),c=ce(Object(N.a)(Object(N.a)({},e),n)),o=Object(a.useMemo)((function(){var e={deviceId:null,label:null,none:!0};return n.currentDeviceId?(n.cameras.some((function(t){return t.deviceId===n.currentDeviceId&&(e=t,!0)})),e):e}),[n.cameras,n.currentDeviceId]),i=Object(a.useCallback)((function(e){n.currentDeviceId!==e&&n.startVideo({deviceId:e})}),[n]),l=Object(a.useCallback)((function(e){n.autoStartDeviceId===e?n.clearAutoStartDeviceId():(n.setAutoStartDeviceId(e),i(e))}),[n,i]);return r.a.createElement("div",{className:c.root},r.a.createElement(re,{activeTitle:"Select Camera",title:(null===(t=n.cameras)||void 0===t?void 0:t.length)?o.label||"No Camera Selected":"No Cameras Detected",onSelect:i,onClickCheckbox:l,options:n.cameras.map((function(e){return{key:e.label,value:e.deviceId,text:e.label||"Unknown Device",selected:e.deviceId===n.currentDeviceId,checked:n.autoStartDeviceId===e.deviceId,tooltipTitle:n.autoStartDeviceId===e.deviceId?"Remove Default":"Set Default"}}))}))},ie=Object(x.a)((function(e){return{root:{position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",alignItems:"center",justifyContent:"center"},paper:{padding:e.spacing(2),borderRadius:e.spacing(1),display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center","& h1":{marginBottom:e.spacing(2)},"& p":{marginBottom:e.spacing(1)}}}})),le=function(e){var t=ie(e),n=Object(U.c)({transform:"translate3d(0,0px,0)",from:{transform:"translate3d(0,-500px,0)"},config:U.b.slow}),a=Object(U.c)({to:{opacity:e.permissionDenied?1:0},config:U.b.wobbly});return r.a.createElement("div",{className:t.root},r.a.createElement(U.a.div,{style:n},r.a.createElement(F.a,{elevation:4,className:t.paper},r.a.createElement("div",{className:t.container},e.permissionDenied?r.a.createElement(U.a.div,{style:a},r.a.createElement(Y.a,{component:"h1",variant:"h6"},"It looks like you have denied webcam access."),r.a.createElement(Y.a,{component:"p"},"Please take a look at"," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://support.google.com/chrome/answer/2693767"},"this article")," ","in order to enable access."),r.a.createElement(Y.a,{component:"p"},"Once your webcam has been enabled, return here to play the game!")):r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.a,{component:"h1",variant:"h6"},"In order to play the game, you must grant permission to access your webcam."),r.a.createElement(Y.a,{component:"p"},"Please select a camera."),r.a.createElement(oe,null))))))},se=Object(x.a)((function(e){return{root:function(t){var n=t.isFullScreen;return Object(N.a)(Object(P.a)({maxWidth:1100,margin:"0 auto",position:"relative",height:"calc(0.5625 * (100vw - ".concat(e.spacing(4),"px))")},"@media(min-width: ".concat(1100,"px)"),{height:n?"100%":"calc(0.5625 * (".concat(1100,"px - ").concat(e.spacing(4),"px))")}),n?{display:"flex",alignItems:"center",justifyContent:"center"}:{})},container:function(t){var n=t.isFullScreen;return{width:"100%",position:"relative",paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},video:function(t){var n=t.flipX,a=t.isFullScreen;return Object(N.a)({width:"100%",height:"100%",borderRadius:a?0:e.spacing(1)},n?{"p-webkit-transform":"scaleX(- 1)",transform:"scaleX(-1)"}:{})},canvas:function(t){var n=t.isFullScreen;return{borderRadius:n?0:e.spacing(1),position:"absolute",top:0,left:0,width:"100%",paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},children:function(t){var n=t.isFullScreen;return{borderRadius:n?0:e.spacing(1),overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",bottom:5,zIndex:1,paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},fullScreen:{position:"absolute",bottom:e.spacing(1.5),right:function(t){var n=t.isFullScreen;return e.spacing(n?1.5:3)},zIndex:20,"&:hover":{background:"rgba(255,255,255,0.25)"}},overlay:function(t){var n=t.overlayColor,a=t.isFullScreen;return{background:n,position:"absolute",top:0,bottom:5,left:a?0:e.spacing(2),right:a?0:e.spacing(2),borderRadius:a?0:e.spacing(1),zIndex:0}},loader:{position:"absolute",top:0,left:0,bottom:0,right:0,width:"100%",display:"flex",alignItems:"center",justifyContent:"center","& > div":{width:100,height:100}},paper:{top:0,bottom:5,zIndex:-1,position:"absolute",left:e.spacing(2),right:e.spacing(2),borderRadius:e.spacing(1)}}})),ue=function(e){var t,n,a,c,o,i,l,s,u=e.overlay,d=Object(D.a)(e,["overlay"]),p=R(),m="string"!==typeof u?"rgba(255,255,255,0.5)":u,f=se(Object(N.a)(Object(N.a)(Object(N.a)({},d),p),{},{overlayColor:m})),b=Object(U.c)({to:{opacity:p.hidden?0:1},config:U.b.stiff});return r.a.createElement("div",{ref:p.rootRef,className:f.root},r.a.createElement(U.a.div,{style:b,className:f.container},r.a.createElement(r.a.Fragment,null,r.a.createElement("video",{autoPlay:!0,ref:p.videoRef,className:f.video,width:null===(t=p.videoRef)||void 0===t||null===(n=t.current)||void 0===n?void 0:n.videoWidth,height:null===(a=p.videoRef)||void 0===a||null===(c=a.current)||void 0===c?void 0:c.videoHeight}),r.a.createElement("canvas",{ref:p.canvasRef,className:f.canvas,width:null===(o=p.videoRef)||void 0===o||null===(i=o.current)||void 0===i?void 0:i.videoWidth,height:null===(l=p.videoRef)||void 0===l||null===(s=l.current)||void 0===s?void 0:s.videoHeight}),!p.hidden&&u&&r.a.createElement("div",{className:f.overlay}),d.children&&!p.hidden&&r.a.createElement("div",{className:f.children},d.children),p.hasFullScreen&&r.a.createElement(_.a,{color:"secondary",className:f.fullScreen,onClick:p.toggleFullScreen},p.isFullScreen?r.a.createElement(G.a,{color:"secondary"}):r.a.createElement(z.a,{color:"secondary"}))),!p.isFullScreen&&r.a.createElement(F.a,{elevation:4,className:f.paper})),p.permissionNeeded?r.a.createElement(le,{permissionDenied:p.permissionDenied}):p.hidden&&r.a.createElement("div",{className:f.loader},r.a.createElement("div",null,r.a.createElement(W,{color:"#000"}))))},de=n(64),pe=n.n(de),me=n(270),fe=n.n(me),be=n(271),ve=n.n(be),ge=n(273),he=n.n(ge),Oe=n(272),je=n.n(Oe),ke=window.speechSynthesis,Ee=function(){var e=Object(a.useRef)(!0),t=Object(a.useState)(!0),n=Object(h.a)(t,2),r=n[0],c=n[1],o=function(e){if(!e)throw new Error("audioRef is required when calling useSpeech");var t=Object(a.useState)(null),n=Object(h.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(null),i=Object(h.a)(o,2),l=i[0],s=i[1];Object(a.useEffect)((function(){if(!r){var e=ke.getVoices();c(e),s(e[0])}}),[r]);var u=Object(a.useCallback)((function(t){if(e.current){var n=new SpeechSynthesisUtterance(t);n.voice=l,ke.speak(n)}}),[l,e]),d=Object(a.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.onEnd,a=t.onEach;n&&setTimeout(n,1e3*e),Array.from({length:e}).forEach((function(t,n){var r=e-n;setTimeout((function(){u(r),a&&a(r)}),1e3*n)}))}),[u]);return{say:u,countdown:d}}(e);Object(a.useEffect)((function(){localStorage.getItem("__audio_muted__")&&c(!1)}),[]),Object(a.useEffect)((function(){r&&!e.current?(e.current=!0,localStorage.removeItem("__audio_muted__")):!r&&e.current&&(e.current=!1,localStorage.setItem("__audio_muted__","true"))}),[r]);var i=Object(a.useCallback)((function(){c((function(e){return!e}))}),[]);return Object(a.useMemo)((function(){return{state:r,stateRef:e,handlers:{toggle:i,speech:o}}}),[r,i,o])},ye=Object(a.createContext)(),Ce=function(){var e=Object(a.useContext)(ye);if(void 0===e)throw new Error("useAudio must be used within a AudioProvider");return e},we=function(e){var t=e.children,n=Ee();return r.a.createElement(ye.Provider,{value:n},t)},xe="set_screen",Se="set_player_mode",Le="set_game_mode",Me="reverse_state",Ie="reset_state",Re={screen:{DEFAULT:"start",PLAY:"play"},players:{SINGLE_PLAYER:"Single Player",MULTIPLAYER:"Multi Player",DEFAULT:null},mode:(s={},Object(P.a)(s,"Single Player",{PRACTICE:"Practice",SURVIVAL:"Survival",TIME_ATTACK:"Time Attack"}),Object(P.a)(s,"Multi Player",{LOCAL:"Local Multiplayer",REMOTE:"Remote Multiplayer"}),Object(P.a)(s,"DEFAULT",null),s)},Te=[Re.players.MULTIPLAYER,Re.mode["Single Player"].TIME_ATTACK,Re.mode["Multi Player"].LOCAL,Re.mode["Multi Player"].REMOTE].reduce((function(e,t){return Object(N.a)(Object(N.a)({},e),{},Object(P.a)({},t,!0))}),{}),Ae=Object.entries(Re).reduce((function(e,t){var n=Object(h.a)(t,2),a=n[0],r=n[1];return Object(N.a)(Object(N.a)({},e),{},Object(P.a)({},a,"mode"!==a?Object.values(r).filter((function(e){return e})):Object.entries(r).reduce((function(e,t){var n=Object(h.a)(t,2),a=n[0],r=n[1];return Object(N.a)(Object(N.a)({},e),{},Object(P.a)({},a,null===r?null:Object.values(r)))}),{})))}),{}),De={screen:Re.screen.DEFAULT,mode:Re.mode.DEFAULT,players:Re.players.DEFAULT},Pe=Object(x.a)((function(e){return{btn:{border:"2px solid grey"},back:{marginLeft:e.spacing(2)},options:{marginTop:e.spacing(2),paddingLeft:e.spacing(2),paddingRight:e.spacing(2),width:"100%",maxWidth:1100,display:"flex",margin:"0 auto",alignItems:"center",justifyContent:"space-between"},right:{display:"flex",alignItems:"center",justifyContent:"space-between"},volume:{marginLeft:e.spacing(1)}}})),Ne=Object(a.memo)((function(e){var t=Pe(),n=Ce(),a=e.screen===Re.screen.DEFAULT,c=Object(U.c)({to:{opacity:a?0:1},config:U.b.stiff});return r.a.createElement("div",{className:t.options},r.a.createElement("div",null,!a&&r.a.createElement(U.a.div,{style:c},r.a.createElement(_.a,{className:t.btn,size:"small",onClick:e.goHome},r.a.createElement(fe.a,null)),r.a.createElement(_.a,{size:"small",onClick:e.goBack,className:pe()(t.btn,t.back)},r.a.createElement(ve.a,null)))),r.a.createElement("div",{className:t.right},r.a.createElement(oe,null),r.a.createElement(_.a,{className:t.volume,size:"small",onClick:n.handlers.toggle},n.state?r.a.createElement(je.a,null):r.a.createElement(he.a,null))))})),Fe=function(){return null},_e=Object(x.a)((function(e){return{root:{textAlign:"center"},heading:{marginTop:e.spacing(2),marginBottom:e.spacing(2)}}})),Ue=function(e){var t=_e();return r.a.createElement("header",{className:t.root},r.a.createElement(Y.a,{component:"h1",variant:"h5",className:t.heading},e.game.screen.state.screen))},Be=Object(x.a)((function(e){return{root:{marginTop:e.spacing(2)}}})),ze=(d={},Object(P.a)(d,Re.screen.DEFAULT,Object(P.a)({},Re.players.DEFAULT,Fe)),Object(P.a)(d,Re.screen.PLAY,(u={},Object(P.a)(u,Re.players.SINGLE_PLAYER,Fe),Object(P.a)(u,Re.players.MULTIPLAYER,Fe),u)),d),Ve=function(e){var t,n=Be(),a=e.screenState,c=a.screen,o=a.players,i=(null===(t=ze[c])||void 0===t?void 0:t[o])||Ue;return r.a.createElement("header",{className:n.root},r.a.createElement(i,null))},Ge=n(586),We=n(274),Ye=n.n(We),qe=function(e){var t=(e-25)/63;return Math.max(1,Math.min(10,Math.round(10*t)))},Xe=function(e){return e/10*100},He=function(e,t){var n,a;e<50?(n=255,a=Math.round(5.1*e)):(a=255,n=Math.round(510-5.1*e));var r="#"+("000000"+(65536*n+256*a+0).toString(16)).slice(-6);if(t){var c=Ye()(r),o=c.red,i=c.green,l=c.blue;return"rgba(".concat(o,", ").concat(i,", ").concat(l,", ").concat(t,")")}return r},Ke=function(e,t){return He(Xe(qe(e)),t)},$e=n(115),Ze=n.n($e),Je=Object(Ge.a)((function(e){return{masks:{padding:e.spacing(2),background:"rgba(255,255,255,0.5)"},masksHeader:{display:"flex",alignItems:"center",justifyContent:"space-between"},masksList:{display:"flex",flexFlow:"row wrap",justifyContent:"space-around"},maskContainer:{marginTop:e.spacing(2)},imgContainer:{width:200,position:"relative",border:"1px solid grey",padding:e.spacing(.5),borderRadius:e.spacing(1),"&:hover":{"& > div":{background:"rgba(255,0,0,0.65)"}}},img:{width:"100%",background:"rgba(0,0,0,0)"},removeMask:{top:0,left:0,bottom:0,width:"100%",display:"flex",alignItems:"center",position:"absolute",transition:"all 100ms",justifyContent:"center","&:hover":{"& > button":{display:"inherit"}}},iconBtn:{display:"none",color:"black",backgroundColor:"rgba(255,255,255,0.5)","&:hover":{backgroundColor:"rgba(255,255,255,0.75)"},"&:active, &:focused":{backgroundColor:"rgba(255,255,255,0.9)"}},actions:{"& > button":{marginRight:e.spacing(1),"& :last-of-type":{marginRight:0}}}}})),Qe=function(e){var t=Je(),n=e.masks,a=e.onClose,c=e.title,o=e.actions,i=e.actionButtons,l=e.getDataUri,s=e.getImageChild,u=e.getPaperProps,d=e.PaperProps,p=void 0===d?{}:d;return!!(null===n||void 0===n?void 0:n.length)&&r.a.createElement(F.a,{className:t.masks,elevation:4},r.a.createElement("div",{className:t.masksHeader},"string"===typeof c?r.a.createElement(Y.a,{variant:"h6",component:"h3"},c):c||null,o||i?r.a.createElement("div",{className:t.actions},i.map((function(e){var t=e.Icon,n=e.onClick,a=e.key;return r.a.createElement(_.a,{key:a,size:"small",onClick:n},r.a.createElement(t,null))}))):a&&r.a.createElement("div",{className:t.actions},r.a.createElement(_.a,{size:"small",onClick:a},r.a.createElement(Ze.a,null)))),r.a.createElement("ul",{className:t.masksList},n.map((function(e,n){var a=l?l(e):e,c=u?u(e,n):{};return r.a.createElement("li",{key:a,className:t.maskContainer},r.a.createElement(F.a,Object.assign({elevation:4,className:t.imgContainer},p,c),s&&s(e),r.a.createElement("img",{src:a,className:t.img,alt:"mask #".concat(n)})))}))))},et=Object(Ge.a)((function(e){return{score:{textAlign:"right",paddingRight:e.spacing(1)}}})),tt=function(e){var t=et(),n=e.results,c=e.handleClose,o=Object(a.useMemo)((function(){var e=n.reduce((function(e,t){var n=t.score;return e+qe(n)}),0)/n.length,t=Xe(e),a=He(t),c=e.toFixed(1);return r.a.createElement(Y.a,{variant:"h6",component:"h3"},"Round Score: ",r.a.createElement("span",{style:{color:a}},c))}),[n]),i=Object(a.useCallback)((function(e){return e.dataUri}),[]),l=Object(a.useCallback)((function(e){var t=e.score;return{style:{background:Ke(t,.4)}}}),[]),s=Object(a.useCallback)((function(e){var n=e.score;return r.a.createElement(Y.a,{className:t.score},qe(n))}),[t.score]);return r.a.createElement(Qe,{title:o,masks:n,onClose:c,getDataUri:i,getPaperProps:l,getImageChild:s})},nt=n(275),at=n.n(nt),rt=n(276),ct=n.n(rt),ot=n(277),it=n.n(ot),lt=Object(Ge.a)((function(e){return{removeMask:{top:0,left:0,bottom:0,width:"100%",display:"flex",alignItems:"center",position:"absolute",transition:"all 100ms",justifyContent:"center","&:hover":{"& > button":{display:"inherit"}}},iconBtn:{display:"none",color:"black",backgroundColor:"rgba(255,255,255,0.5)","&:hover":{backgroundColor:"rgba(255,255,255,0.75)"},"&:active, &:focused":{backgroundColor:"rgba(255,255,255,0.9)"}}}})),st=function(e){var t=lt(),n=e.captureMasks,c=e.handlePlay,o=Object(a.useMemo)((function(){return[{key:"play",Icon:at.a,onClick:c},{key:"download",Icon:ct.a,onClick:n.downloadMasks},{key:"clear",Icon:Ze.a,onClick:n.removeAllMasks}]}),[n.downloadMasks,n.removeAllMasks,c]),i=Object(a.useCallback)((function(e){return e.binary}),[]),l=Object(a.useCallback)((function(e,a){return r.a.createElement("div",{className:t.removeMask},r.a.createElement(_.a,{name:a,className:t.iconBtn,onClick:n.removeMask},r.a.createElement(it.a,{fontSize:"large"})))}),[n.removeMask,t.removeMask,t.iconBtn]);return r.a.createElement(Qe,{title:"Candidate Masks",getDataUri:i,masks:n.masks,actionButtons:o,getImageChild:l})},ut=Object(Ge.a)((function(e){return{root:{"& > div":{marginTop:e.spacing(2)}}}})),dt=function(e){var t=ut(),n=nn();if(!n.mode)return null;var a=n.mode,c=a.captureMasks,o=a.simpleGame,i=a.handlePlayCapturedMasks;return r.a.createElement("div",{className:t.root},r.a.createElement(tt,{results:o.scores,handleClose:o.clearScores}),r.a.createElement(st,{captureMasks:c,handlePlay:i}))},pt=Object(x.a)((function(e){return{root:{maxWidth:1100,margin:"0 auto",paddingLeft:e.spacing(2),paddingRight:e.spacing(2)}}})),mt=Object(P.a)({},Re.screen.PLAY,(f={},Object(P.a)(f,Re.players.SINGLE_PLAYER,(p={},Object(P.a)(p,Re.mode[Re.players.SINGLE_PLAYER].PRACTICE,dt),Object(P.a)(p,Re.mode[Re.players.SINGLE_PLAYER].SURVIVAL,dt),Object(P.a)(p,Re.mode[Re.players.SINGLE_PLAYER].TIME_ATTACK,(function(){return"TIME_ATTACK footer"})),p)),Object(P.a)(f,Re.players.MULTIPLAYER,(m={},Object(P.a)(m,Re.mode[Re.players.MULTIPLAYER].LOCAL,(function(){return"LOCAL footer"})),Object(P.a)(m,Re.mode[Re.players.MULTIPLAYER].REMOTE,(function(){return"REMOTE footer"})),m)),f)),ft=function(e){var t,n,a=pt(),c=e.screen.state,o=c.screen,i=c.players,l=c.mode,s=(null===(t=mt[o])||void 0===t||null===(n=t[i])||void 0===n?void 0:n[l])||Fe;return r.a.createElement("div",{className:a.root},r.a.createElement(s,null))},bt=Object(Ge.a)((function(e){return{root:{display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"space-between",marginBottom:e.spacing(1),"& > div > *":{marginTop:e.spacing(2),minWidth:150}}}})),vt=function(e){var t=bt(),n=Object(U.d)(e.buttons.length,{transform:"translate3d(0,0px,0)",from:{transform:"translate3d(0,-".concat(e.offset||100,"px,0)")},config:U.b.stiff});return r.a.createElement("div",{className:t.root},n.map((function(t,n){var a=e.buttons[n],c=a.Component,o=a.visible,i=void 0===o||o,l=a.props,s=void 0===l?{}:l;return i?r.a.createElement(U.a.div,{key:s.key,style:t},c?r.a.createElement(c,s):r.a.createElement(X.a,Object.assign({color:"primary",variant:"contained"},s))):null})))},gt=Object(x.a)((function(e){return{root:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column","& button":{minWidth:150,marginTop:e.spacing(2)}},gameMode:{textAlign:"center"},header:{marginTop:e.spacing(4),marginBottom:e.spacing(2)}}})),ht=function(e){var t=gt(),n=Object(a.useCallback)((function(t){var n=t.currentTarget.name;e.screen.handlers.setGameMode(n)}),[e.screen.handlers]),c=Object(a.useMemo)((function(){var t;return null===(t=Ae.mode[e.screen.state.players])||void 0===t?void 0:t.map((function(e){return{props:{key:e,name:e,children:e,onClick:n,disabled:!!Te[e]}}}))}),[e.screen.state.players,n]);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.gameMode},r.a.createElement(vt,{buttons:c})))},Ot=Object(x.a)((function(e){return{fileInput:{display:"none"}}})),jt=function(e){var t=e.onChange,n=e.multiple,c=e.children,o=e.filter,i=Object(D.a)(e,["onChange","multiple","children","filter"]),l=Ot(),s=Object(a.useRef)(),u=Object(a.useCallback)((function(e){if(e){var a=!1===n,r=e.target?Array.from(e.target.files):e.files,c=o?r.filter(o):r;a&&c.length>1&&(c=c.slice(0,1)),t(c)}}),[t,n,o]),d=Object(a.useCallback)((function(){s.current.value=null}),[s]);return r.a.createElement(X.a,Object.assign({component:"label"},i),c,r.a.createElement("input",{type:"file",ref:s,className:l.fileInput,onClick:d,onChange:u,multiple:!1!==n}))},kt=Object(Ge.a)((function(e){return{item:function(t){return{minWidth:t-e.spacing(4),textAlign:"center"}}}})),Et=function(e){var t=Object(a.useState)(0),n=Object(h.a)(t,2),c=n[0],o=n[1],i=kt(c),l=Object(a.useRef)();Object(a.useEffect)((function(){l.current&&o(l.current.clientWidth)}),[]);var s=r.a.useState(null),u=Object(h.a)(s,2),d=u[0],p=u[1],m=Object(a.useCallback)((function(e){p(e.currentTarget)}),[]),f=Object(a.useCallback)((function(){p(null)}),[]),b=Object(a.useCallback)((function(t){return function(){e.handleClick(t),f()}}),[e,f]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{ref:l},r.a.createElement(X.a,{fullWidth:!0,variant:"contained","aria-haspopup":"true",onClick:m,"aria-controls":"mask-menu",disabled:e.disabled},"Select Masks")),r.a.createElement(q.a,{id:"mask-menu",keepMounted:!0,anchorEl:d,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},onClose:f,open:Boolean(d),container:e.containerRef.current||null},Array.from({length:3}).map((function(e,t){return r.a.createElement(K.a,{key:t,button:!0,onClick:b("set".concat(t+1,".zip"))},r.a.createElement("span",{className:i.item},"Game ",t+1))}))))},yt=Object(x.a)((function(e){return{root:function(e){var t=e.flip,n=e.height,a=void 0===n?10:n,r=e.background;return{height:a,background:void 0===r?"rgba(255,255,255,0)":r,width:"100%",borderRadius:50,transform:"scaleX(".concat(t?-1:1,")"),pWebkitTransform:"scaleX(".concat(t?-1:1,")")}},filler:function(e){var t=e.completed;return{height:"100%",textAlign:"left",background:e.color,width:"".concat(t,"%"),borderRadius:"inherit"}}}})),Ct=function(e){var t=yt(e);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.filler}))},wt=n(36),xt=n(96),St=n.n(xt),Lt=n(278),Mt=n.n(Lt),It=(n(279),function(e,t){for(var n=e.data,a=e.width,r=e.height,c=new Uint8ClampedArray(4*e.data.length),o=0;o<r*a;++o){var i=o%a,l=parseInt(o/a),s=n[o],u=t?a-i+a*l:o;c[4*u]=s?255:0,c[4*u+1]=s?255:0,c[4*u+2]=s?255:0,c[4*u+3]=s?255:0}var d=new ImageData(c,a,r),p=cv.matFromImageData(d),m=new cv.MatVector;cv.split(p,m);var f=new cv.Mat;cv.threshold(m.get(0),f,128,1,cv.THRESH_BINARY);var b=new cv.MatVector,v=new cv.Mat;cv.findContours(f,b,v,cv.RETR_CCOMP,cv.CHAIN_APPROX_SIMPLE);for(var g=cv.Mat.zeros(f.rows,f.cols,cv.CV_8UC1),h=0;h<b.size();++h)cv.contourArea(b.get(h))>1e4&&cv.drawContours(g,b,h,[1,1,1,1],-1,cv.LINE_8,v,100);return p.delete(),m.delete(),g}),Rt=function(e,t){var n=It(e,t),a=new cv.MatVector,r=cv.Mat.zeros(n.rows,n.cols,cv.CV_8UC4);cv.split(r,a),a.get(2).setTo([255,0,0,0],n),a.get(3).setTo([128,0,0,0],n);var c=new cv.Mat,o=cv.Mat.ones(10,10,cv.CV_8U),i=new cv.Point(-1,-1);cv.dilate(n,c,o,i,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),cv.subtract(c,n,c),a.get(2).setTo([255,0,0,0],c),a.get(1).setTo([255,0,0,0],c),a.get(3).setTo([255,0,0,0],c),cv.merge(a,r);var l=new ImageData(new Uint8ClampedArray(r.data),r.cols,r.rows);return a.delete(),n.delete(),r.delete(),o.delete(),c.delete(),{overlayImageData:l,binaryImageData:l}},Tt=function(e,t,n){var a=It(t,n),r=new cv.MatVector,c=cv.Mat.zeros(a.rows,a.cols,cv.CV_8UC4);cv.split(c,r),r.get(1).setTo([255,0,0,0],a),r.get(3).setTo([128,0,0,0],a);var o=new cv.Mat,i=cv.Mat.ones(10,10,cv.CV_8U),l=new cv.Point(-1,-1);cv.dilate(a,o,i,l,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),cv.subtract(o,a,o),r.get(1).setTo([255,0,0,0],o),r.get(3).setTo([255,0,0,0],o),cv.merge(r,c);var s=new ImageData(new Uint8ClampedArray(c.data),c.cols,c.rows),u=cv.matFromImageData(e),d=new cv.MatVector;cv.split(u,d);var p=new cv.Mat;cv.addWeighted(c,.5,u,.5,0,p);for(var m=new ImageData(new Uint8ClampedArray(p.data),p.cols,p.rows),f=t.data,b=t.width,v=t.height,g=new Uint8ClampedArray(4*t.data.length),h=0,O=0,j=0;j<v*b;++j){var k=j%b,E=parseInt(j/b),y=n?b-k+b*E:j,C=f[j],w=!!e.data[4*y+2],x=w&&C,S=w&&!C,L=!w&&C,M=L||x||S;x&&O++,(C||w)&&h++,g[4*y]=L?255:0,g[4*y+1]=x?255:0,g[4*y+2]=S?255:0,g[4*y+3]=M?128:0}var I=Math.round(O/(h+1e-7)*100);return r.delete(),a.delete(),c.delete(),i.delete(),o.delete(),p.delete(),{score:I,targetOverlay:m,segOverlay:s}},At=function(e){return"set".concat(e,".zip")},Dt=function(){var e=Object(a.useRef)(),t=R(),n=function(){var e=Object(a.useRef)([]),t=Object(a.useRef)(null),n=Object(a.useRef)(0),r=Object(a.useState)([]),c=Object(h.a)(r,2),o=c[0],i=c[1],l=Object(a.useCallback)((function(t){i(t),e.current="function"===typeof t?t(e.current):t}),[]),s=Object(a.useCallback)((function(){n.current=0,t.current=null}),[]),u=Object(a.useCallback)((function(){var a=e.current[n.current];return a?(t.current=a,n.current++,a):(t.current=null,n.current=0,null)}),[]),d=Object(a.useCallback)((function(){return e.current.length}),[]),p=Object(a.useCallback)((function(){var e=o[Math.floor(Math.random()*o.length)];return t.current=e,e}),[o]);return Object(a.useMemo)((function(){return{next:u,reset:s,random:p,maskRef:t,setMasks:l,getNumMasks:d,hasMasks:!!o.length}}),[u,o,p,s,l,d])}(),r=Object(a.useState)([]),c=Object(h.a)(r,2),o=c[0],i=c[1],l=function(e){var t=R(),n=Object(a.useState)(!1),r=Object(h.a)(n,2),c=r[0],o=r[1],i=Object(a.useCallback)(function(){var n=Object(M.a)(L.a.mark((function n(a){var r,c,i;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,St.a.loadAsync(a);case 2:return r=n.sent,n.next=5,Promise.all(r.filter((function(e){return e.endsWith(".png")})).map((function(e){var t=e.name;return r.file(t).async("base64")})));case 5:return c=n.sent,n.prev=6,n.next=9,Promise.all(c.map((function(e){return t.dataUriToImageData("data:image/png;base64,".concat(e))})));case 9:i=n.sent,e(i),n.next=15;break;case 13:n.prev=13,n.t0=n.catch(6);case 15:o(!1);case 16:case"end":return n.stop()}}),n,null,[[6,13]])})));return function(e){return n.apply(this,arguments)}}(),[e,t]),l=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(t){var n,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(h.a)(t,1),"application/zip"===(a=n[0]).type){e.next=4;break}return console.error("Expected a zip file but got",a.type),e.abrupt("return");case 4:return o(!0),e.next=7,i(a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i]),s=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(t){var n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return o(!0),e.next=5,new St.a.external.Promise((function(e,n){Mt.a.getBinaryContent("/rob_and_adam_code_a_thing"+"/masks/".concat(t),(function(t,a){t?n(t):e(a)}))}));case 5:return n=e.sent,e.next=8,i(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i]),u=Object(a.useCallback)(Object(M.a)(L.a.mark((function e(){var t;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Math.floor(3*Math.random()),e.abrupt("return",s(At(t+1)));case 2:case"end":return e.stop()}}),e)}))),[s]);return Object(a.useMemo)((function(){return{loading:c,handleZipInputChange:l,handleLoadRandomMaskSet:u,handleLoadPreparedMasks:s}}),[c,l,s,u])}(n.setMasks),s=Object(a.useState)(0),u=Object(h.a)(s,2),d=u[0],p=u[1],m=Object(a.useCallback)((function(){i([])}),[]),f=Object(a.useCallback)(function(){var a=Object(M.a)(L.a.mark((function a(r){var c;return L.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return 3e3,r.time.first?(n.next(),p(0),m(),r.useTimer({maxLaps:n.getNumMasks(),printSeconds:!0,announceSeconds:!0,lapDuration:3e3,newLapDelay:1e3,onLap:function(a){var r=a.predict,c=(a.time,a.stop),o=n.maskRef.current;if(!o)return c();e.current=r(t.videoRef.current).then(function(){var e=Object(M.a)(L.a.mark((function e(a){var r,c,l,s;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Tt(o,a,t.flipX),c=r.score,l=r.targetOverlay,s=t.imageDataToDataUri(l),i((function(e){return[].concat(Object(wt.a)(e),[{score:c,dataUri:s}])})),t.clearCanvas(),n.next();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}})):(c=Math.min(r.time.lapTime/3e3,1),p(Math.round(100*c))),n.maskRef.current&&t.ctx.putImageData(n.maskRef.current,0,0),a.abrupt("return",(function(){e.current?e.current.then(r.webcam.clearCanvas):r.webcam.clearCanvas()}));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),[t,n,m]),b=Object(a.useCallback)(function(){var a=Object(M.a)(L.a.mark((function a(r){var c;return L.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return 3e3,r.time.first?(n.random(),p(0),m(),r.useTimer({maxLaps:9999999,printSeconds:!0,announceSeconds:!0,lapDuration:3e3,newLapDelay:1e3,onLap:function(a){var r=a.predict,c=(a.time,a.stop),o=n.maskRef.current;if(!o)return c();e.current=r(t.videoRef.current).then(function(){var e=Object(M.a)(L.a.mark((function e(a){var r,l,s,u;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Tt(o,a,t.flipX),l=r.score,s=r.targetOverlay,u=t.imageDataToDataUri(s),i((function(e){return[].concat(Object(wt.a)(e),[{score:l,dataUri:u}])})),t.clearCanvas(),!(qe(l)<5)){e.next=10;break}return n.reset(),e.abrupt("return",c());case 10:n.random();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}})):(c=Math.min(r.time.lapTime/3e3,1),p(Math.round(100*c))),n.maskRef.current&&t.ctx.putImageData(n.maskRef.current,0,0),a.abrupt("return",(function(){e.current?e.current.then(r.webcam.clearCanvas):r.webcam.clearCanvas()}));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),[t,n,m]);return Object(a.useMemo)((function(){return{zip:l,scores:o,handleLoop:f,handleSurvivalLoop:b,clearScores:m,progressPercent:d,reset:n.reset,ready:n.hasMasks,setMasks:n.setMasks}}),[l,o,d,f,b,m,n.hasMasks,n.reset,n.setMasks])},Pt=n(280),Nt=n.n(Pt),Ft=function(){var e=Object(a.useRef)(),t=Object(a.useState)([]),n=Object(h.a)(t,2),r=n[0],c=n[1],o=Object(a.useCallback)((function(e){var t=e.currentTarget.name;c((function(e){return e.filter((function(e,n){return n!==+t}))}))}),[]),i=Object(a.useCallback)((function(){c([])}),[]),l=Object(a.useCallback)((function(){var e=new St.a,t=e.folder("masks");r.forEach((function(e,n){var a=e.overlay;t.file("mask-".concat(n,".png"),Nt.a.decode(a).dataBase64,{base64:!0})})),e.generateAsync({type:"blob"}).then((function(e){return function(e,t){if("undefined"!==typeof navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,t);if("undefined"!==typeof navigator.msSaveBlob)return navigator.msSaveBlob(e,t);var n=window.document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t,n.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(n),"function"===typeof n.click?n.click():(n.target="_blank",n.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),URL.revokeObjectURL(n.href)}(e,"masks.zip")}))}),[r]),s=Object(a.useCallback)(function(){var t=Object(M.a)(L.a.mark((function t(n){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.time.first&&n.useTimer({printSeconds:!0,announceSeconds:!0,lapDuration:3e3,newLapDelay:1e3,onBeforeStartLap:function(){var e=Object(M.a)(L.a.mark((function e(t){var n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.predict,t.webcam,t.time,t.stop,e.abrupt("return",n());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onLap:function(t){var n=t.predict,a=t.webcam;t.time,t.stop;e.current=n(a.videoRef.current).then(function(){var e=Object(M.a)(L.a.mark((function e(t){var n,r,o,i,l;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Rt(t,a.flipX),r=n.overlayImageData,o=n.binaryImageData,i=a.imageDataToDataUri(r),l=a.imageDataToDataUri(o),a.clearCanvas(),a.ctx.putImageData(r,0,0),c((function(e){return[].concat(Object(wt.a)(e),[{overlay:i,binary:l}])}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}),t.abrupt("return",(function(){e.current?e.current.then(n.webcam.clearCanvas):n.webcam.clearCanvas()}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]);return Object(a.useMemo)((function(){return{masks:r,handleLoop:s,removeMask:o,downloadMasks:l,removeAllMasks:i}}),[r,s,o,l,i])},_t=function(e){var t=R(),n=Dt(),r=Ft(),c=Object(a.useState)(null),o=Object(h.a)(c,2),i=o[0],l=o[1];Object(a.useEffect)((function(){!e.looping&&i&&l(null)}),[e.looping,i]);var s=Object(a.useCallback)(Object(M.a)(L.a.mark((function t(){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.looping?(e.stop(),n.reset()):(e.start(n.handleLoop),l("play"));case 1:case"end":return t.stop()}}),t)}))),[e,n]),u=Object(a.useCallback)(Object(M.a)(L.a.mark((function t(){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.looping){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,n.zip.handleLoadRandomMaskSet();case 4:s();case 5:case"end":return t.stop()}}),t)}))),[s,e.looping,n.zip]),d=Object(a.useCallback)((function(){e.looping?(e.stop(),n.reset()):(e.start(r.handleLoop),l("capture"))}),[e,r,n]),p=Object(a.useCallback)(Object(M.a)(L.a.mark((function a(){var c;return L.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.looping){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,Promise.all(r.masks.map((function(e){var n=e.overlay;return t.dataUriToImageData(n)})));case 4:c=a.sent,n.setMasks(c),s();case 7:case"end":return a.stop()}}),a)}))),[r.masks,n,t,s,e.looping]);return Object(a.useMemo)((function(){return{loopType:i,simpleGame:n,captureMasks:r,handleClickGame:s,handleStartRandomGame:u,handlePlayCapturedMasks:p,handleClickCaptureMasks:d}}),[i,n,r,s,u,p,d])},Ut=Object(Ge.a)((function(e){return{root:{padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",overflow:"scroll"},overlay:{background:"rgba(255,255,255,0.5)"},rootTop:{justifyContent:"flex-start"},rootApart:{justifyContent:"space-between"},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},captures:{width:"100%","& > div":{marginTop:e.spacing(1)}},progress:{position:"absolute",top:e.spacing(1),left:e.spacing(8),right:e.spacing(8)}}})),Bt=function(e){var t,n,c,o=Ut(),i=nn(),l=R(),s=Object(a.useRef)(),u=an(_t),d=u.loopType,p=u.simpleGame,m=u.captureMasks,f=u.handleClickGame,b=u.handleStartRandomGame,v=u.handlePlayCapturedMasks,g=u.handleClickCaptureMasks,h=i.loop,O=He(100-p.progressPercent),j=Object(a.useMemo)((function(){return[{props:{key:"play/stop",onClick:f,disabled:!h.ready||!h.looping&&!p.ready,children:h.looping?"Stop":"Play"}},{props:{key:"playRandom",color:"secondary",onClick:b,disabled:!h.ready||h.looping,children:"Play Random"}},{props:{containerRef:s,key:"chooseMasks",disabled:!h.ready||h.looping,handleClick:p.zip.handleLoadPreparedMasks},Component:Et,visible:!h.looping},{props:{key:"loadMasks",variant:"contained",onChange:p.zip.handleZipInputChange,disabled:!h.ready||h.looping||p.zip.loading,children:p.loading?"Loading...":"Load Masks"},Component:jt,visible:!h.looping},{props:{key:"captureMasks",onClick:g,disabled:!h.ready||h.looping,children:"Capture Masks",color:"default"},visible:!h.looping}]}),[h.ready,h.looping,f,p.ready,p.loading,b,p.zip.loading,g,p.zip.handleZipInputChange,p.zip.handleLoadPreparedMasks]);return r.a.createElement("div",{className:pe()(o.root,(c={},Object(P.a)(c,o.overlay,!h.looping),Object(P.a)(c,o.rootTop,!!h.looping),Object(P.a)(c,o.rootApart,!(!(null===(t=p.scores)||void 0===t?void 0:t.length)&&!(null===(n=m.masks)||void 0===n?void 0:n.length))&&l.isFullScreen),c))},r.a.createElement("div",{className:pe()(Object(P.a)({},o.optionsTop,!!h.looping)),ref:s},h.looping?r.a.createElement(vt,{offset:70,buttons:[{props:{key:"stop",onClick:f,children:"Stop"}}]}):r.a.createElement(vt,{buttons:j}),h.looping&&"play"===d&&r.a.createElement("div",{className:o.progress},r.a.createElement(Ct,{color:O,completed:100-p.progressPercent}))),l.isFullScreen&&!h.looping&&r.a.createElement("div",{className:o.captures},r.a.createElement(tt,{results:p.scores,handleClose:p.clearScores}),r.a.createElement(st,{captureMasks:m,handlePlay:v})))},zt=function(e){var t=Dt(),n=Ft(),r=Object(a.useRef)(!1);Object(a.useEffect)((function(){r.current||(r.current=!0,t.zip.handleLoadPreparedMasks("survival_2.zip"))}),[t]);var c=Object(a.useCallback)(Object(M.a)(L.a.mark((function n(){return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.looping?e.stop():e.start(t.handleSurvivalLoop);case 1:case"end":return n.stop()}}),n)}))),[e,t]),o=Object(a.useCallback)((function(){e.looping?e.stop():e.start(n.handleLoop)}),[e,n]);return Object(a.useMemo)((function(){return{loop:e,simpleGame:t,captureMasks:n,handleClickGame:c,handleClickCaptureMasks:o}}),[o,c,e,t,n])},Vt=Object(Ge.a)((function(e){return{root:{padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overlay:{background:"rgba(255,255,255,0.5)"},rootTop:{justifyContent:"flex-start"},rootApart:{justifyContent:"space-between"},options:{display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"space-between",marginBottom:e.spacing(1),"& > *":{marginTop:e.spacing(2),minWidth:150}},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},captures:{width:"100%","& > div":{marginTop:e.spacing(1)}},progress:{position:"absolute",top:e.spacing(1),left:e.spacing(8),right:e.spacing(8)}}})),Gt=function(e){var t,n,a,c=Vt(),o=an(zt),i=R(),l=o.loop,s=o.simpleGame,u=o.captureMasks,d=o.handleClickGame,p=He(100-s.progressPercent);return r.a.createElement("div",{className:pe()(c.root,(a={},Object(P.a)(a,c.overlay,!l.looping),Object(P.a)(a,c.rootTop,!!l.looping),Object(P.a)(a,c.rootApart,!(!(null===(t=s.scores)||void 0===t?void 0:t.length)&&!(null===(n=u.masks)||void 0===n?void 0:n.length))&&i.isFullScreen),a))},r.a.createElement("div",{className:pe()(c.options,Object(P.a)({},c.optionsTop,!!l.looping))},l.looping?r.a.createElement("div",{className:c.progress},r.a.createElement(Ct,{color:p,completed:100-s.progressPercent})):r.a.createElement(X.a,{color:"primary",variant:"contained",onClick:d,disabled:!l.ready},"Play")),i.isFullScreen&&!l.looping&&r.a.createElement("div",{className:c.captures},r.a.createElement(tt,{results:s.scores,handleClose:s.clearScores}),r.a.createElement(st,{captureMasks:u})))},Wt=Object(x.a)((function(e){return{root:{height:"100%",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center","& button":{minWidth:150,marginTop:e.spacing(2)}},transition:{textAlign:"center"},header:{marginBottom:e.spacing(2)}}})),Yt=function(e){var t=Wt(),n=Object(a.useCallback)((function(t){var n=t.currentTarget.name;e.setPlayerMode(n)}),[e]),c=Object(a.useMemo)((function(){return Ae.players.map((function(e){return{props:{key:e,name:e,children:e,onClick:n,disabled:!!Te[e]}}}))}),[n]);return r.a.createElement("div",{className:t.root},r.a.createElement(vt,{buttons:c}))},qt=Object(P.a)({},Re.screen.PLAY,(g={},Object(P.a)(g,Re.players.SINGLE_PLAYER,(b={},Object(P.a)(b,Re.mode[Re.players.SINGLE_PLAYER].PRACTICE,Bt),Object(P.a)(b,Re.mode[Re.players.SINGLE_PLAYER].SURVIVAL,Gt),Object(P.a)(b,Re.mode[Re.players.SINGLE_PLAYER].TIME_ATTACK,(function(){return"TIME_ATTACK Content"})),b)),Object(P.a)(g,Re.players.MULTIPLAYER,(v={},Object(P.a)(v,Re.mode[Re.players.MULTIPLAYER].LOCAL,(function(){return"LOCAL Content"})),Object(P.a)(v,Re.mode[Re.players.MULTIPLAYER].REMOTE,(function(){return"REMOTE Content"})),v)),g)),Xt=function(e){var t,n,a=e.screen.state,c=a.screen,o=a.mode,i=a.players;if(c===Re.screen.DEFAULT)return r.a.createElement(Yt,{setPlayerMode:e.screen.handlers.setPlayerMode});if(o===Re.mode.DEFAULT)return r.a.createElement(ht,{screen:e.screen});var l=(null===(t=qt[c])||void 0===t||null===(n=t[i])||void 0===n?void 0:n[o])||Fe;return r.a.createElement(l,null)},Ht=function(e,t){switch(t.type){case Le:return Object(N.a)(Object(N.a)({},e),{},{mode:t.value});case Se:return Object(N.a)(Object(N.a)({},e),{},{screen:Re.screen.PLAY,players:t.value});case Ie:return De;case Me:var n=Object(N.a)({},e);if(e.mode)n.mode=Re.mode.DEFAULT;else{if(e.screen===Re.screen.DEFAULT)return e;n.screen=Re.screen.DEFAULT,n.players=Re.players.DEFAULT}return n;default:throw new Error("Invalid action: ".concat(t.type))}},Kt=n(281),$t=n.n(Kt)()(),Zt=Object(a.createContext)(),Jt=function(e){var t=e.children,n=function(){var e=R(),t=Object(a.useRef)(),n=Object(a.useRef)(),r=Object(a.useState)(!1),c=Object(h.a)(r,2),o=c[0],i=c[1],l=Object(a.useState)(!1),s=Object(h.a)(l,2),u=s[0],d=s[1];Object(a.useEffect)((function(){!t.current&&e.ready&&(t.current=!0,$t.load().then((function(){console.log("BodyPix loaded"),i(!0)})).catch(console.error))}),[e]);var p=Object(a.useCallback)(Object(M.a)(L.a.mark((function t(){var n;return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o){t.next=2;break}throw new Error('Please wait for the model to load before calling "predict"');case 2:return t.next=4,$t.predict(e.getVideoAsImageData());case 4:return n=t.sent,t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)}))),[o,e]);return Object(a.useEffect)((function(){!o||n.current||u||(n.current=!0,p().then((function(){d(!0)})))}),[p,o,u]),u?p:null}();return r.a.createElement(Zt.Provider,{value:n},t)},Qt=function(){var e=R(),t=function(){var e=Object(a.useContext)(Zt);if(void 0===e)throw new Error("useBodyPix must be used within a BodyPixProvider");return e}(),n=function(){var e=Object(a.useRef)(),t=Object(a.useRef)(),n=Object(a.useRef)(),r=Object(a.useRef)(),c=Object(a.useRef)(),o=Object(a.useCallback)((function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t.current=a,e.current=a,r.current=0,n.current=0,c.current=0}),[]),i=Object(a.useCallback)((function(){c.current=0}),[]),l=Object(a.useCallback)((function(a){var l=!1;t.current||(l=!0,o(a));var s=a-e.current;c.current+=s;var u=0,d=0;n.current++&&(u=1e3/s,d=r.current/n.current,r.current+=u);var p=a-t.current;return e.current=a,{first:l,timestamp:a,fps:u,avgFps:d,elapsed:p,frames:n.current,lapTime:c.current,resetLapTime:i}}),[o,i]);return Object(a.useMemo)((function(){return{update:l,reset:o}}),[l,o])}(),r=function(){var e=Object(a.useRef)(),t=Ce().handlers.speech,n=Object(a.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.onBeforeStartLap,a=t.onLap,r=t.onEnd,c=t.maxLaps,o=t.lapDuration,i=void 0===o?3e3:o,l=t.postLapDelay,s=void 0===l?1e3:l,u=t.printSeconds,d=void 0===u||u,p=t.announceSeconds,m=void 0===p||p;a&&!e.current&&(e.current={onBeforeStartLap:n,onBeforeComplete:!1,onBeforeStarted:!1,onLap:a,onEnd:r,maxLaps:c,numLaps:0,lapDuration:i,postLapDelay:s,printSeconds:d,announceSeconds:m})}),[]),r=Object(a.useCallback)(function(){var n=Object(M.a)(L.a.mark((function n(a){var r,c,o,i,l,s,u;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=a.time,c=a.webcam,o=a.predict,i=a.stop,!e.current){n.next=33;break}if(!e.current.onBeforeStartLap||e.current.onBeforeComplete){n.next=13;break}if(!e.current.onBeforeStarted){n.next=7;break}return n.abrupt("return");case 7:return e.current.onBeforeStarted=!0,n.next=10,e.current.onBeforeStartLap({time:r,webcam:c,predict:o,stop:i});case 10:return e.current.onBeforeComplete=!0,r.resetLapTime(),n.abrupt("return");case 13:if(!e.current.maxLaps||e.current.numLaps!==e.current.maxLaps){n.next=19;break}if(!e.current.onEnd){n.next=17;break}return n.next=17,e.current.onEnd({time:r,webcam:c,predict:o,stop:i});case 17:return e.current=null,n.abrupt("return",i());case 19:if(l=Math.floor(r.lapTime/1e3),s=Math.max(e.current.lapDuration/1e3-l,0),e.current.printSeconds&&((u=c.ctx).font="40px Arial",u.fillStyle="white",u.clearRect(0,0,50,50),s&&u.fillText(s,10,40)),s&&e.current.announceSeconds&&e.current.lastSpeech!==s&&(e.current.lastSpeech=s,t.say("".concat(s))),!(r.lapTime>=e.current.lapDuration)||e.current.handlerCalled){n.next=32;break}return e.current.numLaps++,e.current.handlerCalled=!0,e.current.handlerResolved=!1,n.next=29,e.current.onLap({time:r,webcam:c,predict:o,stop:i,lapNum:e.current.numLaps});case 29:e.current.handlerResolved=!0,n.next=33;break;case 32:r.lapTime>=e.current.lapDuration+e.current.postLapDelay&&e.current.handlerResolved&&(r.resetLapTime(),e.current.handlerCalled=!1,e.current.handlerResolved=!1);case 33:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[t]),c=Object(a.useCallback)((function(){e.current=null}),[]);return Object(a.useMemo)((function(){return{clear:c,useTimer:n,handleLap:r}}),[c,n,r])}(),c=Object(a.useRef)(),o=Object(a.useRef)(),i=Object(a.useState)(!1),l=Object(h.a)(i,2),s=l[0],u=l[1],d=Object(a.useCallback)((function(){r.clear(),n.reset(),c.current=!0,u(!0)}),[n,r]),p=Object(a.useCallback)((function(){c.current=!1,u(!1)}),[]),m=Object(a.useCallback)(function(){var a=Object(M.a)(L.a.mark((function a(i){var l,s;return L.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return l=n.update(i),a.next=3,o.current({time:l,webcam:e,predict:t,useTimer:r.useTimer,stop:p});case 3:s=a.sent,r.handleLap({time:l,webcam:e,predict:t,stop:p}),c.current?requestAnimationFrame(m):(p(),o.current=null,e.clearCanvas(),s&&s());case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),[e,t,r,n,p]),f=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(n){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.current){e.next=4;break}throw new Error("The loop is already running");case 4:if(t){e.next=8;break}throw new Error("Please wait for BodyPix to load...");case 8:if(n){e.next=10;break}throw new Error("A loop handler is required when calling loop.start");case 10:return o.current=n,d(),e.abrupt("return",requestAnimationFrame(m));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[m,t,d]);return Object(a.useMemo)((function(){return{start:f,looping:s,stop:p,ready:t&&e.ready}}),[f,t,s,p,e.ready])},en=function(){var e=Qt(),t=Object(a.useState)(null),n=Object(h.a)(t,2),r=n[0],c=n[1],o=function(){var e=Object(a.useReducer)(Ht,De),t=Object(h.a)(e,2),n=t[0],r=t[1],c=Object(a.useCallback)((function(e){if(!Ae.screen.includes(e))throw new Error("Unknown screen: ".concat(e));r({type:xe,value:e})}),[]),o=Object(a.useCallback)((function(e){if(![].concat(Object(wt.a)(Ae.mode[Re.players.SINGLE_PLAYER]),Object(wt.a)(Ae.mode[Re.players.MULTIPLAYER])).includes(e))throw new Error("Unknown gameMode: ".concat(e));r({type:Le,value:e})}),[]),i=Object(a.useCallback)((function(e){if(!Ae.players.includes(e))throw new Error("Unknown playerMode: ".concat(e));r({type:Se,value:e})}),[]),l=Object(a.useCallback)((function(){r({type:Ie})}),[]),s=Object(a.useCallback)((function(){r({type:Me})}),[]);return[n,Object(a.useMemo)((function(){return{setScreen:c,resetState:l,setGameMode:o,reverseState:s,setPlayerMode:i}}),[c,l,o,s,i])]}(),i=Object(h.a)(o,2),l=i[0],s=i[1];return Object(a.useEffect)((function(){l.screen!==Re.screen.DEFAULT&&l.mode!==Re.mode.DEFAULT||!r||c(null)}),[l,r]),Object(a.useEffect)((function(){l.screen!==Re.screen.DEFAULT&&l.mode!==Re.mode.DEFAULT||!e.looping||e.stop()}),[l,e]),Object(a.useMemo)((function(){return{screen:{state:l,handlers:s},mode:r,loop:e,setMode:c}}),[l,s,r,e])},tn=Object(a.createContext)(),nn=function(){var e=Object(a.useContext)(tn);if(!e)throw new Error("useGame must be called from inside the <Game> component.");return e},an=function(e){var t=nn(),n=t.loop,r=t.setMode,c=e(n);return Object(a.useEffect)((function(){r(c)}),[c,r]),c},rn=Object(a.memo)((function(e){e.webcam;var t=en();return r.a.createElement(tn.Provider,{value:t},r.a.createElement(Ne,{mode:t.screen.state.mode,screen:t.screen.state.screen,goHome:t.screen.handlers.resetState,goBack:t.screen.handlers.reverseState}),r.a.createElement(Ve,{screenState:t.screen.state}),r.a.createElement(ue,{overlay:!t.screen.state.mode},r.a.createElement(Xt,{screen:t.screen})),r.a.createElement(ft,{screen:t.screen}))})),cn=function(){return r.a.createElement("div",null,"Sorry, but this game requires a webcam. Please plug in a webcam and refresh the page.")},on=Object(x.a)((function(e){return{root:{maxWidth:1100,margin:"0 auto ".concat(e.spacing(2),"px")}}})),ln=Object(a.memo)((function(e){var t=R(),n=t.currentDeviceId,c=t.hasVideo,o=t.cameras,i=t.autoStartDeviceId,l=Object(a.useRef)();Object(a.useEffect)((function(){c&&o.length&&(n||i)&&!l.current&&(l.current=!0,t.start().catch(console.error))}),[c,o,n,i]);var s=on();return r.a.createElement("main",{className:s.root},c?r.a.createElement(rn,{webcam:t}):r.a.createElement(cn,null))})),sn=Object(E.a)({palette:{primary:w.a}});var un=function(){var e=Object(a.useState)(!1),t=Object(h.a)(e,2),n=t[0],c=t[1],o=Object(a.useRef)();return Object(a.useEffect)((function(){var e=setInterval((function(){window.cvReady&&(c(!0),clearInterval(e))}),200);return function(){clearInterval(e)}}),[]),Object(a.useEffect)((function(){o.current||(o.current=!0,j.a.init({selector:".background"}))})),r.a.createElement(y.a,{theme:sn},r.a.createElement(A,null,r.a.createElement(Jt,null,r.a.createElement(we,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,null),r.a.createElement(ln,{cvReady:n}))))))};o.a.render(r.a.createElement(un,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[292,1,2]]]);
//# sourceMappingURL=main.299764e2.chunk.js.map