(this.webpackJsonprob_and_adam_code_a_thing=this.webpackJsonprob_and_adam_code_a_thing||[]).push([[0],{280:function(e,t,n){var a=n(556),r=["load","predict"];e.exports=function(){var e=new Worker(n.p+"60a0dfbb6ed702cd6027.worker.js",{name:"[hash].worker.js"});return a(e,r),e}},292:function(e,t,n){e.exports=n(557)},297:function(e,t,n){},311:function(e,t){},313:function(e,t){},361:function(e,t){},363:function(e,t){},391:function(e,t){},393:function(e,t){},394:function(e,t){},400:function(e,t){},402:function(e,t){},420:function(e,t){},422:function(e,t){},434:function(e,t){},437:function(e,t){},442:function(e,t){},444:function(e,t){},467:function(e,t){},557:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(16),o=n.n(c);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(297);var i,l,u,s,d,m,p,f,b,v,g,h=n(3),O=n(259),j=n.n(O),k=n(588),E=n(282),y=n(587),C=n(281),w=n.n(C),x=n(558),S=n(4),L=n.n(S),M=n(13),I=Object(a.createContext)(),R=function(){var e=Object(a.useContext)(I);if(!e)throw new Error("useWebcam must be used within a WebcamProvider");return e},T=!!(null===(i=navigator)||void 0===i||null===(l=i.mediaDevices)||void 0===l?void 0:l.getUserMedia),A=function(e){var t,n,c,o,i=e.children,l=Object(a.useRef)(),u=Object(a.useRef)(),s=Object(a.useRef)(),d=Object(a.useState)(null),m=Object(h.a)(d,2),p=m[0],f=m[1],b=Object(a.useState)(!0),v=Object(h.a)(b,2),g=v[0],O=v[1],j=Object(a.useState)(!1),k=Object(h.a)(j,2),E=k[0],y=k[1],C=Object(a.useState)([]),w=Object(h.a)(C,2),x=w[0],S=w[1],R=Object(a.useState)(!0),A=Object(h.a)(R,2),D=A[0],P=A[1],N=Object(a.useState)(null),F=Object(h.a)(N,2),_=F[0],U=F[1],B=Object(a.useState)(null),z=Object(h.a)(B,2),V=z[0],Y=z[1],W=Object(a.useState)(null),G=Object(h.a)(W,2),q=G[0],X=G[1],H=Object(a.useState)(void 0),K=Object(h.a)(H,2),$=K[0],Z=K[1],J=Object(a.useState)(void 0),Q=Object(h.a)(J,2),ee=Q[0],te=Q[1];Object(a.useEffect)((function(){s.current&&!p?f(s.current.getContext("2d")):p&&!s.current&&f(null)}),[p]),Object(a.useEffect)((function(){if(E&&!_){var e=document.createElement("canvas");e.width=s.current.width,e.height=s.current.height;var t=e.getContext("2d");U({ctx:t,canvas:e})}}),[_,E]);var ne=Object(a.useCallback)((function(){P(!1)}),[]),ae=Object(a.useCallback)((function(){P(!0)}),[]),re=Object(a.useCallback)((function(){_.ctx.clearRect(0,0,s.current.width,s.current.height)}),[_]),ce=Object(a.useCallback)((function(){p.clearRect(0,0,s.current.width,s.current.height)}),[p]),oe=Object(a.useCallback)((function(){q&&q.getTracks().forEach((function(e){return e.stop()})),Y(null),X(null),y(!1),Z(void 0)}),[q]),ie=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(t){var n,a,r,c,o,i,l,s,d;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(oe(),T){e.next=6;break}return"Video not supported",console.error("Video not supported"),Y("Video not supported"),e.abrupt("return");case 6:return a=(n="number"===typeof t)?{}:t||{},r=n?t:a.deviceIdx,e.prev=9,console.log("Finding Webcams..."),i={video:{width:{exact:a.width||1280},height:{exact:a.height||720}},audio:!1},void 0!==r&&(a.deviceId=null===(l=x[r])||void 0===l?void 0:l.deviceId),a.deviceId&&(i.video.deviceId={exact:a.deviceId}),e.next=16,navigator.mediaDevices.getUserMedia(i);case 16:s=e.sent,d=null===(c=s.getTracks()[0])||void 0===c||null===(o=c.getCapabilities())||void 0===o?void 0:o.deviceId,console.log("Found webcam!"),X(s),Z(d),u.current.srcObject=s,e.next=33;break;case 24:return e.prev=24,e.t0=e.catch(9),"Error starting video.",console.error("Error starting video."),console.error(e.t0.message),X(null),y(!1),Y("Error starting video."),e.abrupt("return");case 33:return e.next=35,Promise.all([new Promise((function(e){u.current.onloadedmetadata=function(){return e()}})),new Promise((function(e){u.current.onloadeddata=function(){return e()}}))]).then((function(){console.log("Webcam ready!"),y(!0),P(!1)}));case 35:return e.abrupt("return",e.sent);case 36:case"end":return e.stop()}}),e,null,[[9,24]])})));return function(t){return e.apply(this,arguments)}}(),[oe,u,x]),le=Object(a.useCallback)(Object(M.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ie({deviceId:ee}));case 1:case"end":return e.stop()}}),e)}))),[ee,ie]),ue=Object(a.useCallback)(Object(M.a)(L.a.mark((function e(){var t,n,a,r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=navigator)||void 0===t||null===(n=t.mediaDevices)||void 0===n?void 0:n.enumerateDevices){e.next=4;break}return console.error("Cannot get cameras."),e.abrupt("return",[]);case 4:return e.next=6,navigator.mediaDevices.enumerateDevices();case 6:return a=e.sent,r=a.filter((function(e){var t=e.kind,n=e.label;return"videoinput"===t&&!n.includes("CamTwist")})).map((function(e){var t,n=e.label.lastIndexOf(" (");return n>-1&&(t=e.label.slice(0,n)),t?{deviceId:e.deviceId,label:t}:e})),S(r),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)}))),[]),se=Object(a.useCallback)((function(){return O((function(e){return!e}))}),[]),de=Object(a.useCallback)((function(e){window.localStorage.setItem("AutoStartId",e),te(e)}),[]),me=Object(a.useCallback)((function(){window.localStorage.removeItem("AutoStartId"),te(null)}),[]),pe=Object(a.useCallback)((function(e){re(),_.ctx.putImageData(e,0,0);var t=_.canvas.toDataURL("image/png");return re(),t}),[_,re]),fe=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(t){var n,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return re(),(n=new Image).src=t,e.next=5,new Promise((function(e){n.onload=function(){_.ctx.drawImage(n,0,0),e()}}));case 5:return a=_.ctx.getImageData(0,0,s.current.width,s.current.height),re(),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[re,_]),be=Object(a.useCallback)((function(){re(),_.ctx.drawImage(u.current,0,0);var e=_.ctx.getImageData(0,0,s.current.width,s.current.height);return re(),e}),[re,_]);Object(a.useEffect)((function(){ue().then((function(e){var t=window.localStorage.getItem("AutoStartId"),n=e.reduce((function(n,a,r){var c=a.deviceId,o=a.label;return n||(c===t||!t&&1===e.length&&0===r||!t&&o.includes("Built-in")?c:null)}),null);n?de(n):!n&&t&&me()}))}),[]);var ve=!!((null===(t=l.current)||void 0===t?void 0:t.requestFullscreen)||(null===(n=l.current)||void 0===n?void 0:n.mozRequestFullScreen)||(null===(c=l.current)||void 0===c?void 0:c.webkitRequestFullscreen)||(null===(o=l.current)||void 0===o?void 0:o.msRequestFullscreen)),ge=Object(a.useState)(!1),he=Object(h.a)(ge,2),Oe=he[0],je=he[1];Object(a.useEffect)((function(){var e=function(){var e=!!document.fullscreenElement;je(e)};return document.addEventListener("fullscreenchange",e),function(){return document.removeEventListener("fullscreenchange",e)}}),[]);var ke=Object(a.useCallback)((function(){ve&&(l.current.requestFullscreen?l.current.requestFullscreen():l.current.mozRequestFullScreen?l.current.mozRequestFullScreen():l.current.webkitRequestFullscreen?l.current.webkitRequestFullscreen():l.current.msRequestFullscreen&&l.current.msRequestFullscreen())}),[ve]),Ee=Object(a.useCallback)((function(){ve&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())}),[ve]),ye=Object(a.useCallback)((function(){Oe?Ee():ke()}),[Oe,ke,Ee]),Ce=Object(a.useMemo)((function(){return{ctx:p,ready:E,flipX:g,start:le,hidden:D,rootRef:l,cameras:x,setFlipX:O,videoRef:u,hasVideo:T,_setHidden:ae,canvasRef:s,stopVideo:oe,setVisible:ne,startVideo:ie,videoError:V,scratchpad:_,clearCanvas:ce,toggleFlipX:se,videoStream:q,hasFullScreen:ve,exitFullScreen:Ee,clearScratchpad:re,currentDeviceId:$,enterFullScreen:ke,stop:oe,discoverCameras:ue,toggleFullScreen:ye,autoStartDeviceId:ee,imageDataToDataUri:pe,dataUriToImageData:fe,getVideoAsImageData:be,setAutoStartDeviceId:de,clearAutoStartDeviceId:me,isFullScreen:Oe}}),[p,E,g,le,D,x,O,ae,oe,Oe,ne,ie,V,_,se,ce,q,ve,Ee,re,$,ke,ue,ye,ee,pe,fe,be,de,me]);return r.a.createElement(I.Provider,{value:Ce},i)},D=n(6),P=n(115),N=n(22),F=n(66),_=n.n(F),U=n(580),B=n(34),z=n(265),V=n.n(z),Y=n(264),W=n.n(Y),G=function(e){var t=e.color,n=void 0===t?"#fff":t,a=Object(B.c)({to:{opacity:1},from:{opacity:0},config:B.b.stiff});return r.a.createElement(B.a.div,{style:a},r.a.createElement("svg",{version:"1.1",id:"L7",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 100 100",enableBackground:"new 0 0 100 100"},r.a.createElement("path",{fill:n,d:"M31.6,3.5C5.9,13.6-6.6,42.7,3.5,68.4c10.1,25.7,39.2,38.3,64.9,28.1l-3.1-7.9c-21.3,8.4-45.4-2-53.8-23.3 c-8.4-21.3,2-45.4,23.3-53.8L31.6,3.5z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"2s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"})),r.a.createElement("path",{fill:n,d:"M42.3,39.6c5.7-4.3,13.9-3.1,18.1,2.7c4.3,5.7,3.1,13.9-2.7,18.1l4.1,5.5c8.8-6.5,10.6-19,4.1-27.7 c-6.5-8.8-19-10.6-27.7-4.1L42.3,39.6z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"1s",from:"0 50 50",to:"-360 50 50",repeatCount:"indefinite"})),r.a.createElement("path",{fill:n,d:"M82,35.7C74.1,18,53.4,10.1,35.7,18S10.1,46.6,18,64.3l7.6-3.4c-6-13.5,0-29.3,13.5-35.3s29.3,0,35.3,13.5 L82,35.7z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"2s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"}))))},q=Object(x.a)((function(e){return{root:function(t){var n=t.isFullScreen;return Object(N.a)({maxWidth:1100,margin:"0 auto",position:"relative",height:"calc(0.5625 * (100vw - ".concat(e.spacing(4),"px))"),maxHeight:"calc(0.5625 * (1200px - ".concat(e.spacing(4),"px))")},n?{display:"flex",alignItems:"center",justifyContent:"center"}:{})},container:function(t){var n=t.isFullScreen;return{width:"100%",position:"relative",paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},video:function(t){var n=t.flipX,a=t.isFullScreen;return Object(N.a)({width:"100%",height:"100%",borderRadius:a?0:e.spacing(1)},n?{"p-webkit-transform":"scaleX(- 1)",transform:"scaleX(-1)"}:{})},canvas:function(t){var n=t.isFullScreen;return{borderRadius:n?0:e.spacing(1),position:"absolute",top:0,left:0,width:"100%",paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},children:function(t){var n=t.isFullScreen;return{borderRadius:n?0:e.spacing(1),overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",bottom:5,zIndex:1,paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},fullScreen:{position:"absolute",bottom:e.spacing(1.5),right:function(t){var n=t.isFullScreen;return e.spacing(n?1.5:3)},zIndex:20,"&:hover":{background:"rgba(255,255,255,0.25)"}},overlay:function(t){return{background:t.overlayColor,position:"absolute",top:0,bottom:5,left:e.spacing(2),right:e.spacing(2),borderRadius:e.spacing(1),zIndex:0}},fsOverlay:{left:0,right:0,borderRadius:0},loader:{position:"absolute",top:0,left:0,bottom:0,right:0,width:"100%",display:"flex",alignItems:"center",justifyContent:"center","& > div":{width:100,height:100}}}})),X=function(e){var t,n,a,c,o,i,l,u,s=e.overlay,d=Object(P.a)(e,["overlay"]),m=R(),p="string"!==typeof s?"rgba(255,255,255,0.5)":s,f=q(Object(N.a)(Object(N.a)(Object(N.a)({},d),m),{},{overlayColor:p})),b=Object(B.c)({to:{opacity:m.hidden?0:1},config:B.b.stiff});return r.a.createElement("div",{ref:m.rootRef,className:f.root},r.a.createElement(B.a.div,{style:b,className:f.container},r.a.createElement("video",{autoPlay:!0,ref:m.videoRef,className:f.video,width:null===(t=m.videoRef)||void 0===t||null===(n=t.current)||void 0===n?void 0:n.videoWidth,height:null===(a=m.videoRef)||void 0===a||null===(c=a.current)||void 0===c?void 0:c.videoHeight}),r.a.createElement("canvas",{ref:m.canvasRef,className:f.canvas,width:null===(o=m.videoRef)||void 0===o||null===(i=o.current)||void 0===i?void 0:i.videoWidth,height:null===(l=m.videoRef)||void 0===l||null===(u=l.current)||void 0===u?void 0:u.videoHeight}),!m.hidden&&s&&r.a.createElement("div",{className:_()(f.overlay,Object(D.a)({},f.fsOverlay,m.isFullScreen))}),d.children&&!m.hidden&&r.a.createElement("div",{className:f.children},d.children),m.hasFullScreen&&r.a.createElement(U.a,{color:"secondary",className:f.fullScreen,onClick:m.toggleFullScreen},m.isFullScreen?r.a.createElement(W.a,{color:"secondary"}):r.a.createElement(V.a,{color:"secondary"}))),m.hidden&&r.a.createElement("div",{className:f.loader},r.a.createElement("div",null,r.a.createElement(G,{color:"#000"}))))},H=n(269),K=n.n(H),$=n(270),Z=n.n($),J=n(272),Q=n.n(J),ee=n(271),te=n.n(ee),ne=n(589),ae=n(582),re=n(592),ce=n(593),oe=n(590),ie=n(585),le=n(266),ue=n.n(le),se=n(267),de=n.n(se),me=function(){},pe=Object(x.a)((function(e){return{root:function(e){return{position:"relative"}},arrowIcon:function(t){return{marginLeft:e.spacing(1)}},tooltip:function(e){return{position:"relative",margin:0}},arrow:function(e){return{position:"absolute",fontSize:6,"&::before":{content:'""',margin:"auto",display:"block",width:0,height:0,borderStyle:"solid"}}},paper:{border:"1px solid #d3d4d5"},popper:function(t){return{'&[x-placement*="bottom"] $arrow':{top:0,left:0,marginTop:"-0.95em",width:"2em",height:"1em","&::before":{borderWidth:"0 1em 1em 1em",borderColor:"transparent transparent ".concat(e.palette.grey[700]," transparent")}},'&[x-placement*="top"] $arrow':{bottom:0,left:0,marginBottom:"-0.95em",width:"2em",height:"1em","&::before":{borderWidth:"1em 1em 0 1em",borderColor:"".concat(e.palette.grey[700]," transparent transparent transparent")}},'&[x-placement*="right"] $arrow':{left:0,marginLeft:"-0.95em",height:"2em",width:"1em","&::before":{borderWidth:"1em 1em 1em 0",borderColor:"transparent ".concat(e.palette.grey[700]," transparent transparent")}},'&[x-placement*="left"] $arrow':{right:0,marginRight:"-0.95em",height:"2em",width:"1em","&::before":{borderWidth:"1em 0 1em 1em",borderColor:"transparent transparent transparent ".concat(e.palette.grey[700])}}}}}})),fe=function(e){var t,n=pe(e),c=Object(a.useMemo)(Math.random,[]),o=Object(a.useRef)(),i=Object(a.useState)(null),l=Object(h.a)(i,2),u=l[0],s=l[1],d=Object(a.useState)(null),m=Object(h.a)(d,2),p=m[0],f=m[1];Object(a.useEffect)((function(){return o.current=!0,function(){o.current=!1}}),[]);var b=Object(a.useCallback)((function(e){o.current&&s(e.currentTarget)}),[]),v=Object(a.useCallback)((function(){o.current&&s(null)}),[]),g=Object(a.useCallback)(Object(M.a)(L.a.mark((function t(){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e.onClose||me)();case 2:!0!==t.sent&&v();case 4:case"end":return t.stop()}}),t)}))),[v,e.onClose]),O=Object(a.useCallback)((function(t){(e.onClickCheckbox||me)(t.target.value,g)}),[e.onClickCheckbox,g]),j=Object(a.useCallback)((function(t){return function(){var n=Object(M.a)(L.a.mark((function n(a){return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("checkbox"!==a.target.type){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,(e.onSelect||me)(t);case 4:!0!==n.sent&&g();case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}),[g,e.onSelect]),k=!!u;return r.a.createElement("div",{className:n.root},r.a.createElement(ae.a,Object.assign({disableRipple:!0,variant:"outlined","aria-haspopup":"true",className:n.button,onClick:b,"aria-controls":"select-and-check-".concat(c)},e.SelectProps),k&&e.activeTitle||e.title,k?r.a.createElement(ue.a,{className:n.arrowIcon}):r.a.createElement(de.a,{className:n.arrowIcon})),r.a.createElement(ne.a,Object.assign({keepMounted:!0,open:k,elevation:0,anchorEl:u,getContentAnchorEl:null,onClose:g,id:"select-and-check-".concat(c),classes:{paper:n.paper},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e.MenuProps),null===(t=e.options)||void 0===t?void 0:t.map((function(t,a){var c=t.key,o=t.value,i=t.text,l=t.selected,u=t.tooltipTitle,s=t.checked,d=t.checkboxValue,m=null;if("boolean"===typeof s){var b=r.a.createElement(oe.a,{checked:s,onClick:O,value:void 0===d?o:d}),v=u||e.tooltipTitle;m=v?r.a.createElement(re.a,{classes:{tooltip:n.tooltip,popper:n.popper},PopperProps:{popperOptions:{modifiers:{arrow:{enabled:!!p,element:p}}}},title:r.a.createElement(r.a.Fragment,null,v,r.a.createElement("span",{className:n.arrow,ref:f})),enterDelay:void 0===e.tooltipEnterDelay?750:e.tooltipEnterDelay,leaveDelay:e.tooltipLeaveDelay||0,"aria-label":"checkbox",placement:e.tooltipPlacement||"top"},b):b}return r.a.createElement(ce.a,Object.assign({key:c||a,onClick:j(o),selected:l},e.MenuItemProps),m,r.a.createElement(ie.a,{primary:i||(null===o||void 0===o?void 0:o.toString())}))}))))},be=Object(x.a)((function(e){return{root:function(e){return{}}}})),ve=function(e){var t,n=R(),c=be(Object(N.a)(Object(N.a)({},e),n)),o=Object(a.useMemo)((function(){var e={deviceId:null,label:null,none:!0};return n.currentDeviceId?(n.cameras.some((function(t){return t.deviceId===n.currentDeviceId&&(e=t,!0)})),e):e}),[n.cameras,n.currentDeviceId]),i=Object(a.useCallback)((function(e){n.currentDeviceId!==e&&n.startVideo({deviceId:e})}),[n]),l=Object(a.useCallback)((function(e){n.autoStartDeviceId===e?n.clearAutoStartDeviceId():(n.setAutoStartDeviceId(e),i(e))}),[n,i]);return r.a.createElement("div",{className:c.root},r.a.createElement(fe,{activeTitle:"Select Camera",title:(null===(t=n.cameras)||void 0===t?void 0:t.length)?o.label||"No Camera Selected":"No Cameras Detected",onSelect:i,onClickCheckbox:l,options:n.cameras.map((function(e){return{key:e.label,value:e.deviceId,text:e.label||"Unknown Device",selected:e.deviceId===n.currentDeviceId,checked:n.autoStartDeviceId===e.deviceId,tooltipTitle:n.autoStartDeviceId===e.deviceId?"Remove Default":"Set Default"}}))}))},ge=window.speechSynthesis,he=function(){var e=Object(a.useRef)(!0),t=Object(a.useState)(!0),n=Object(h.a)(t,2),r=n[0],c=n[1],o=function(e){if(!e)throw new Error("audioRef is required when calling useSpeech");var t=Object(a.useState)(null),n=Object(h.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(null),i=Object(h.a)(o,2),l=i[0],u=i[1];Object(a.useEffect)((function(){if(!r){var e=ge.getVoices();c(e),u(e[0])}}),[r]);var s=Object(a.useCallback)((function(t){if(e.current){var n=new SpeechSynthesisUtterance(t);n.voice=l,ge.speak(n)}}),[l,e]),d=Object(a.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.onEnd,a=t.onEach;n&&setTimeout(n,1e3*e),Array.from({length:e}).forEach((function(t,n){var r=e-n;setTimeout((function(){s(r),a&&a(r)}),1e3*n)}))}),[s]);return{say:s,countdown:d}}(e);Object(a.useEffect)((function(){localStorage.getItem("__audio_muted__")&&c(!1)}),[]),Object(a.useEffect)((function(){r&&!e.current?(e.current=!0,localStorage.removeItem("__audio_muted__")):!r&&e.current&&(e.current=!1,localStorage.setItem("__audio_muted__","true"))}),[r]);var i=Object(a.useCallback)((function(){c((function(e){return!e}))}),[]);return Object(a.useMemo)((function(){return{state:r,stateRef:e,handlers:{toggle:i,speech:o}}}),[r,i,o])},Oe=Object(a.createContext)(),je=function(){var e=Object(a.useContext)(Oe);if(void 0===e)throw new Error("useAudio must be used within a AudioProvider");return e},ke=function(e){var t=e.children,n=he();return r.a.createElement(Oe.Provider,{value:n},t)},Ee="set_screen",ye="set_player_mode",Ce="set_game_mode",we="reverse_state",xe="reset_state",Se={screen:{DEFAULT:"start",PLAY:"play"},players:{SINGLE_PLAYER:"Single Player",MULTIPLAYER:"Multi Player",DEFAULT:null},mode:(u={},Object(D.a)(u,"Single Player",{PRACTICE:"Practice",SURVIVAL:"Survival",TIME_ATTACK:"Time Attack"}),Object(D.a)(u,"Multi Player",{LOCAL:"Local Multiplayer",REMOTE:"Remote Multiplayer"}),Object(D.a)(u,"DEFAULT",null),u)},Le=[Se.players.MULTIPLAYER,Se.mode["Single Player"].SURVIVAL,Se.mode["Single Player"].TIME_ATTACK,Se.mode["Multi Player"].LOCAL,Se.mode["Multi Player"].REMOTE].reduce((function(e,t){return Object(N.a)(Object(N.a)({},e),{},Object(D.a)({},t,!0))}),{}),Me=Object.entries(Se).reduce((function(e,t){var n=Object(h.a)(t,2),a=n[0],r=n[1];return Object(N.a)(Object(N.a)({},e),{},Object(D.a)({},a,"mode"!==a?Object.values(r).filter((function(e){return e})):Object.entries(r).reduce((function(e,t){var n=Object(h.a)(t,2),a=n[0],r=n[1];return Object(N.a)(Object(N.a)({},e),{},Object(D.a)({},a,null===r?null:Object.values(r)))}),{})))}),{}),Ie={screen:Se.screen.DEFAULT,mode:Se.mode.DEFAULT,players:Se.players.DEFAULT},Re=Object(x.a)((function(e){return{btn:{border:"2px solid grey"},back:{marginLeft:e.spacing(2)},options:{marginTop:e.spacing(2),paddingLeft:e.spacing(2),paddingRight:e.spacing(2),width:"100%",maxWidth:1100,display:"flex",margin:"0 auto",alignItems:"center",justifyContent:"space-between"},right:{display:"flex",alignItems:"center",justifyContent:"space-between"},volume:{marginLeft:e.spacing(1)}}})),Te=Object(a.memo)((function(e){var t=Re(),n=je(),a=e.screen===Se.screen.DEFAULT,c=Object(B.c)({to:{opacity:a?0:1},config:B.b.stiff});return r.a.createElement("div",{className:t.options},r.a.createElement("div",null,!a&&r.a.createElement(B.a.div,{style:c},r.a.createElement(U.a,{className:t.btn,size:"small",onClick:e.goHome},r.a.createElement(K.a,null)),r.a.createElement(U.a,{size:"small",onClick:e.goBack,className:_()(t.btn,t.back)},r.a.createElement(Z.a,null)))),r.a.createElement("div",{className:t.right},r.a.createElement(ve,null),r.a.createElement(U.a,{className:t.volume,size:"small",onClick:n.handlers.toggle},n.state?r.a.createElement(te.a,null):r.a.createElement(Q.a,null))))})),Ae=function(){return null},De=n(116),Pe=Object(x.a)((function(e){return{root:{textAlign:"center"},heading:{marginTop:e.spacing(2),marginBottom:e.spacing(2)}}})),Ne=function(e){var t=Pe();return r.a.createElement("header",{className:t.root},r.a.createElement(De.a,{component:"h1",variant:"h5",className:t.heading},e.game.screen.state.screen))},Fe=Object(x.a)((function(e){return{root:{}}})),_e=(d={},Object(D.a)(d,Se.screen.DEFAULT,Object(D.a)({},Se.players.DEFAULT,Ae)),Object(D.a)(d,Se.screen.PLAY,(s={},Object(D.a)(s,Se.players.SINGLE_PLAYER,Ae),Object(D.a)(s,Se.players.MULTIPLAYER,Ae),s)),d),Ue=function(e){var t,n=Fe(),a=e.screenState,c=a.screen,o=a.players,i=(null===(t=_e[c])||void 0===t?void 0:t[o])||Ne;return r.a.createElement("header",{className:n.root},r.a.createElement(i,null))},Be=n(586),ze=n(273),Ve=n.n(ze),Ye=function(e){var t=(e-25)/63;return Math.max(1,Math.min(10,Math.round(10*t)))},We=function(e){return e/10*100},Ge=function(e,t){var n,a;e<50?(n=255,a=Math.round(5.1*e)):(a=255,n=Math.round(510-5.1*e));var r="#"+("000000"+(65536*n+256*a+0).toString(16)).slice(-6);if(t){var c=Ve()(r),o=c.red,i=c.green,l=c.blue;return"rgba(".concat(o,", ").concat(i,", ").concat(l,", ").concat(t,")")}return r},qe=function(e,t){return Ge(We(Ye(e)),t)},Xe=n(584),He=n(114),Ke=n.n(He),$e=Object(Be.a)((function(e){return{masks:{padding:e.spacing(2),background:"rgba(255,255,255,0.5)"},masksHeader:{display:"flex",alignItems:"center",justifyContent:"space-between"},masksList:{display:"flex",flexFlow:"row wrap",justifyContent:"space-around"},maskContainer:{marginTop:e.spacing(2)},imgContainer:{width:200,position:"relative",border:"1px solid grey",padding:e.spacing(.5),borderRadius:e.spacing(1),"&:hover":{"& > div":{background:"rgba(255,0,0,0.65)"}}},img:{width:"100%",background:"rgba(0,0,0,0)"},removeMask:{top:0,left:0,bottom:0,width:"100%",display:"flex",alignItems:"center",position:"absolute",transition:"all 100ms",justifyContent:"center","&:hover":{"& > button":{display:"inherit"}}},iconBtn:{display:"none",color:"black",backgroundColor:"rgba(255,255,255,0.5)","&:hover":{backgroundColor:"rgba(255,255,255,0.75)"},"&:active, &:focused":{backgroundColor:"rgba(255,255,255,0.9)"}},actions:{"& > button":{marginRight:e.spacing(1),"& :last-of-type":{marginRight:0}}}}})),Ze=function(e){var t=$e(),n=e.masks,a=e.onClose,c=e.title,o=e.actions,i=e.actionButtons,l=e.getDataUri,u=e.getImageChild,s=e.getPaperProps,d=e.PaperProps,m=void 0===d?{}:d;return!!(null===n||void 0===n?void 0:n.length)&&r.a.createElement(Xe.a,{className:t.masks,elevation:4},r.a.createElement("div",{className:t.masksHeader},"string"===typeof c?r.a.createElement(De.a,{variant:"h6",component:"h3"},c):c||null,o||i?r.a.createElement("div",{className:t.actions},i.map((function(e){var t=e.Icon,n=e.onClick,a=e.key;return r.a.createElement(U.a,{key:a,size:"small",onClick:n},r.a.createElement(t,null))}))):a&&r.a.createElement("div",{className:t.actions},r.a.createElement(U.a,{size:"small",onClick:a},r.a.createElement(Ke.a,null)))),r.a.createElement("ul",{className:t.masksList},n.map((function(e,n){var a=l?l(e):e,c=s?s(e,n):{};return r.a.createElement("li",{key:a,className:t.maskContainer},r.a.createElement(Xe.a,Object.assign({elevation:4,className:t.imgContainer},m,c),u&&u(e),r.a.createElement("img",{src:a,className:t.img,alt:"mask #".concat(n)})))}))))},Je=Object(Be.a)((function(e){return{score:{textAlign:"right",paddingRight:e.spacing(1)}}})),Qe=function(e){var t=Je(),n=e.results,c=e.handleClose,o=Object(a.useMemo)((function(){var e=n.reduce((function(e,t){var n=t.score;return e+Ye(n)}),0)/n.length,t=We(e),a=Ge(t),c=e.toFixed(1);return r.a.createElement(De.a,{variant:"h6",component:"h3"},"Round Score: ",r.a.createElement("span",{style:{color:a}},c))}),[n]),i=Object(a.useCallback)((function(e){return e.dataUri}),[]),l=Object(a.useCallback)((function(e){var t=e.score;return{style:{background:qe(t,.4)}}}),[]),u=Object(a.useCallback)((function(e){var n=e.score;return r.a.createElement(De.a,{className:t.score},Ye(n))}),[t.score]);return r.a.createElement(Ze,{title:o,masks:n,onClose:c,getDataUri:i,getPaperProps:l,getImageChild:u})},et=n(274),tt=n.n(et),nt=n(275),at=n.n(nt),rt=n(276),ct=n.n(rt),ot=Object(Be.a)((function(e){return{removeMask:{top:0,left:0,bottom:0,width:"100%",display:"flex",alignItems:"center",position:"absolute",transition:"all 100ms",justifyContent:"center","&:hover":{"& > button":{display:"inherit"}}},iconBtn:{display:"none",color:"black",backgroundColor:"rgba(255,255,255,0.5)","&:hover":{backgroundColor:"rgba(255,255,255,0.75)"},"&:active, &:focused":{backgroundColor:"rgba(255,255,255,0.9)"}}}})),it=function(e){var t=ot(),n=e.captureMasks,c=e.handlePlay,o=Object(a.useMemo)((function(){return[{key:"play",Icon:tt.a,onClick:c},{key:"download",Icon:at.a,onClick:n.downloadMasks},{key:"clear",Icon:Ke.a,onClick:n.removeAllMasks}]}),[n.downloadMasks,n.removeAllMasks,c]),i=Object(a.useCallback)((function(e){return e.binary}),[]),l=Object(a.useCallback)((function(e,a){return r.a.createElement("div",{className:t.removeMask},r.a.createElement(U.a,{name:a,className:t.iconBtn,onClick:n.removeMask},r.a.createElement(ct.a,{fontSize:"large"})))}),[n.removeMask,t.removeMask,t.iconBtn]);return r.a.createElement(Ze,{title:"Candidate Masks",getDataUri:i,masks:n.masks,actionButtons:o,getImageChild:l})},lt=Object(Be.a)((function(e){return{root:{"& > div":{marginTop:e.spacing(2)}}}})),ut=function(e){var t=lt(),n=Zt();if(!n.mode)return null;var a=n.mode,c=a.captureMasks,o=a.simpleGame,i=a.handlePlayCapturedMasks;return r.a.createElement("div",{className:t.root},r.a.createElement(Qe,{results:o.scores,handleClose:o.clearScores}),r.a.createElement(it,{captureMasks:c,handlePlay:i}))},st=Object(x.a)((function(e){return{root:{maxWidth:1100,margin:"0 auto",paddingLeft:e.spacing(2),paddingRight:e.spacing(2)}}})),dt=Object(D.a)({},Se.screen.PLAY,(f={},Object(D.a)(f,Se.players.SINGLE_PLAYER,(m={},Object(D.a)(m,Se.mode[Se.players.SINGLE_PLAYER].PRACTICE,ut),Object(D.a)(m,Se.mode[Se.players.SINGLE_PLAYER].SURVIVAL,(function(){return"SURVIVAL footer"})),Object(D.a)(m,Se.mode[Se.players.SINGLE_PLAYER].TIME_ATTACK,(function(){return"TIME_ATTACK footer"})),m)),Object(D.a)(f,Se.players.MULTIPLAYER,(p={},Object(D.a)(p,Se.mode[Se.players.MULTIPLAYER].LOCAL,(function(){return"LOCAL footer"})),Object(D.a)(p,Se.mode[Se.players.MULTIPLAYER].REMOTE,(function(){return"REMOTE footer"})),p)),f)),mt=function(e){var t,n,a=st(),c=e.screen.state,o=c.screen,i=c.players,l=c.mode,u=(null===(t=dt[o])||void 0===t||null===(n=t[i])||void 0===n?void 0:n[l])||Ae;return r.a.createElement("div",{className:a.root},r.a.createElement(u,null))},pt=Object(Be.a)((function(e){return{root:{display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"space-between",marginBottom:e.spacing(1),"& > div > *":{marginTop:e.spacing(2),minWidth:150}}}})),ft=function(e){var t=pt(),n=Object(B.d)(e.buttons.length,{transform:"translate3d(0,0px,0)",from:{transform:"translate3d(0,-".concat(e.offset||100,"px,0)")},config:B.b.stiff});return r.a.createElement("div",{className:t.root},n.map((function(t,n){var a=e.buttons[n],c=a.Component,o=a.visible,i=void 0===o||o,l=a.props,u=void 0===l?{}:l;return i?r.a.createElement(B.a.div,{key:u.key,style:t},c?r.a.createElement(c,u):r.a.createElement(ae.a,Object.assign({color:"primary",variant:"contained"},u))):null})))},bt=Object(x.a)((function(e){return{root:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column","& button":{minWidth:150,marginTop:e.spacing(2)}},gameMode:{textAlign:"center"},header:{marginTop:e.spacing(4),marginBottom:e.spacing(2)}}})),vt=function(e){var t=bt(),n=Object(a.useCallback)((function(t){var n=t.currentTarget.name;e.screen.handlers.setGameMode(n)}),[e.screen.handlers]),c=Object(a.useMemo)((function(){var t;return null===(t=Me.mode[e.screen.state.players])||void 0===t?void 0:t.map((function(e){return{props:{key:e,name:e,children:e,onClick:n,disabled:!!Le[e]}}}))}),[e.screen.state.players,n]);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.gameMode},r.a.createElement(ft,{buttons:c})))},gt=Object(x.a)((function(e){return{fileInput:{display:"none"}}})),ht=function(e){var t=e.onChange,n=e.multiple,c=e.children,o=e.filter,i=Object(P.a)(e,["onChange","multiple","children","filter"]),l=gt(),u=Object(a.useRef)(),s=Object(a.useCallback)((function(e){if(e){var a=!1===n,r=e.target?Array.from(e.target.files):e.files,c=o?r.filter(o):r;a&&c.length>1&&(c=c.slice(0,1)),t(c)}}),[t,n,o]),d=Object(a.useCallback)((function(){u.current.value=null}),[u]);return r.a.createElement(ae.a,Object.assign({component:"label"},i),c,r.a.createElement("input",{type:"file",ref:u,className:l.fileInput,onClick:d,onChange:s,multiple:!1!==n}))},Ot=Object(Be.a)((function(e){return{item:function(t){return{minWidth:t-e.spacing(4),textAlign:"center"}}}})),jt=function(e){var t=Object(a.useState)(0),n=Object(h.a)(t,2),c=n[0],o=n[1],i=Ot(c),l=Object(a.useRef)();Object(a.useEffect)((function(){l.current&&o(l.current.clientWidth)}),[]);var u=r.a.useState(null),s=Object(h.a)(u,2),d=s[0],m=s[1],p=Object(a.useCallback)((function(e){m(e.currentTarget)}),[]),f=Object(a.useCallback)((function(){m(null)}),[]),b=Object(a.useCallback)((function(t){return function(){e.handleClick(t),f()}}),[e,f]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{ref:l},r.a.createElement(ae.a,{fullWidth:!0,variant:"contained","aria-haspopup":"true",onClick:p,"aria-controls":"mask-menu",disabled:e.disabled},"Select Masks")),r.a.createElement(ne.a,{id:"mask-menu",keepMounted:!0,anchorEl:d,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},onClose:f,open:Boolean(d),container:e.containerRef.current||null},Array.from({length:3}).map((function(e,t){return r.a.createElement(ce.a,{key:t,button:!0,onClick:b("set".concat(t+1,".zip"))},r.a.createElement("span",{className:i.item},"Game ",t+1))}))))},kt=Object(x.a)((function(e){return{root:function(e){var t=e.flip,n=e.height,a=void 0===n?10:n,r=e.background;return{height:a,background:void 0===r?"rgba(255,255,255,0)":r,width:"100%",borderRadius:50,transform:"scaleX(".concat(t?-1:1,")"),pWebkitTransform:"scaleX(".concat(t?-1:1,")")}},filler:function(e){var t=e.completed;return{height:"100%",textAlign:"left",background:e.color,width:"".concat(t,"%"),borderRadius:"inherit"}}}})),Et=function(e){var t=kt(e);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.filler}))},yt=n(43),Ct=n(96),wt=n.n(Ct),xt=n(277),St=n.n(xt),Lt=(n(278),function(e,t){for(var n=e.data,a=e.width,r=e.height,c=new Uint8ClampedArray(4*e.data.length),o=0;o<r*a;++o){var i=o%a,l=parseInt(o/a),u=n[o],s=t?a-i+a*l:o;c[4*s]=u?255:0,c[4*s+1]=u?255:0,c[4*s+2]=u?255:0,c[4*s+3]=u?255:0}var d=new ImageData(c,a,r),m=cv.matFromImageData(d),p=new cv.MatVector;cv.split(m,p);var f=new cv.Mat;cv.threshold(p.get(0),f,128,1,cv.THRESH_BINARY);var b=new cv.MatVector,v=new cv.Mat;cv.findContours(f,b,v,cv.RETR_CCOMP,cv.CHAIN_APPROX_SIMPLE);for(var g=cv.Mat.zeros(f.rows,f.cols,cv.CV_8UC1),h=0;h<b.size();++h)cv.contourArea(b.get(h))>1e4&&cv.drawContours(g,b,h,[1,1,1,1],-1,cv.LINE_8,v,100);return m.delete(),p.delete(),g}),Mt=function(e,t){var n=Lt(e,t),a=new cv.MatVector,r=cv.Mat.zeros(n.rows,n.cols,cv.CV_8UC4);cv.split(r,a),a.get(2).setTo([255,0,0,0],n),a.get(3).setTo([128,0,0,0],n);var c=new cv.Mat,o=cv.Mat.ones(10,10,cv.CV_8U),i=new cv.Point(-1,-1);cv.dilate(n,c,o,i,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),cv.subtract(c,n,c),a.get(2).setTo([255,0,0,0],c),a.get(1).setTo([255,0,0,0],c),a.get(3).setTo([255,0,0,0],c),cv.merge(a,r);var l=new ImageData(new Uint8ClampedArray(r.data),r.cols,r.rows);return a.delete(),n.delete(),r.delete(),o.delete(),c.delete(),{overlayImageData:l,binaryImageData:l}},It=function(e,t,n){var a=Lt(t,n),r=new cv.MatVector,c=cv.Mat.zeros(a.rows,a.cols,cv.CV_8UC4);cv.split(c,r),r.get(1).setTo([255,0,0,0],a),r.get(3).setTo([128,0,0,0],a);var o=new cv.Mat,i=cv.Mat.ones(10,10,cv.CV_8U),l=new cv.Point(-1,-1);cv.dilate(a,o,i,l,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),cv.subtract(o,a,o),r.get(1).setTo([255,0,0,0],o),r.get(3).setTo([255,0,0,0],o),cv.merge(r,c);var u=new ImageData(new Uint8ClampedArray(c.data),c.cols,c.rows),s=cv.matFromImageData(e),d=new cv.MatVector;cv.split(s,d);var m=new cv.Mat;cv.addWeighted(c,.5,s,.5,0,m);for(var p=new ImageData(new Uint8ClampedArray(m.data),m.cols,m.rows),f=t.data,b=t.width,v=t.height,g=new Uint8ClampedArray(4*t.data.length),h=0,O=0,j=0;j<v*b;++j){var k=j%b,E=parseInt(j/b),y=n?b-k+b*E:j,C=f[j],w=!!e.data[4*y+2],x=w&&C,S=w&&!C,L=!w&&C,M=L||x||S;x&&O++,(C||w)&&h++,g[4*y]=L?255:0,g[4*y+1]=x?255:0,g[4*y+2]=S?255:0,g[4*y+3]=M?128:0}var I=Math.round(O/(h+1e-7)*100);return r.delete(),a.delete(),c.delete(),i.delete(),o.delete(),m.delete(),{score:I,targetOverlay:p,segOverlay:u}},Rt=function(e){return"set".concat(e,".zip")},Tt=function(){var e=Object(a.useRef)(),t=R(),n=function(){var e=Object(a.useRef)([]),t=Object(a.useRef)(null),n=Object(a.useRef)(0),r=Object(a.useState)([]),c=Object(h.a)(r,2),o=c[0],i=c[1],l=Object(a.useCallback)((function(t){i(t),e.current="function"===typeof t?t(e.current):t}),[]),u=Object(a.useCallback)((function(){n.current=0,t.current=null}),[]),s=Object(a.useCallback)((function(){var a=e.current[n.current];return a?(t.current=a,n.current++,a):(t.current=null,n.current=0,null)}),[]),d=Object(a.useCallback)((function(){return e.current.length}),[]);return Object(a.useMemo)((function(){return{next:s,reset:u,maskRef:t,setMasks:l,getNumMasks:d,hasMasks:!!o.length}}),[s,o,u,l,d])}(),r=Object(a.useState)([]),c=Object(h.a)(r,2),o=c[0],i=c[1],l=function(e){var t=R(),n=Object(a.useState)(!1),r=Object(h.a)(n,2),c=r[0],o=r[1],i=Object(a.useCallback)(function(){var n=Object(M.a)(L.a.mark((function n(a){var r,c,i;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,wt.a.loadAsync(a);case 2:return r=n.sent,n.next=5,Promise.all(r.filter((function(e){return e.endsWith(".png")})).map((function(e){var t=e.name;return r.file(t).async("base64")})));case 5:return c=n.sent,n.prev=6,n.next=9,Promise.all(c.map((function(e){return t.dataUriToImageData("data:image/png;base64,".concat(e))})));case 9:i=n.sent,e(i),n.next=15;break;case 13:n.prev=13,n.t0=n.catch(6);case 15:o(!1);case 16:case"end":return n.stop()}}),n,null,[[6,13]])})));return function(e){return n.apply(this,arguments)}}(),[e,t]),l=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(t){var n,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(h.a)(t,1),"application/zip"===(a=n[0]).type){e.next=4;break}return console.error("Expected a zip file but got",a.type),e.abrupt("return");case 4:return o(!0),e.next=7,i(a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i]),u=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(t){var n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return o(!0),e.next=5,new wt.a.external.Promise((function(e,n){St.a.getBinaryContent("/rob_and_adam_code_a_thing"+"/masks/".concat(t),(function(t,a){t?n(t):e(a)}))}));case 5:return n=e.sent,e.next=8,i(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i]),s=Object(a.useCallback)(Object(M.a)(L.a.mark((function e(){var t;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Math.floor(3*Math.random()),e.abrupt("return",u(Rt(t+1)));case 2:case"end":return e.stop()}}),e)}))),[u]);return Object(a.useMemo)((function(){return{loading:c,handleZipInputChange:l,handleLoadRandomMaskSet:s,handleLoadPreparedMasks:u}}),[c,l,u,s])}(n.setMasks),u=Object(a.useState)(0),s=Object(h.a)(u,2),d=s[0],m=s[1],p=Object(a.useCallback)((function(){i([])}),[]),f=Object(a.useCallback)(function(){var a=Object(M.a)(L.a.mark((function a(r){var c;return L.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return 3e3,r.time.first?(n.next(),m(0),p(),r.useTimer({maxLaps:n.getNumMasks(),printSeconds:!0,announceSeconds:!0,lapDuration:3e3,newLapDelay:1e3,onLap:function(a){var r=a.predict,c=(a.time,a.stop),o=n.maskRef.current;if(!o)return c();e.current=r(t.videoRef.current).then(function(){var e=Object(M.a)(L.a.mark((function e(a){var r,c,l,u;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=It(o,a,t.flipX),c=r.score,l=r.targetOverlay,u=t.imageDataToDataUri(l),i((function(e){return[].concat(Object(yt.a)(e),[{score:c,dataUri:u}])})),t.clearCanvas(),n.next();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}})):(c=Math.min(r.time.lapTime/3e3,1),m(Math.round(100*c))),n.maskRef.current&&t.ctx.putImageData(n.maskRef.current,0,0),a.abrupt("return",(function(){e.current?e.current.then(r.webcam.clearCanvas):r.webcam.clearCanvas()}));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),[t,n,p]);return Object(a.useMemo)((function(){return{zip:l,scores:o,handleLoop:f,clearScores:p,progressPercent:d,reset:n.reset,ready:n.hasMasks,setMasks:n.setMasks}}),[l,o,d,f,p,n])},At=n(279),Dt=n.n(At),Pt=function(){var e=Object(a.useRef)(),t=Object(a.useState)([]),n=Object(h.a)(t,2),r=n[0],c=n[1],o=Object(a.useCallback)((function(e){var t=e.currentTarget.name;c((function(e){return e.filter((function(e,n){return n!==+t}))}))}),[]),i=Object(a.useCallback)((function(){c([])}),[]),l=Object(a.useCallback)((function(){var e=new wt.a,t=e.folder("masks");r.forEach((function(e,n){var a=e.overlay;t.file("mask-".concat(n,".png"),Dt.a.decode(a).dataBase64,{base64:!0})})),e.generateAsync({type:"blob"}).then((function(e){return function(e,t){if("undefined"!==typeof navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,t);if("undefined"!==typeof navigator.msSaveBlob)return navigator.msSaveBlob(e,t);var n=window.document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t,n.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(n),"function"===typeof n.click?n.click():(n.target="_blank",n.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),URL.revokeObjectURL(n.href)}(e,"masks.zip")}))}),[r]),u=Object(a.useCallback)(function(){var t=Object(M.a)(L.a.mark((function t(n){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.time.first&&n.useTimer({printSeconds:!0,announceSeconds:!0,lapDuration:3e3,newLapDelay:1e3,onBeforeStartLap:function(){var e=Object(M.a)(L.a.mark((function e(t){var n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.predict,t.webcam,t.time,t.stop,e.abrupt("return",n());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onLap:function(t){var n=t.predict,a=t.webcam;t.time,t.stop;e.current=n(a.videoRef.current).then(function(){var e=Object(M.a)(L.a.mark((function e(t){var n,r,o,i,l;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Mt(t,a.flipX),r=n.overlayImageData,o=n.binaryImageData,i=a.imageDataToDataUri(r),l=a.imageDataToDataUri(o),a.clearCanvas(),a.ctx.putImageData(r,0,0),c((function(e){return[].concat(Object(yt.a)(e),[{overlay:i,binary:l}])}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}),t.abrupt("return",(function(){e.current?e.current.then(n.webcam.clearCanvas):n.webcam.clearCanvas()}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]);return Object(a.useMemo)((function(){return{masks:r,handleLoop:u,removeMask:o,downloadMasks:l,removeAllMasks:i}}),[r,u,o,l,i])},Nt=Object(Be.a)((function(e){return{root:{padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",overflow:"scroll"},overlay:{background:"rgba(255,255,255,0.5)"},rootTop:{justifyContent:"flex-start"},rootApart:{justifyContent:"space-between"},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},captures:{width:"100%","& > div":{marginTop:e.spacing(1)}},progress:{position:"absolute",top:e.spacing(1),left:e.spacing(8),right:e.spacing(8)}}})),Ft=function(e){var t,n,c,o=Nt(),i=Zt(),l=R(),u=Object(a.useRef)(),s=function(e){var t=e.loop,n=R(),r=Tt(),c=Pt(),o=Object(a.useState)(null),i=Object(h.a)(o,2),l=i[0],u=i[1];Object(a.useEffect)((function(){!t.looping&&l&&u(null)}),[t.looping,l]);var s=Object(a.useCallback)(Object(M.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.looping?(t.stop(),r.reset()):(t.start(r.handleLoop),u("play"));case 1:case"end":return e.stop()}}),e)}))),[t,r]),d=Object(a.useCallback)(Object(M.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.looping){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,r.zip.handleLoadRandomMaskSet();case 4:s();case 5:case"end":return e.stop()}}),e)}))),[s,t.looping,r.zip]),m=Object(a.useCallback)((function(){t.looping?(t.stop(),r.reset()):(t.start(c.handleLoop),u("capture"))}),[t,c,r]),p=Object(a.useCallback)(Object(M.a)(L.a.mark((function e(){var a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.looping){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all(c.masks.map((function(e){var t=e.overlay;return n.dataUriToImageData(t)})));case 4:a=e.sent,r.setMasks(a),s();case 7:case"end":return e.stop()}}),e)}))),[c.masks,r,n,s,t.looping]),f=Object(a.useMemo)((function(){return{loopType:l,simpleGame:r,captureMasks:c,handleClickGame:s,handleStartRandomGame:d,handlePlayCapturedMasks:p,handleClickCaptureMasks:m}}),[l,r,c,s,d,p,m]);return Object(a.useEffect)((function(){e.setMode(f)}),[e,f]),f}(i),d=s.loopType,m=s.simpleGame,p=s.captureMasks,f=s.handleClickGame,b=s.handleStartRandomGame,v=s.handlePlayCapturedMasks,g=s.handleClickCaptureMasks,O=i.loop,j=Ge(100-m.progressPercent),k=Object(a.useMemo)((function(){return[{props:{key:"play/stop",onClick:f,disabled:!O.ready||!O.looping&&!m.ready,children:O.looping?"Stop":"Play"}},{props:{key:"playRandom",color:"secondary",onClick:b,disabled:!O.ready||O.looping,children:"Play Random"}},{props:{containerRef:u,key:"chooseMasks",disabled:!O.ready||O.looping,handleClick:m.zip.handleLoadPreparedMasks},Component:jt,visible:!O.looping},{props:{key:"loadMasks",variant:"contained",onChange:m.zip.handleZipInputChange,disabled:!O.ready||O.looping||m.zip.loading,children:m.loading?"Loading...":"Load Masks"},Component:ht,visible:!O.looping},{props:{key:"captureMasks",onClick:g,disabled:!O.ready||O.looping,children:"Capture Masks",color:"default"},visible:!O.looping}]}),[O.ready,O.looping,f,m.ready,m.loading,b,m.zip.loading,g,m.zip.handleZipInputChange,m.zip.handleLoadPreparedMasks]);return r.a.createElement("div",{className:_()(o.root,(c={},Object(D.a)(c,o.overlay,!O.looping),Object(D.a)(c,o.rootTop,!!O.looping),Object(D.a)(c,o.rootApart,!(!(null===(t=m.scores)||void 0===t?void 0:t.length)&&!(null===(n=p.masks)||void 0===n?void 0:n.length))&&l.isFullScreen),c))},r.a.createElement("div",{className:_()(Object(D.a)({},o.optionsTop,!!O.looping)),ref:u},O.looping?r.a.createElement(ft,{offset:70,buttons:[{props:{key:"stop",onClick:f,children:"Stop"}}]}):r.a.createElement(ft,{buttons:k}),O.looping&&"play"===d&&r.a.createElement("div",{className:o.progress},r.a.createElement(Et,{color:j,completed:100-m.progressPercent}))),l.isFullScreen&&!O.looping&&r.a.createElement("div",{className:o.captures},r.a.createElement(Qe,{results:m.scores,handleClose:m.clearScores}),r.a.createElement(it,{captureMasks:p,handlePlay:v})))},_t=Object(x.a)((function(e){return{root:{height:"100%",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center","& button":{minWidth:150,marginTop:e.spacing(2)}},transition:{textAlign:"center"},header:{marginBottom:e.spacing(2)}}})),Ut=function(e){var t=_t(),n=Object(a.useCallback)((function(t){var n=t.currentTarget.name;e.setPlayerMode(n)}),[e]),c=Object(a.useMemo)((function(){return Me.players.map((function(e){return{props:{key:e,name:e,children:e,onClick:n,disabled:!!Le[e]}}}))}),[n]);return r.a.createElement("div",{className:t.root},r.a.createElement(ft,{buttons:c}))},Bt=Object(D.a)({},Se.screen.PLAY,(g={},Object(D.a)(g,Se.players.SINGLE_PLAYER,(b={},Object(D.a)(b,Se.mode[Se.players.SINGLE_PLAYER].PRACTICE,Ft),Object(D.a)(b,Se.mode[Se.players.SINGLE_PLAYER].SURVIVAL,(function(){return"SURVIVAL Content"})),Object(D.a)(b,Se.mode[Se.players.SINGLE_PLAYER].TIME_ATTACK,(function(){return"TIME_ATTACK Content"})),b)),Object(D.a)(g,Se.players.MULTIPLAYER,(v={},Object(D.a)(v,Se.mode[Se.players.MULTIPLAYER].LOCAL,(function(){return"LOCAL Content"})),Object(D.a)(v,Se.mode[Se.players.MULTIPLAYER].REMOTE,(function(){return"REMOTE Content"})),v)),g)),zt=function(e){var t,n,a=e.screen.state,c=a.screen,o=a.mode,i=a.players;if(c===Se.screen.DEFAULT)return r.a.createElement(Ut,{setPlayerMode:e.screen.handlers.setPlayerMode});if(o===Se.mode.DEFAULT)return r.a.createElement(vt,{screen:e.screen});var l=(null===(t=Bt[c])||void 0===t||null===(n=t[i])||void 0===n?void 0:n[o])||Ae;return r.a.createElement(l,null)},Vt=function(e,t){switch(t.type){case Ce:return Object(N.a)(Object(N.a)({},e),{},{mode:t.value});case ye:return Object(N.a)(Object(N.a)({},e),{},{screen:Se.screen.PLAY,players:t.value});case xe:return Ie;case we:var n=Object(N.a)({},e);if(e.mode)n.mode=Se.mode.DEFAULT;else{if(e.screen===Se.screen.DEFAULT)return e;n.screen=Se.screen.DEFAULT,n.players=Se.players.DEFAULT}return n;default:throw new Error("Invalid action: ".concat(t.type))}},Yt=n(280),Wt=n.n(Yt)()(),Gt=Object(a.createContext)(),qt=function(e){var t=e.children,n=function(){var e=R(),t=Object(a.useRef)(),n=Object(a.useRef)(),r=Object(a.useState)(!1),c=Object(h.a)(r,2),o=c[0],i=c[1],l=Object(a.useState)(!1),u=Object(h.a)(l,2),s=u[0],d=u[1];Object(a.useEffect)((function(){!t.current&&e.ready&&(t.current=!0,Wt.load().then((function(){console.log("BodyPix loaded"),i(!0)})).catch(console.error))}),[e]);var m=Object(a.useCallback)(Object(M.a)(L.a.mark((function t(){var n;return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o){t.next=2;break}throw new Error('Please wait for the model to load before calling "predict"');case 2:return t.next=4,Wt.predict(e.getVideoAsImageData());case 4:return n=t.sent,t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)}))),[o,e]);return Object(a.useEffect)((function(){!o||n.current||s||(n.current=!0,m().then((function(){d(!0)})))}),[m,o,s]),s?m:null}();return r.a.createElement(Gt.Provider,{value:n},t)},Xt=function(){var e=R(),t=function(){var e=Object(a.useContext)(Gt);if(void 0===e)throw new Error("useBodyPix must be used within a BodyPixProvider");return e}(),n=function(){var e=Object(a.useRef)(),t=Object(a.useRef)(),n=Object(a.useRef)(),r=Object(a.useRef)(),c=Object(a.useRef)(),o=Object(a.useCallback)((function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t.current=a,e.current=a,r.current=0,n.current=0,c.current=0}),[]),i=Object(a.useCallback)((function(){c.current=0}),[]),l=Object(a.useCallback)((function(a){var l=!1;t.current||(l=!0,o(a));var u=a-e.current;c.current+=u;var s=0,d=0;n.current++&&(s=1e3/u,d=r.current/n.current,r.current+=s);var m=a-t.current;return e.current=a,{first:l,timestamp:a,fps:s,avgFps:d,elapsed:m,frames:n.current,lapTime:c.current,resetLapTime:i}}),[o,i]);return Object(a.useMemo)((function(){return{update:l,reset:o}}),[l,o])}(),r=function(){var e=Object(a.useRef)(),t=je().handlers.speech,n=Object(a.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.onBeforeStartLap,a=t.onLap,r=t.onEnd,c=t.maxLaps,o=t.lapDuration,i=void 0===o?3e3:o,l=t.postLapDelay,u=void 0===l?1e3:l,s=t.printSeconds,d=void 0===s||s,m=t.announceSeconds,p=void 0===m||m;a&&!e.current&&(e.current={onBeforeStartLap:n,onBeforeComplete:!1,onBeforeStarted:!1,onLap:a,onEnd:r,maxLaps:c,numLaps:0,lapDuration:i,postLapDelay:u,printSeconds:d,announceSeconds:p})}),[]),r=Object(a.useCallback)(function(){var n=Object(M.a)(L.a.mark((function n(a){var r,c,o,i,l,u,s;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=a.time,c=a.webcam,o=a.predict,i=a.stop,!e.current){n.next=33;break}if(!e.current.onBeforeStartLap||e.current.onBeforeComplete){n.next=13;break}if(!e.current.onBeforeStarted){n.next=7;break}return n.abrupt("return");case 7:return e.current.onBeforeStarted=!0,n.next=10,e.current.onBeforeStartLap({time:r,webcam:c,predict:o,stop:i});case 10:return e.current.onBeforeComplete=!0,r.resetLapTime(),n.abrupt("return");case 13:if(!e.current.maxLaps||e.current.numLaps!==e.current.maxLaps){n.next=19;break}if(!e.current.onEnd){n.next=17;break}return n.next=17,e.current.onEnd({time:r,webcam:c,predict:o,stop:i});case 17:return e.current=null,n.abrupt("return",i());case 19:if(l=Math.floor(r.lapTime/1e3),u=Math.max(e.current.lapDuration/1e3-l,0),e.current.printSeconds&&((s=c.ctx).font="40px Arial",s.fillStyle="white",s.clearRect(0,0,50,50),u&&s.fillText(u,10,40)),u&&e.current.announceSeconds&&e.current.lastSpeech!==u&&(e.current.lastSpeech=u,t.say("".concat(u))),!(r.lapTime>=e.current.lapDuration)||e.current.handlerCalled){n.next=32;break}return e.current.numLaps++,e.current.handlerCalled=!0,e.current.handlerResolved=!1,n.next=29,e.current.onLap({time:r,webcam:c,predict:o,stop:i,lapNum:e.current.numLaps});case 29:e.current.handlerResolved=!0,n.next=33;break;case 32:r.lapTime>=e.current.lapDuration+e.current.postLapDelay&&e.current.handlerResolved&&(r.resetLapTime(),e.current.handlerCalled=!1,e.current.handlerResolved=!1);case 33:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[t]),c=Object(a.useCallback)((function(){e.current=null}),[]);return Object(a.useMemo)((function(){return{clear:c,useTimer:n,handleLap:r}}),[c,n,r])}(),c=Object(a.useRef)(),o=Object(a.useRef)(),i=Object(a.useState)(!1),l=Object(h.a)(i,2),u=l[0],s=l[1],d=Object(a.useCallback)((function(){r.clear(),n.reset(),c.current=!0,s(!0)}),[n,r]),m=Object(a.useCallback)((function(){c.current=!1,s(!1)}),[]),p=Object(a.useCallback)(function(){var a=Object(M.a)(L.a.mark((function a(i){var l,u;return L.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return l=n.update(i),a.next=3,o.current({time:l,webcam:e,predict:t,useTimer:r.useTimer,stop:m});case 3:u=a.sent,r.handleLap({time:l,webcam:e,predict:t,stop:m}),c.current?requestAnimationFrame(p):(m(),o.current=null,e.clearCanvas(),u&&u());case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),[e,t,r,n,m]),f=Object(a.useCallback)(function(){var e=Object(M.a)(L.a.mark((function e(n){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.current){e.next=4;break}throw new Error("The loop is already running");case 4:if(t){e.next=8;break}throw new Error("Please wait for BodyPix to load...");case 8:if(n){e.next=10;break}throw new Error("A loop handler is required when calling loop.start");case 10:return o.current=n,d(),e.abrupt("return",requestAnimationFrame(p));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[p,t,d]);return Object(a.useMemo)((function(){return{start:f,looping:u,stop:m,ready:t&&e.ready}}),[f,t,u,m,e.ready])},Ht=function(){var e=Xt(),t=Object(a.useState)(null),n=Object(h.a)(t,2),r=n[0],c=n[1],o=function(){var e=Object(a.useReducer)(Vt,Ie),t=Object(h.a)(e,2),n=t[0],r=t[1],c=Object(a.useCallback)((function(e){if(!Me.screen.includes(e))throw new Error("Unknown screen: ".concat(e));r({type:Ee,value:e})}),[]),o=Object(a.useCallback)((function(e){if(![].concat(Object(yt.a)(Me.mode[Se.players.SINGLE_PLAYER]),Object(yt.a)(Me.mode[Se.players.MULTIPLAYER])).includes(e))throw new Error("Unknown gameMode: ".concat(e));r({type:Ce,value:e})}),[]),i=Object(a.useCallback)((function(e){if(!Me.players.includes(e))throw new Error("Unknown playerMode: ".concat(e));r({type:ye,value:e})}),[]),l=Object(a.useCallback)((function(){r({type:xe})}),[]),u=Object(a.useCallback)((function(){r({type:we})}),[]);return[n,Object(a.useMemo)((function(){return{setScreen:c,resetState:l,setGameMode:o,reverseState:u,setPlayerMode:i}}),[c,l,o,u,i])]}(),i=Object(h.a)(o,2),l=i[0],u=i[1];return Object(a.useEffect)((function(){l.screen!==Se.screen.DEFAULT&&l.mode!==Se.mode.DEFAULT||!r||c(null)}),[l,r]),Object(a.useMemo)((function(){return{screen:{state:l,handlers:u},mode:r,loop:e,setMode:c}}),[l,u,r,e])},Kt=Object(x.a)((function(e){return{header:{marginTop:e.spacing(2)}}})),$t=Object(a.createContext)(),Zt=function(){var e=Object(a.useContext)($t);if(!e)throw new Error("useGame must be called from inside the <Game> component.");return e},Jt=Object(a.memo)((function(e){e.webcam;var t=Kt(),n=Ht();return r.a.createElement($t.Provider,{value:n},r.a.createElement(Te,{mode:n.screen.state.mode,screen:n.screen.state.screen,goHome:n.screen.handlers.resetState,goBack:n.screen.handlers.reverseState}),r.a.createElement("div",{className:t.header},r.a.createElement(Ue,{screenState:n.screen.state})),r.a.createElement(X,{overlay:!n.screen.state.mode},r.a.createElement(zt,{screen:n.screen})),r.a.createElement(mt,{screen:n.screen}))})),Qt=function(){return r.a.createElement("div",null,"Sorry, but this game requires a webcam. Please plug in a webcam and refresh the page.")},en=Object(x.a)((function(e){return{root:{maxWidth:1100,margin:"0 auto ".concat(e.spacing(2),"px")}}})),tn=Object(a.memo)((function(e){var t=R(),n=t.currentDeviceId,c=t.hasVideo,o=t.cameras,i=t.autoStartDeviceId,l=Object(a.useRef)();Object(a.useEffect)((function(){c&&o.length&&(n||i)&&!l.current&&(l.current=!0,t.start().catch(console.error))}),[c,o,n,i]);var u=en();return r.a.createElement("main",{className:u.root},c?r.a.createElement(Jt,{webcam:t}):r.a.createElement(Qt,null))})),nn=Object(E.a)({palette:{primary:w.a}});var an=function(){var e=Object(a.useState)(!1),t=Object(h.a)(e,2),n=t[0],c=t[1],o=Object(a.useRef)();return Object(a.useEffect)((function(){var e=setInterval((function(){window.cvReady&&(c(!0),clearInterval(e))}),200);return function(){clearInterval(e)}}),[]),Object(a.useEffect)((function(){o.current||(o.current=!0,j.a.init({selector:".background"}))})),r.a.createElement(y.a,{theme:nn},r.a.createElement(A,null,r.a.createElement(qt,null,r.a.createElement(ke,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,null),r.a.createElement(tn,{cvReady:n}))))))};o.a.render(r.a.createElement(an,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[292,1,2]]]);
//# sourceMappingURL=main.ff509b45.chunk.js.map