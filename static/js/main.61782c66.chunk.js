(this["webpackJsonpadam-and-rob-code-a-thing"]=this["webpackJsonpadam-and-rob-code-a-thing"]||[]).push([[0],{266:function(e,t,a){var n=a(292),r=["load","predict"];e.exports=function(){var e=new Worker(a.p+"c274620fe1aaa38a8e0e.worker.js",{name:"[hash].worker.js"});return n(e,r),e}},281:function(e,t,a){e.exports=a(551)},286:function(e,t,a){},301:function(e,t){},303:function(e,t){},351:function(e,t){},353:function(e,t){},381:function(e,t){},383:function(e,t){},384:function(e,t){},390:function(e,t){},392:function(e,t){},410:function(e,t){},413:function(e,t){},429:function(e,t){},432:function(e,t){},437:function(e,t){},439:function(e,t){},462:function(e,t){},551:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(16),o=a.n(c);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(286);var i,u,l=a(10),s=a(590),d=a(270),p=a(589),m=a(6),f=a.n(m),v=a(17),b=a(583),h=a(581),g=a(66),k=a(552),O=Object(n.createContext)(),j=function(){var e=Object(n.useContext)(O);if(!e)throw new Error("useWebcam must be used within a WebcamProvider");return e},w=!!(null===(i=navigator)||void 0===i||null===(u=i.mediaDevices)||void 0===u?void 0:u.getUserMedia),C=function(e){var t=e.children,a=Object(n.useRef)(),c=Object(n.useRef)(),o=Object(n.useState)(null),i=Object(l.a)(o,2),u=i[0],s=i[1],d=Object(n.useState)(!0),p=Object(l.a)(d,2),m=p[0],b=p[1],h=Object(n.useState)(!1),g=Object(l.a)(h,2),k=g[0],j=g[1],C=Object(n.useState)([]),y=Object(l.a)(C,2),x=y[0],E=y[1],S=Object(n.useState)(null),I=Object(l.a)(S,2),D=I[0],R=I[1],M=Object(n.useState)(null),L=Object(l.a)(M,2),T=L[0],B=L[1],N=Object(n.useState)(null),A=Object(l.a)(N,2),P=A[0],U=A[1],V=Object(n.useState)(null),W=Object(l.a)(V,2),F=W[0],_=W[1],z=Object(n.useState)(null),X=Object(l.a)(z,2),H=X[0],G=X[1];Object(n.useEffect)((function(){c.current&&!u?s(c.current.getContext("2d")):u&&!c.current&&s(null)}),[u]),Object(n.useEffect)((function(){if(k&&!D){var e=document.createElement("canvas");e.width=c.current.width,e.height=c.current.height;var t=e.getContext("2d");R({ctx:t,canvas:e})}}),[D,k]);var $=Object(n.useCallback)((function(){D.ctx.clearRect(0,0,c.current.width,c.current.height)}),[D]),q=Object(n.useCallback)((function(){u.clearRect(0,0,c.current.width,c.current.height)}),[u]),J=Object(n.useCallback)((function(){P&&P.getTracks().forEach((function(e){return e.stop()})),B(null),U(null),j(!1),_(null)}),[P]),Y=Object(n.useCallback)(function(){var e=Object(v.a)(f.a.mark((function e(t){var n,r,c,o,i,u,l,s,d;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(J(),w){e.next=6;break}return"Video not supported",console.error("Video not supported"),B("Video not supported"),e.abrupt("return");case 6:return r=(n="number"===typeof t)?{}:t||{},c=n?t:r.deviceIdx,e.prev=9,console.log("Getting Webcam..."),u={video:{width:{exact:r.width||1280},height:{exact:r.height||720}},audio:!1},void 0!==c&&(r.deviceId=null===(l=x[c])||void 0===l?void 0:l.deviceId),r.deviceId&&(u.video.deviceId={exact:r.deviceId}),e.next=16,navigator.mediaDevices.getUserMedia(u);case 16:s=e.sent,d=null===(o=s.getTracks()[0])||void 0===o||null===(i=o.getCapabilities())||void 0===i?void 0:i.deviceId,console.log("Got Webcam!"),U(s),_(d),a.current.srcObject=s,e.next=33;break;case 24:return e.prev=24,e.t0=e.catch(9),"Error starting video.",console.error("Error starting video."),console.error(e.t0.message),U(null),j(!1),B("Error starting video."),e.abrupt("return");case 33:return e.next=35,Promise.all([new Promise((function(e){a.current.onloadedmetadata=function(){return e()}})),new Promise((function(e){a.current.onloadeddata=function(){return e()}}))]).then((function(){return j(!0)}));case 35:return e.abrupt("return",e.sent);case 36:case"end":return e.stop()}}),e,null,[[9,24]])})));return function(t){return e.apply(this,arguments)}}(),[J,a,x]),K=Object(n.useCallback)(Object(v.a)(f.a.mark((function e(){var t,a,n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=navigator)||void 0===t||null===(a=t.mediaDevices)||void 0===a?void 0:a.enumerateDevices){e.next=4;break}return console.error("Cannot get cameras."),e.abrupt("return",[]);case 4:return e.next=6,navigator.mediaDevices.enumerateDevices();case 6:return n=e.sent,r=n.filter((function(e){var t=e.kind,a=e.label;return"videoinput"===t&&!a.includes("CamTwist")})).map((function(e){var t,a=e.label.lastIndexOf(" (");return a>-1&&(t=e.label.slice(0,a)),t?{deviceId:e.deviceId,label:t}:e})),E(r),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)}))),[]),Q=Object(n.useCallback)((function(){return b((function(e){return!e}))}),[]),Z=Object(n.useCallback)((function(e){window.localStorage.setItem("AutoStartId",e),G(e)}),[]),ee=Object(n.useCallback)((function(){window.localStorage.removeItem("AutoStartId"),G(null)}),[]),te=Object(n.useCallback)((function(e){$(),D.ctx.putImageData(e,0,0);var t=D.canvas.toDataURL("image/png");return $(),t}),[D,$]),ae=Object(n.useCallback)(function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $(),(a=new Image).src=t,e.next=5,new Promise((function(e){a.onload=function(){D.ctx.drawImage(a,0,0),e()}}));case 5:return n=D.ctx.getImageData(0,0,c.current.width,c.current.height),$(),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[$,D]),ne=Object(n.useCallback)((function(){$(),D.ctx.drawImage(a.current,0,0);var e=D.ctx.getImageData(0,0,c.current.width,c.current.height);return $(),e}),[$,D]);Object(n.useEffect)((function(){K().then((function(e){var t=window.localStorage.getItem("AutoStartId");G(t),!!e.filter((function(e){return e.deviceId===t})).length&&Y({deviceId:t})}))}),[]);var re=Object(n.useMemo)((function(){return{ctx:u,ready:k,flipX:m,cameras:x,setFlipX:b,videoRef:a,hasVideo:w,canvasRef:c,stopVideo:J,startVideo:Y,videoError:T,scratchpad:D,clearCanvas:q,toggleFlipX:Q,videoStream:P,currentDeviceId:F,stop:J,discoverCameras:K,autoStartDeviceId:H,start:Y,imageDataToDataUri:te,dataUriToImageData:ae,getVideoAsImageData:ne,setAutoStartDeviceId:Z,clearAutoStartDeviceId:ee}}),[u,k,m,x,b,J,Y,T,D,Q,q,P,F,K,H,te,ae,ne,Z,ee]);return r.a.createElement(O.Provider,{value:re},t)},y=Object(k.a)((function(e){return{root:function(e){return{position:"relative"}},video:function(e){return Object(g.a)({width:"100%",height:"100%"},e.flipX?{"p-webkit-transform":"scaleX(- 1)",transform:"scaleX(-1)"}:{})},canvas:function(e){return{position:"absolute",top:0,left:0,width:"100%"}}}})),x=function(e){var t,a,n,c,o,i,u,l,s=j(),d=y(Object(g.a)(Object(g.a)({},e),s));return r.a.createElement("div",{className:d.root},r.a.createElement("video",{autoPlay:!0,ref:s.videoRef,className:d.video,width:null===(t=s.videoRef)||void 0===t||null===(a=t.current)||void 0===a?void 0:a.videoWidth,height:null===(n=s.videoRef)||void 0===n||null===(c=n.current)||void 0===c?void 0:c.videoHeight}),r.a.createElement("canvas",{ref:s.canvasRef,className:d.canvas,width:null===(o=s.videoRef)||void 0===o||null===(i=o.current)||void 0===i?void 0:i.videoWidth,height:null===(u=s.videoRef)||void 0===u||null===(l=u.current)||void 0===l?void 0:l.videoHeight}))},E=a(118),S=Object(k.a)((function(e){return{fileInput:{display:"none"}}})),I=function(e){var t=e.onChange,a=e.multiple,c=e.children,o=e.filter,i=Object(E.a)(e,["onChange","multiple","children","filter"]),u=S(),l=Object(n.useRef)(),s=Object(n.useCallback)((function(e){if(e){var n=!1===a,r=e.target?Array.from(e.target.files):e.files,c=o?r.filter(o):r;n&&c.length>1&&(c=c.slice(0,1)),t(c)}}),[t,a,o]),d=Object(n.useCallback)((function(){l.current.value=null}),[l]);return r.a.createElement(h.a,Object.assign({component:"label"},i),c,r.a.createElement("input",{type:"file",ref:l,className:u.fileInput,onClick:d,onChange:s,multiple:!1!==a}))},D=a(591),R=a(595),M=a(584),L=Object(b.a)((function(e){return{formControl:{minWidth:120},select:{paddingTop:e.spacing(1),paddingBottom:e.spacing(1)}}})),T=function(e){var t=e.value,a=Object(E.a)(e,["value"]),n=L();return r.a.createElement(M.a,{className:n.formControl},r.a.createElement(D.a,Object.assign({classes:{root:n.select}},a,{placeholder:"Select Game",value:t||"",displayEmpty:!0,variant:"outlined"}),r.a.createElement(R.a,{value:""},"Select Masks"),Array.from({length:3}).map((function(e,t){return r.a.createElement(R.a,{key:t,value:"set".concat(t+1,".zip")},"Game ",t+1)}))))},B=a(271),N=a(594),A=a(592),P=a(588),U=a(262),V=a.n(U),W=a(263),F=a.n(W),_=function(){},z=Object(k.a)((function(e){return{root:function(e){return{position:"relative"}},arrowIcon:function(t){return{marginLeft:e.spacing(1)}},tooltip:function(e){return{position:"relative",margin:0}},arrow:function(e){return{position:"absolute",fontSize:6,"&::before":{content:'""',margin:"auto",display:"block",width:0,height:0,borderStyle:"solid"}}},paper:{border:"1px solid #d3d4d5"},popper:function(t){return{'&[x-placement*="bottom"] $arrow':{top:0,left:0,marginTop:"-0.95em",width:"2em",height:"1em","&::before":{borderWidth:"0 1em 1em 1em",borderColor:"transparent transparent ".concat(e.palette.grey[700]," transparent")}},'&[x-placement*="top"] $arrow':{bottom:0,left:0,marginBottom:"-0.95em",width:"2em",height:"1em","&::before":{borderWidth:"1em 1em 0 1em",borderColor:"".concat(e.palette.grey[700]," transparent transparent transparent")}},'&[x-placement*="right"] $arrow':{left:0,marginLeft:"-0.95em",height:"2em",width:"1em","&::before":{borderWidth:"1em 1em 1em 0",borderColor:"transparent ".concat(e.palette.grey[700]," transparent transparent")}},'&[x-placement*="left"] $arrow':{right:0,marginRight:"-0.95em",height:"2em",width:"1em","&::before":{borderWidth:"1em 0 1em 1em",borderColor:"transparent transparent transparent ".concat(e.palette.grey[700])}}}}}})),X=function(e){var t,a=z(e),c=Object(n.useMemo)(Math.random,[]),o=Object(n.useState)(null),i=Object(l.a)(o,2),u=i[0],s=i[1],d=Object(n.useState)(null),p=Object(l.a)(d,2),m=p[0],b=p[1],g=Object(n.useCallback)((function(e){s(e.currentTarget)}),[]),k=Object(n.useCallback)((function(){s(null)}),[]),O=Object(n.useCallback)(Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e.onClose||_)();case 2:!0!==t.sent&&k();case 4:case"end":return t.stop()}}),t)}))),[k,e.onClose]),j=Object(n.useCallback)((function(t){(e.onClickCheckbox||_)(t.target.value,O)}),[e.onClickCheckbox,O]),w=Object(n.useCallback)((function(t){return function(){var a=Object(v.a)(f.a.mark((function a(n){return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("checkbox"!==n.target.type){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,(e.onSelect||_)(t);case 4:!0!==a.sent&&O();case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}),[O,e.onSelect]),C=!!u;return r.a.createElement("div",{className:a.root},r.a.createElement(h.a,Object.assign({disableRipple:!0,variant:"outlined","aria-haspopup":"true",className:a.button,onClick:g,"aria-controls":"select-and-check-".concat(c)},e.SelectProps),C&&e.activeTitle||e.title,C?r.a.createElement(V.a,{className:a.arrowIcon}):r.a.createElement(F.a,{className:a.arrowIcon})),r.a.createElement(B.a,Object.assign({keepMounted:!0,open:C,elevation:0,anchorEl:u,getContentAnchorEl:null,onClose:O,id:"select-and-check-".concat(c),classes:{paper:a.paper},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e.MenuProps),null===(t=e.options)||void 0===t?void 0:t.map((function(t,n){var c=t.key,o=t.value,i=t.text,u=t.selected,l=t.tooltipTitle,s=t.checked,d=t.checkboxValue,p=null;if("boolean"===typeof s){var f=r.a.createElement(A.a,{checked:s,onClick:j,value:void 0===d?o:d}),v=l||e.tooltipTitle;p=v?r.a.createElement(N.a,{classes:{tooltip:a.tooltip,popper:a.popper},PopperProps:{popperOptions:{modifiers:{arrow:{enabled:!!m,element:m}}}},title:r.a.createElement(r.a.Fragment,null,v,r.a.createElement("span",{className:a.arrow,ref:b})),enterDelay:void 0===e.tooltipEnterDelay?750:e.tooltipEnterDelay,leaveDelay:e.tooltipLeaveDelay||0,"aria-label":"checkbox",placement:e.tooltipPlacement||"top"},f):f}return r.a.createElement(R.a,Object.assign({key:c||n,onClick:w(o),selected:u},e.MenuItemProps),p,r.a.createElement(P.a,{primary:i||(null===o||void 0===o?void 0:o.toString())}))}))))},H=Object(k.a)((function(e){return{root:function(e){return{}}}})),G=function(e){var t,a=j(),c=H(Object(g.a)(Object(g.a)({},e),a)),o=Object(n.useMemo)((function(){var e={deviceId:null,label:null,none:!0};return a.currentDeviceId?(a.cameras.some((function(t){return t.deviceId===a.currentDeviceId&&(e=t,!0)})),e):e}),[a.cameras,a.currentDeviceId]),i=Object(n.useCallback)((function(e){a.currentDeviceId!==e&&a.start({deviceId:e})}),[a]),u=Object(n.useCallback)((function(e){a.autoStartDeviceId===e?a.clearAutoStartDeviceId():(a.setAutoStartDeviceId(e),i(e))}),[a,i]);return r.a.createElement("div",{className:c.root},r.a.createElement(X,{activeTitle:"Select Camera",title:(null===(t=a.cameras)||void 0===t?void 0:t.length)?o.label||"No Camera Selected":"No Cameras Detected",onSelect:i,onClickCheckbox:u,options:a.cameras.map((function(e){return{key:e.label,value:e.deviceId,text:e.label||"Unknown Device",selected:e.deviceId===a.currentDeviceId,checked:a.autoStartDeviceId===e.deviceId,tooltipTitle:a.autoStartDeviceId===e.deviceId?"Remove Default":"Set Default"}}))}))},$=a(586),q=a(119),J=Object(b.a)((function(e){return{masks:{padding:e.spacing(1)},masksHeader:{},masksList:{display:"flex",flexFlow:"row wrap",justifyContent:"space-around"},imgContainer:{width:200,padding:e.spacing(.5),marginTop:e.spacing(.5),textAlign:"right"},img:{background:"black",width:"100%"}}})),Y=function(e){var t=J(),a=e.results;return!!a.length&&r.a.createElement(r.a.Fragment,null,r.a.createElement($.a,{className:t.masks},r.a.createElement("div",{className:t.masksHeader},r.a.createElement(q.a,{variant:"h6",component:"h3"},"Results"),r.a.createElement(q.a,{component:"p"},"Average: ",a.reduce((function(e,t){return e+t.score}),0)/a.length)),r.a.createElement("ul",{className:t.masksList},a.map((function(e,a){var n=e.score,c=e.dataUri;return r.a.createElement("li",{className:t.imgContainer,key:c},r.a.createElement(q.a,null,n),r.a.createElement("img",{src:c,className:t.img,alt:"mask #".concat(a)}))})))))},K=a(587),Q=a(265),Z=a.n(Q),ee=Object(b.a)((function(e){return{masks:{padding:e.spacing(1)},masksHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:e.spacing(1)},masksList:{display:"flex",flexFlow:"row wrap",justifyContent:"space-around"},imgContainer:{width:200,background:"black",padding:e.spacing(.5),marginTop:e.spacing(.5),position:"relative","&:hover":{"& > div":{background:"rgba(255,0,0,0.65)"}}},img:{width:"100%",background:"rgba(0,0,0,0)"},removeMask:{display:"flex",transition:"all 100ms",position:"absolute",top:0,bottom:0,width:"100%",left:0,justifyContent:"center",alignItems:"center","&:hover":{"& > button":{display:"inherit"}}},iconBtn:{display:"none",color:"black",backgroundColor:"rgba(255,255,255,0.5)","&:hover":{backgroundColor:"rgba(255,255,255,0.75)"},"&:active, &:focused":{backgroundColor:"rgba(255,255,255,0.9)"}}}})),te=function(e){var t=ee(),a=e.captureMasks;return!!a.masks.length&&r.a.createElement(r.a.Fragment,null,r.a.createElement($.a,{className:t.masks},r.a.createElement("div",{className:t.masksHeader},r.a.createElement(q.a,{variant:"h6",component:"h3"},"Candidate Masks"),r.a.createElement("div",null,r.a.createElement(h.a,{onClick:a.downloadMasks},"Download"),r.a.createElement(h.a,{onClick:a.removeAllMasks},"Clear All"))),r.a.createElement("ul",{className:t.masksList},a.masks.map((function(e,n){var c=e.binary;return r.a.createElement("li",{className:t.imgContainer,key:c},r.a.createElement("div",{className:t.removeMask},r.a.createElement(K.a,{name:n,className:t.iconBtn,onClick:a.removeMask},r.a.createElement(Z.a,{fontSize:"large"}))),r.a.createElement("img",{src:c,className:t.img,alt:"mask #".concat(n)}))})))))},ae=window.speechSynthesis,ne=function(){var e=Object(n.useRef)(),t=function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(null),o=Object(l.a)(c,2),i=o[0],u=o[1];Object(n.useEffect)((function(){if(!a){var e=ae.getVoices();r(e),u(e[0])}}),[a]);var s=Object(n.useCallback)((function(e){var t=new SpeechSynthesisUtterance(e);t.voice=i,ae.speak(t)}),[i]),d=Object(n.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.onEnd,n=t.onEach;a&&setTimeout(a,1e3*e),Array.from({length:e}).forEach((function(t,a){var r=e-a;setTimeout((function(){s(r),n&&n(r)}),1e3*a)}))}),[s]);return{say:s,countdown:d}}(),a=Object(n.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.onBeforeStartLap,n=t.onLap,r=t.onEnd,c=t.maxLaps,o=t.lapDuration,i=void 0===o?3e3:o,u=t.postLapDelay,l=void 0===u?1e3:u,s=t.printSeconds,d=void 0===s||s,p=t.announceSeconds,m=void 0===p||p;n&&!e.current&&(e.current={onBeforeStartLap:a,onBeforeComplete:!1,onBeforeStarted:!1,onLap:n,onEnd:r,maxLaps:c,numLaps:0,lapDuration:i,postLapDelay:l,printSeconds:d,announceSeconds:m})}),[]),r=Object(n.useCallback)(function(){var a=Object(v.a)(f.a.mark((function a(n){var r,c,o,i,u,l,s;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=n.time,c=n.webcam,o=n.predict,i=n.stop,!e.current){a.next=33;break}if(!e.current.onBeforeStartLap||e.current.onBeforeComplete){a.next=13;break}if(!e.current.onBeforeStarted){a.next=7;break}return a.abrupt("return");case 7:return e.current.onBeforeStarted=!0,a.next=10,e.current.onBeforeStartLap({time:r,webcam:c,predict:o,stop:i});case 10:return e.current.onBeforeComplete=!0,r.resetLapTime(),a.abrupt("return");case 13:if(!e.current.maxLaps||e.current.numLaps!==e.current.maxLaps){a.next=19;break}if(!e.current.onEnd){a.next=17;break}return a.next=17,e.current.onEnd({time:r,webcam:c,predict:o,stop:i});case 17:return e.current=null,a.abrupt("return",i());case 19:if(u=Math.floor(r.lapTime/1e3),l=Math.max(e.current.lapDuration/1e3-u,0),e.current.printSeconds&&((s=c.ctx).font="40px Arial",s.fillStyle="white",s.clearRect(0,0,50,50),l&&s.fillText(l,10,40)),l&&e.current.announceSeconds&&e.current.lastSpeech!==l&&(e.current.lastSpeech=l,t.say("".concat(l))),!(r.lapTime>=e.current.lapDuration)||e.current.handlerCalled){a.next=32;break}return e.current.numLaps++,e.current.handlerCalled=!0,e.current.handlerResolved=!1,a.next=29,e.current.onLap({time:r,webcam:c,predict:o,stop:i,lapNum:e.current.numLaps});case 29:e.current.handlerResolved=!0,a.next=33;break;case 32:r.lapTime>=e.current.lapDuration+e.current.postLapDelay&&e.current.handlerResolved&&(r.resetLapTime(),e.current.handlerCalled=!1,e.current.handlerResolved=!1);case 33:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),[t]),c=Object(n.useCallback)((function(){e.current=null}),[]);return Object(n.useMemo)((function(){return{clear:c,useTimer:a,handleLap:r}}),[c,a,r])},re=a(266),ce=a.n(re)()(),oe=Object(n.createContext)(),ie=function(){var e=Object(n.useContext)(oe);if(void 0===e)throw new Error("useBodyPix must be used within a BodyPixProvider");return e},ue=function(e){var t=e.children,a=function(){var e=j(),t=Object(n.useRef)(),a=Object(n.useRef)(),r=Object(n.useState)(!1),c=Object(l.a)(r,2),o=c[0],i=c[1],u=Object(n.useState)(!1),s=Object(l.a)(u,2),d=s[0],p=s[1];Object(n.useEffect)((function(){!t.current&&e.ready&&(t.current=!0,ce.load().then((function(){console.log("BodyPix loaded"),i(!0)})).catch(console.error))}),[e]);var m=Object(n.useCallback)(Object(v.a)(f.a.mark((function t(){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o){t.next=2;break}throw new Error('Please wait for the model to load before calling "predict"');case 2:return t.next=4,ce.predict(e.getVideoAsImageData());case 4:return a=t.sent,t.abrupt("return",a);case 6:case"end":return t.stop()}}),t)}))),[o,e]);return Object(n.useEffect)((function(){!o||a.current||d||(a.current=!0,m().then((function(){p(!0)})))}),[m,o,d]),d?m:null}();return r.a.createElement(oe.Provider,{value:a},t)},le=function(e){var t=j(),a=ie(),r=function(){var e=Object(n.useRef)(),t=Object(n.useRef)(),a=Object(n.useRef)(),r=Object(n.useRef)(),c=Object(n.useRef)(),o=Object(n.useCallback)((function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t.current=n,e.current=n,r.current=0,a.current=0,c.current=0}),[]),i=Object(n.useCallback)((function(){c.current=0}),[]),u=Object(n.useCallback)((function(n){var u=!1;t.current||(u=!0,o(n));var l=n-e.current;c.current+=l;var s=0,d=0;a.current++&&(s=1e3/l,d=r.current/a.current,r.current+=s);var p=n-t.current;return e.current=n,{first:u,timestamp:n,fps:s,avgFps:d,elapsed:p,frames:a.current,lapTime:c.current,resetLapTime:i}}),[o,i]);return Object(n.useMemo)((function(){return{update:u,reset:o}}),[u,o])}(),c=ne(),o=Object(n.useRef)(),i=Object(n.useRef)(),u=Object(n.useState)(!1),s=Object(l.a)(u,2),d=s[0],p=s[1],m=Object(n.useCallback)((function(){c.clear(),r.reset(),o.current=!0,p(!0)}),[r,c]),b=Object(n.useCallback)((function(){o.current=!1,p(!1)}),[]),h=Object(n.useCallback)(function(){var e=Object(v.a)(f.a.mark((function e(n){var u,l;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=r.update(n),e.next=3,i.current({time:u,webcam:t,predict:a,useTimer:c.useTimer,stop:b});case 3:l=e.sent,c.handleLap({time:u,webcam:t,predict:a,stop:b}),o.current?requestAnimationFrame(h):(b(),i.current=null,t.clearCanvas(),l&&l());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,a,c,r,b]),g=Object(n.useCallback)(function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.current){e.next=4;break}throw new Error("The loop is already running");case 4:if(a){e.next=8;break}throw new Error("Please wait for BodyPix to load...");case 8:if(t){e.next=10;break}throw new Error("A loop handler is required when calling loop.start");case 10:return i.current=t,m(),e.abrupt("return",requestAnimationFrame(h));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[h,a,m]);return Object(n.useMemo)((function(){return{start:g,looping:d,stop:b,ready:a&&t.ready}}),[g,a,d,b,t.ready])},se=a(117),de=a(96),pe=a.n(de),me=a(267),fe=a.n(me),ve=(a(268),function(e,t){for(var a=e.data,n=e.width,r=e.height,c=new Uint8ClampedArray(4*e.data.length),o=0;o<r*n;++o){var i=o%n,u=parseInt(o/n),l=a[o],s=t?n-i+n*u:o;c[4*s]=l?255:0,c[4*s+1]=l?255:0,c[4*s+2]=l?255:0,c[4*s+3]=l?255:0}var d=new ImageData(c,n,r),p=cv.matFromImageData(d),m=new cv.MatVector;cv.split(p,m);var f=new cv.Mat;cv.threshold(m.get(0),f,128,1,cv.THRESH_BINARY);var v=new cv.MatVector,b=new cv.Mat;cv.findContours(f,v,b,cv.RETR_CCOMP,cv.CHAIN_APPROX_SIMPLE);for(var h=cv.Mat.zeros(f.rows,f.cols,cv.CV_8UC1),g=0;g<v.size();++g)cv.contourArea(v.get(g))>1e4&&cv.drawContours(h,v,g,[1,1,1,1],-1,cv.LINE_8,b,100);var k=cv.Mat.zeros(p.rows,p.cols,cv.CV_8UC4);cv.split(k,m),m.get(2).setTo([255,0,0,0],h),m.get(3).setTo([128,0,0,0],h);var O=new cv.Mat,j=cv.Mat.ones(10,10,cv.CV_8U),w=new cv.Point(-1,-1);cv.dilate(h,O,j,w,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),cv.subtract(O,h,O),m.get(1).setTo([255,0,0,0],O),m.get(3).setTo([255,0,0,0],O),cv.merge(m,k);var C=new ImageData(new Uint8ClampedArray(k.data),k.cols,k.rows);return p.delete(),m.delete(),h.delete(),k.delete(),j.delete(),{overlayImageData:C,binaryImageData:C}}),be=function(e,t,a){for(var n=t.data,r=t.width,c=t.height,o=new Uint8ClampedArray(4*t.data.length),i=0,u=0,l=0;l<c*r;++l){var s=l%r,d=parseInt(l/r),p=a?r-s+r*d:l,m=n[l],f=!!e.data[4*p+2],v=f&&m,b=f&&!m,h=!f&&m,g=h||v||b;v&&u++,(m||f)&&i++,o[4*p]=h?255:0,o[4*p+1]=v?255:0,o[4*p+2]=b?255:0,o[4*p+3]=g?128:0}return{score:Math.round(u/(i+1e-7)*100),overlay:new ImageData(o,r,c)}},he=function(){var e=Object(n.useRef)(),t=j(),a=Object(n.useState)(!1),r=Object(l.a)(a,2),c=r[0],o=r[1],i=function(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),a=t[0],r=t[1],c=Object(n.useRef)(null),o=Object(n.useRef)(0),i=Object(n.useCallback)((function(){o.current=0,c.current=null}),[]),u=Object(n.useCallback)((function(){var e=a[o.current];return e?(c.current=e,o.current++,e):(c.current=null,o.current=0,null)}),[a]);return Object(n.useMemo)((function(){return{next:u,reset:i,maskRef:c,setMasks:r,numMasks:a.length}}),[u,i,a])}(),u=Object(n.useState)([]),s=Object(l.a)(u,2),d=s[0],p=s[1],m=Object(n.useState)(null),b=Object(l.a)(m,2),h=b[0],g=b[1],k=Object(n.useCallback)(function(){var e=Object(v.a)(f.a.mark((function e(a){var n,r,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.next=3,pe.a.loadAsync(a);case 3:return n=e.sent,e.next=6,Promise.all(n.filter((function(e){return e.endsWith(".png")})).map((function(e){var t=e.name;return n.file(t).async("base64")})));case 6:return r=e.sent,e.next=9,Promise.all(r.map((function(e){return t.dataUriToImageData("data:image/png;base64,".concat(e))})));case 9:c=e.sent,i.setMasks(c),o(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i,t]),O=Object(n.useCallback)((function(e){var t=Object(l.a)(e,1)[0];"application/zip"===t.type?(k(t),g(null)):console.error("Expected a zip file but got",t.type)}),[k]),w=Object(n.useCallback)(function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target.value){e.next=4;break}return g(null),e.abrupt("return");case 4:return e.next=6,new pe.a.external.Promise((function(e,t){fe.a.getBinaryContent("/adam_and_rob_code_a_thing"+"/masks/".concat(a),(function(a,n){a?t(a):e(n)}))}));case 6:n=e.sent,k(n),g(a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[k]),C=Object(n.useCallback)(function(){var a=Object(v.a)(f.a.mark((function a(n){return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.time.first&&(i.next(),p([]),n.useTimer({maxLaps:i.numMasks,printSeconds:!0,announceSeconds:!0,lapDuration:3e3,newLapDelay:1e3,onLap:function(a){var n=a.predict,r=(a.time,a.stop),c=i.maskRef.current;if(!c)return r();e.current=n(t.videoRef.current).then(function(){var e=Object(v.a)(f.a.mark((function e(a){var n,r,o,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=be(c,a,t.flipX),r=n.score,o=n.overlay,u=t.imageDataToDataUri(o),p((function(e){return[].concat(Object(se.a)(e),[{score:r,dataUri:u}])})),t.clearCanvas(),i.next();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}})),i.maskRef.current&&t.ctx.putImageData(i.maskRef.current,0,0),a.abrupt("return",(function(){e.current?e.current.then(n.webcam.clearCanvas):n.webcam.clearCanvas()}));case 3:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),[t,i]);return Object(n.useMemo)((function(){return{scores:d,loading:c,handleLoop:C,selectedMasks:h,handleLoadUserMasks:O,handleLoadShippedMasks:w,ready:!!i.numMasks}}),[d,c,C,i,h,O,w])},ge=a(269),ke=a.n(ge),Oe=function(){var e=Object(n.useRef)(),t=Object(n.useState)([]),a=Object(l.a)(t,2),r=a[0],c=a[1],o=Object(n.useCallback)((function(e){var t=e.currentTarget.name;c((function(e){return e.filter((function(e,a){return a!==+t}))}))}),[]),i=Object(n.useCallback)((function(){c([])}),[]),u=Object(n.useCallback)((function(){var e=new pe.a,t=e.folder("masks");r.forEach((function(e,a){var n=e.overlay;t.file("mask-".concat(a,".png"),ke.a.decode(n).dataBase64,{base64:!0})})),e.generateAsync({type:"blob"}).then((function(e){return function(e,t){if("undefined"!==typeof navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,t);if("undefined"!==typeof navigator.msSaveBlob)return navigator.msSaveBlob(e,t);var a=window.document.createElement("a");a.href=window.URL.createObjectURL(e),a.download=t,a.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(a),"function"===typeof a.click?a.click():(a.target="_blank",a.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),URL.revokeObjectURL(a.href)}(e,"masks.zip")}))}),[r]),s=Object(n.useCallback)(function(){var t=Object(v.a)(f.a.mark((function t(a){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.time.first&&a.useTimer({printSeconds:!0,announceSeconds:!0,lapDuration:3e3,newLapDelay:1e3,onBeforeStartLap:function(){var e=Object(v.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.predict,t.webcam,t.time,t.stop,e.abrupt("return",a());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onLap:function(t){var a=t.predict,n=t.webcam;t.time,t.stop;e.current=a(n.videoRef.current).then(function(){var e=Object(v.a)(f.a.mark((function e(t){var a,r,o,i,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=ve(t,n.flipX),r=a.overlayImageData,o=a.binaryImageData,i=n.imageDataToDataUri(r),u=n.imageDataToDataUri(o),n.clearCanvas(),n.ctx.putImageData(r,0,0),c((function(e){return[].concat(Object(se.a)(e),[{overlay:i,binary:u}])}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}),t.abrupt("return",(function(){e.current?e.current.then(a.webcam.clearCanvas):a.webcam.clearCanvas()}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]);return Object(n.useMemo)((function(){return{masks:r,handleLoop:s,removeMask:o,downloadMasks:u,removeAllMasks:i}}),[r,s,o,u,i])},je=Object(b.a)((function(e){return{root:{maxWidth:1280,margin:"0 auto",padding:e.spacing(1)},options:{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"space-between",marginBottom:e.spacing(1)}}})),we="capture",Ce="simpleGame",ye=function(e){var t=je(),a=le(),c=he(),o=Oe(),i=function(){var e=j(),t=ie();return Object(n.useCallback)(Object(v.a)(f.a.mark((function a(){var n,r,c;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t(e.videoRef.current);case 2:n=a.sent,r=ve(n,e.flipX),c=r.overlayImageData,e.clearCanvas(),e.ctx.putImageData(c,0,0);case 6:case"end":return a.stop()}}),a)}))),[t,e])}(),u=Object(n.useState)(null),s=Object(l.a)(u,2),d=s[0],p=s[1],m=Object(n.useCallback)(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.looping?(a.stop(),p(null)):(p(Ce),a.start(c.handleLoop));case 1:case"end":return e.stop()}}),e)}))),[a,c]),b=Object(n.useCallback)((function(){a.looping?(a.stop(),p(null)):(p(we),a.start(o.handleLoop))}),[a,o]);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.options},r.a.createElement(h.a,{variant:"outlined",onClick:i,disabled:!a.ready||a.looping},"Capture"),r.a.createElement(h.a,{variant:"outlined",onClick:b,disabled:!a.ready||a.looping&&d!==we},a.looping&&d===we?"Stop":"Capture Masks"),r.a.createElement(T,{onChange:c.handleLoadShippedMasks,disabled:!a.ready||a.looping,value:c.selectedMasks}),r.a.createElement(I,{variant:"outlined",onChange:c.handleLoadUserMasks,disabled:!a.ready||a.looping||c.loading},c.loading?"Loading...":"Load Masks"),r.a.createElement(h.a,{color:"primary",variant:"outlined",onClick:m,disabled:!(a.ready&&c.ready)||a.looping&&d!==Ce},a.looping&&d===Ce?"Stop":"Play"),r.a.createElement(G,null)),r.a.createElement(x,null),r.a.createElement(te,{captureMasks:o}),r.a.createElement(Y,{results:c.scores}))},xe=Object(d.a)({background:"linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)"});var Ee=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){var e=setInterval((function(){window.cvReady&&(c(!0),clearInterval(e),console.log("opencv ready"))}),200);return function(){clearInterval(e)}}),[]),r.a.createElement(p.a,{theme:xe},r.a.createElement(C,null,r.a.createElement(ue,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,null),r.a.createElement(ye,{cvReady:a})))))};o.a.render(r.a.createElement(Ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[281,1,2]]]);
//# sourceMappingURL=main.61782c66.chunk.js.map